[general]
autofallthrough=no

[global]

[public]

exten => s,1,Hangup()

[default]
exten => s,1,Hangup()

[From-TDM-Alcatel]


;exten => _8312401,1,Verbose(2,Caller ID is ${CALLERID(NUM)})
;exten => _8312401,2,SET(${CALLERID(NUM)}= ${CALLERID(NUM):0:3})
;exten => _8896540,3,SET(${CALLERID(NUM):0:3}= VAR)
;exten => _8896540,3,GotoIf($[${CALLERID(NUM)}= 844 ]?4:5)
;exten => _8896540,4,Verbose(2, VAR value is ${VAR})
;exten => _8312401,3,GotoIf($[${CALLERID(NUM):0:3}= 001 ]?4:5)
;exten => _8312401,4,Dial(SIP/NTL-CC-OFF/710,20,trT)
;exten => _8312401,5,Goto(Mainmenu,s,1)


exten => 8310710,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8310710,2,Goto(Mainmenu,s,1) ;NTL UAN

exten => _8317171,1,Goto(Mainmenu,s,1)  ; Test DID for PWR Queue Testing
exten => _8317171,2,Hangup

exten => 8310703,1,Goto(dial-L2TEST-queue,95,1)
exten => 8310703,2,Hangup


exten => _8732205,1,Goto(Mainmenu,s,1)  ; Test DID for PWR Queue Testing
exten => _8732205,2,Hangup

;----------------------Testing-New-API-|-Umair----------------------
#include extension_Umair.conf
exten => 8749888,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8749888,2,Goto(dial-tac-test-queue,81,1) ;
;--------------------------------------------------------------------------------

exten => 8318022,1,Dial(SIP/NTL-CC-OFF/8022,60,tT) ; Aqeel Sb extension 8022 DID dialing
exten => 8318022,2,Hangup


exten => 8734460,1,Answer;
exten => 8734460,2,Goto(recordnumber,s,1); TEST
exten => 8734460,3,Hangup

;exten => 8734460,1,NoOP("SOUND FILE TESTING")
;exten => 8734460,2,Goto(SOUNDTEST,s,1)

exten => 8430786,1,Playback(new-ivr/mainmenu)   ;Test DID for new Series
exten => 8430786,2,Hangup()

exten => 8460000,1,Playback(new-ivr/mainmenu)   ;Test DID for new series
exten => 8460000,2,Hangup()

exten => 8310000,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8310000,2,Goto(Mainmenu,s,1) ;MBL UAN

exten => 8154000,1,Set(CALLERID(NUM)=GRW-${CALLERID(num)}) ;Append Zero To CallerID
exten => 8154000,2,Goto(Mainmenu,s,1) ;MBL UAN


exten => 8310964,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8310964,2,Goto(Mainmenu,s,1) ;MBL UAN


;exten => 8734460,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
;exten => 8734460,2,Goto(Mainmenu,s,1) ;MBL UAN

exten => 8310700,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8310700,2,Goto(Mainmenu,s,1) ;NGN DID

exten => 8442062,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
;exten => 8442062,2,Goto(dial-sales-queue,82,1) ;TEST OUTAGE IVR
exten => 8442062,2,Playback(problem-ivr/ntl/OutageRecord)

exten => 8312786,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8312786,2,Goto(zaeemtest,81,1) ;Queue Priority Test
;exten => 8312786,2,Playback(es/urdutesting)

exten => 8311075,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8311075,2,Goto(Mainmenu,s,1) ;TEST DID


exten => 8310910,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8310910,2,Goto(Mainmenu,s,1) ;O&M

exten => 8310706,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8310706,2,Goto(Mainmenu,s,1) ;NGN DID

exten => 8310201,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8310201,2,Goto(Mainmenu,s,1) ;MBL UAN

exten => 8312401,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8312401,2,Goto(Mainmenu,s,1) ;MBL UAN

exten => 8312402,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8312402,2,Goto(Mainmenu,s,1) ;MBL UAN

exten => 8312403,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8312403,2,Goto(Mainmenu,s,1) ;MBL UAN
 

exten => 8310170,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8310170,2,Goto(Mainmenu,s,1) ;NTL UAN

exten => 8310171,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8310171,2,Goto(Mainmenu,s,1) ;NTL UAN

exten => 8310172,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8310172,2,Goto(Mainmenu,s,1) ;NTL UAN


;NTLROOM
exten => 8310161,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8310161,2,Dial(SIP/NTL-CC-OFF/161,60,rtT)

;ESTEST
;exten => 8444015,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
;exten => 8444015,2,Dial(SIP/NTL-CC-ES/997,60,rtT)

;aqeel sb access outside the network
exten => 8310811,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8310811,2,Dial(SIP/NTL-CC-OFF/811,60,rtT)


exten => 8435188,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;test ngn did
exten => 8435188,2,Goto(Mainmenu,s,1)

exten => 8444333,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8444333,2,Dial(SIP/NTL-CC-OFF/8444333,60,tT)
;exten => 8444333,2,Dial(SIP/gcc-off/8444333,60,rtT) ;Store DID

exten => 8310453,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8310453,2,Dial(SIP/453,60,tT) ;


exten => 8310999,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8310999,2,Dial(SIP/gcc-off/999,60,rtT) ;Audiocon DID

exten => 8310561,1,Goto(LOCKIVR,s,1) ;Test DID


;---------------------------------Direct Queue Dialing-------------------------------
;Dialing Sales Queue

exten => 8310082,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8310082,2,Dial(SIP/sip-cc2-gw1-p/82,60,rtT)

;Dialing Billing Queue

exten => 8310083,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8310083,2,Dial(SIP/sip-cc2-gw1-p/83,60,rtT)

;Dialing Access-TAC Queue

exten => 8310084,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8310084,2,Dial(SIP/sip-cc2-gw1-p/84,60,rtT)  ; before L2 TAC merger

;exten => 8310084,2,Dial(SIP/sip-cc2-gw1-p/87,60,rtT)  ;  L2 TAC merger


;Dialing Systems Queue

exten => 8310086,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8310086,2,Dial(SIP/sip-cc2-gw1-p/86,60,rtT)

;Dialing Core-TAC Queue

exten => 8310087,1,Set(CALLERID(NUM)=0${CALLERID(num)})  ;Append Zero To CallerID
exten => 8310087,2,Dial(SIP/sip-cc2-gw1-p/87,60,rtT)

;HotLine
;;exten => 8315555,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
;;exten => 8315555,2,Dial(SIP/NTL-CC-OFF/8315555,60,rtT)

;;;;;;;;;;;;;;;;assigned to wahaj sb on 19th aug as a hotline;;;;;;;
exten => 8779999,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8779999,2,Dial(SIP/NTL-CC-OFF/8779999,60,rtT)


;NTLROOM
;exten => 8310161,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
;exten => 8310161,2,Dial(SIP/NTL-CC-OFF/8310161,60,rtT)

exten => 8310610,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8310610,2,Dial(SIP/NTL-CC-OFF/8310610,60,rtT)

exten => 8316105,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => 8316105,2,Dial(SIP/NTL-CC-OFF/8316105,60,Tt)



;telemarketing

;exten => 8310088,1,Dial(SIP/NTL-CC-OFF/434&SIP/NTL-CC-OFF/435,60,tT)
exten => 8310088,1,Dial(SIP/NTL-CC-OFF/434,60,tT)  ; by Ghufran on request of Hira on 24th July 2020
exten => 8310088,2,Hangup


;exten => 8310419,1,Dial(SIP/NTL-CC-OFF/419&SIP/NTL-CC-OFF/435,60,tT)
exten => 8310419,1,Dial(SIP/NTL-CC-OFF/419,60,tT)  ; by Ghufran on request of Hira on 24th July 2020
exten => 8310419,2,Hangup

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OPBX extensions;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

exten => _X.,1,Set(CALLERID(num)=0${CALLERID(num)}) ;Append Zero To CallerID
exten => _X.,2,Goto(sip-office,${EXTEN:4},1)
exten => _X.,3,Hangup

[Mainmenu]
exten=> s,1,Answer()
exten=> s,2,GotoIfTime(07:00-10:30|thu|29|Jun?eidivr,s,1) ;Eid 2022 by Talal/NGN
exten=> s,3,Wait(1)
exten=> s,4,Set(TIMEOUT(response)=3)
;exten=> s,5,Background(newivr/welcome)
;exten=> s,5,Background(ENGLISH/welcomeeng1)
exten => s,5,Background(EngUrdu/Greetings)
;exten=> s,6,Background(EngUrdu/Welcome)
exten=> s,6,Background(EngUrdu/Welcome_new)    ;IVR changed on request of Zaki Bhai/TAC on 15/11/2022
exten=> 1,1,Goto(dial-tac-queue,81,1)
exten=> 2,1,Goto(dial-sales-queue,82,1)
exten=> 3,1,Goto(dial-billing-queue,83,1)
;exten=> 3,1,Goto(dial-tac-queue,81,1)
;exten=> 0,1,Goto(dial-tac-queue,441,1)        ; Umair-SRF by ALI malik
exten=> 0,1,Goto(Mainmenu,s,1)
exten=> 11,1,Goto(dial-tac-queue,81,1)
exten=> 12,1,Goto(dial-tac-queue,81,1)
exten=> 111,1,Goto(dial-tac-queue,81,1)
exten=> 1111,1,Goto(dial-tac-queue,81,1)
exten=> 77,1,Goto(dial-NSS-queue,${EXTEN},1)
exten=> 17,1,Goto(dial-muuds-queue,${EXTEN},1)
exten=> 177,1,Goto(dial-muuds-queue,17,1)
exten=> 18,1,Goto(dial-muuds-queue-urdu,${EXTEN},1)

exten=> 84,1,Goto(dial-access-queue,${EXTEN},1)  ; before L2 merger

;exten=> 84,1,Goto(dial-core-queue,87,1)  ; L2 TAC merger

;exten=> 86,1,Goto(dial-core-queue,87,1)
;exten=> 56,1,Goto(dial-core-queue,87,1);------------Testing purpose
exten=> 87,1,Goto(dial-core-queue,${EXTEN},1)

exten=> 86,1,Goto(Dial-Core-Queue,${EXTEN},1)

exten=> 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)
exten => 92,1,Goto(dial-salespwr-queue,${EXTEN},1)
exten => 93,1,Goto(dial-BD-queue,${EXTEN},1) ;;; entry done by wajahat 23/9/19

include=> sip-office

exten=> t,1,Goto(Mainmenu,s,3)
exten=> i,1,Goto(Mainmenu,s,3)

;[TAC-menu]
;exten => s,1,GotoIfTime(13:30-14:00|fri|*|*?jumma,s,1)
;exten => s,2,Set(ivr=${DB(ivr/mbl)})
;exten => s,3,GotoIf($[${ivr}=0]?6:5)
;exten => s,4,Playback(problem-ivr/mbl/${ivr})
;exten => s,5,Playback(mbl-ivr/tac-trans)
;exten => s,6,Goto(dial-tac-queue,81,1)

;[Sales-menu]
;GotoIfTime(<time range>|<days of week>|<days of month>|<months>?[[context|]extension|]pri)
;exten => s,1,GotoIfTime(17:30-09:00|*|*|*?dial-tac-queue,81,2) 			;Normal Timings
;exten => s,2,GotoIfTime(*|sun|*|*?dial-tac-queue,81,2)					;Sunday Diversion to TAC
;exten => s,3,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)					;Jumma IVR
;exten => s,4,GotoIfTime(*|*|15-18|oct?dial-tac-queue,81,2) 				;Eid diversion
;exten => s,5,Dial(SIP/pcc-gcc/82,1)
;exten => s,5,Goto(dial-sales-queue,82,1)

;exten => s,5,Background(newivr/welcome_sales)           ;Play Welcome Sales Message
;exten => 1,1,Goto(dial-salesnew-queue,89,1)				;Goto Sales-New Queue
;exten => 2,1,Goto(dial-salesinfo-queue,82,1) 			;Goto Sales-General Info Queue

;exten=> t,1,Goto(Sales-menu,s,1)
;exten=> i,1,Goto(Sales-menu,s,1)

;[Billing-menu]
;GotoIfTime(<time range>|<days of week>|<days of month>|<months>?[[context|]extension|]pri)
;exten => s,1,GotoIfTime(17:30-09:00|*|*|*?dial-tac-queue,81,2) 			;Normal Timings
;exten => s,2,GotoIfTime(*|sun|*|*?dial-tac-queue,81,2)					;Sunday Diversion to TAC
;exten => s,3,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)					;Jumma IVR
;exten => s,4,GotoIfTime(*|*|15-18|oct?dial-tac-queue,81,2) 				;Eid diversion
;exten => s,5,Dial(SIP/pcc-gcc/83,1)

;exten => s,5,Goto(dial-billing-queue,83,1)								;Goto Billing Queue


[System-Check]
exten => _5X,1,Dial(SIP/gcc-off/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => _7XXXX,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)

exten => 788,1,Goto(System,${EXTEN},1)
exten => 789,1,Goto(System,${EXTEN},1)
;exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)
exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,${EXTEN},1) ; before L2 merger
exten => 77,1,Goto(dial-NSS-queue,77,1)



;exten => 84,1,Goto(dial-core-queue,87,1) ; L2 TAC merger

exten => 85,1,Goto(dial-ntl-queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 62X,1,Goto(billing-internal,${EXTEN},1)
exten => _X.,1,Goto(System,${EXTEN},1)

[System]
include=> System-Queue-Login
include=> system-internal
include=> internal
include=> dial-system-queue
include=> System-DialOut

[System-Queue-Login]
exten => 788,1,Goto(System-login,2,1)
exten => 789,1,Goto(System-logout,1,1)

[System-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _5XXX,1,Set(xx=${DB(SYS-IN/${CALLERID(NUM)})})
exten => _5XXX,2,GotoIf($[${xx}=7]?15)
exten => _5XXX,3,Playback(agent-pass)
exten => _5XXX,4,Read(PASS)
exten => _5XXX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _5XXX,6,GotoIf($[${abc}=7]?13)
exten => _5XXX,7,AddQueueMember(SYS-IN,SIP/${CALLERID(NUM)})
exten => _5XXX,8,Set(DB(SYS-IN/${CALLERID(NUM)})=7)
exten => _5XXX,9,Playback(agent-loginok)
exten => _5XXX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _5XXX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _5XXX,12,Goto(system-login,_5XXX,17)
exten => _5XXX,13,Playback(auth-incorrect)
exten => _5XXX,14,Goto(system-login,${EXTEN},4)
exten => _5XXX,15,Playback(agent-alreadyon)
exten => _5XXX,16,Goto(system-login,2,1)
exten => _5XXX,17,Hangup()

[System-logout]
exten => 1,1,Background(agent-user)
exten => _5XXX,1,Playback(agent-pass)
exten => _5XXX,2,read(PASS)
exten => _5XXX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _5XXX,4,GotoIf($[${abc}=7]?11)
exten => _5XXX,5,SET(DB(SYS-IN/${CALLERID(NUM)})=0)
exten => _5XXX,6,RemoveQueueMember(SYS-IN,SIP/${CALLERID(NUM)})
exten => _5XXX,7,Playback(agent-loggedoff)
exten => _5XXX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _5XXX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _5XXX,10,Goto(system-logout,_5XXX,13)
exten => _5XXX,11,Playback(auth-incorrect)
exten => _5XXX,12,Goto(system-logout,${EXTEN},2)
exten => _5XXX,13,Hangup()

[system-internal]
exten => _62X,1,Dial(SIP/${EXTEN},60,rt)
exten => _62X,2,Hangup


[Tac-Access-Check]


;exten => _56xx,1,Dial(SIP/{EXTEN},60,rtT)    ; Work from home corona by muuds

exten => _5X,1,Dial(SIP/gcc-off/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => _7X,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)
exten => _8xxx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)

exten => 788,1,Goto(Tac-Access,${EXTEN},1)
exten => 789,1,Goto(Tac-Access,${EXTEN},1)
;exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)    ; uncomment when Tac que is shifted to NEWCC
;exten => 81,1,Dial(SIP/NTL-CC-SEC/${EXTEN},1)     ; FOr TAC Calls from AccessQ to PCC; COmment when TACQ is shifted to NEWCC
;exten => 81,1,Dial(SIP/NTL-CC-PRI/${EXTEN},1)
;exten => 81,1,Goto(Tac-Access-test,${EXTEN},1)


exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)
exten => 200,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,trT)

exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)   ; uncomment when Tac que is shifted to NEWCC
;exten => 82,1,Dial(SIP/NTL-CC-SEC/${EXTEN},1)      ; FOR SALES Calls from AccessQ to SEC CC; Comment when SALQ is shifted to NEWCC

exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)  ;uncomment when Tac que is shifted to NEWCC
;exten => 83,1,Dial(SIP/NTL-CC-SEC/${EXTEN},1)     ; FOR BILLING Calls from AccessQ to SEC CC; Comment when BILLQ is shifted to NEWCC

exten => 85,1,Goto(dial-ntl-queue,${EXTEN},1)
;exten => 86,1,Goto(dial-system-queue,${EXTEN},1)
exten => 86,1,Goto(Dial-Core-Queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)
exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,${EXTEN},1); before l2 merger

;exten => 84,1,Goto(dial-core-queue,87,1) ; L2 TAC merger

;exten => 61X,1,Goto(billing-internal,${EXTEN},1)
exten => _X.,1,Goto(Tac-Access,${EXTEN},1)

[Tac-Access-Queue-Login]
exten => 788,1,Goto(Access-login,2,1)
exten => 789,1,Goto(Access-logout,1,1)

[Access-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _4XXX,1,Set(xx=${DB(ACC-IN/${CALLERID(NUM)})})
exten => _4XXX,2,GotoIf($[${xx}=7]?15)
exten => _4XXX,3,Playback(agent-pass)
exten => _4XXX,4,Read(PASS)
exten => _4XXX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _4XXX,6,GotoIf($[${abc}=7]?13)
exten => _4XXX,7,AddQueueMember(ACC-IN,SIP/${CALLERID(NUM)})
exten => _4XXX,8,Set(DB(ACC-IN/${CALLERID(NUM)})=7)
exten => _4XXX,9,Playback(agent-loginok)
exten => _4XXX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _4XXX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _4XXX,12,Goto(Access-login,_4XXX,17)
exten => _4XXX,13,Playback(auth-incorrect)
exten => _4XXX,14,Goto(Access-login,${EXTEN},4)
exten => _4XXX,15,Playback(agent-alreadyon)
exten => _4XXX,16,Goto(Access-login,2,1)
exten => _4XXX,17,Hangup()

[Access-logout]
exten => 1,1,Background(agent-user)
exten => _4XXX,1,Playback(agent-pass)
exten => _4XXX,2,read(PASS)
exten => _4XXX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _4XXX,4,GotoIf($[${abc}=7]?11)
exten => _4XXX,5,SET(DB(ACC-IN/${CALLERID(NUM)})=0)
exten => _4XXX,6,RemoveQueueMember(ACC-IN,SIP/${CALLERID(NUM)})
exten => _4XXX,7,Playback(agent-loggedoff)
exten => _4XXX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _4XXX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _4XXX,10,Goto(Access-logout,_4XXX,13)
exten => _4XXX,11,Playback(auth-incorrect)
exten => _4XXX,12,Goto(Access-logout,${EXTEN},2)
exten => _4XXX,13,Hangup()

[Tac-Access]
include=> Tac-Access-Queue-Login
include=> access-internal
include=> internal
include=> dial-access-queue
include=> Access-DialOut

[Billing-Queue-Login]
exten => 788,1,Goto(Billing-login,2,1)
exten => 789,1,Goto(Billing-logout,1,1)

[Billing-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _3XXX,1,Set(xx=${DB(BIL-IN/${CALLERID(NUM)})})
exten => _3XXX,2,GotoIf($[${xx}=7]?15)
exten => _3XXX,3,Playback(agent-pass)
exten => _3XXX,4,Read(PASS)
exten => _3XXX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _3XXX,6,GotoIf($[${abc}=7]?13)
exten => _3XXX,7,AddQueueMember(BIL-IN,SIP/${CALLERID(NUM)})
exten => _3XXX,8,Set(DB(BIL-IN/${CALLERID(NUM)})=7)
exten => _3XXX,9,Playback(agent-loginok)
exten => _3XXX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _3XXX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _3XXX,12,Goto(Billing-login,_3XXX,17)
exten => _3XXX,13,Playback(auth-incorrect)
exten => _3XXX,14,Goto(Billing-login,${EXTEN},4)
exten => _3XXX,15,Playback(agent-alreadyon)
exten => _3XXX,16,Goto(Billing-login,2,1)
exten => _3XXX,17,Hangup()

[access-internal]
exten => _64X,1,Dial(SIP/${EXTEN},60,rt)
exten => _64X,2,Hangup


[Billing-logout]
exten => 1,1,Background(agent-user)
exten => _3XXX,1,Playback(agent-pass)
exten => _3XXX,2,read(PASS)
exten => _3XXX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _3XXX,4,GotoIf($[${abc}=7]?11)
exten => _3XXX,5,SET(DB(BIL-IN/${CALLERID(NUM)})=0)
exten => _3XXX,6,RemoveQueueMember(BIL-IN,SIP/${CALLERID(NUM)})
exten => _3XXX,7,Playback(agent-loggedoff)
exten => _3XXX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _3XXX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _3XXX,10,Goto(Billing-logout,_3XXX,13)
exten => _3XXX,11,Playback(auth-incorrect)
exten => _3XXX,12,Goto(Billing-logout,${EXTEN},2)
exten => _3XXX,13,Hangup()

[MBLTAC-Queue-Login]
exten => 788,1,Goto(MBLTAC-login,2,1)
exten => 789,1,Goto(MBLTAC-logout,1,1)

[MBLTAC-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _1XXX,1,Set(xx=${DB(TAC-IN/${CALLERID(NUM)})})
exten => _1XXX,2,GotoIf($[${xx}=7]?15)
exten => _1XXX,3,Playback(agent-pass)
exten => _1XXX,4,Read(PASS)
exten => _1XXX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _1XXX,6,GotoIf($[${abc}=7]?13)
exten => _1XXX,7,AddQueueMember(TAC-IN,SIP/${CALLERID(NUM)})
exten => _1XXX,8,Set(DB(TAC-IN/${CALLERID(NUM)})=7)
exten => _1XXX,9,Playback(agent-loginok)
exten => _1XXX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _1XXX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _1XXX,12,Goto(MBLTAC-login,_1XXX,17)
exten => _1XXX,13,Playback(auth-incorrect)
exten => _1XXX,14,Goto(MBLTAC-login,${EXTEN},4)
exten => _1XXX,15,Playback(agent-alreadyon)
exten => _1XXX,16,Goto(MBLTAC-login,2,1)
exten => _1XXX,17,Hangup()



[MBLTAC-logout]
exten => 1,1,Background(agent-user)
exten => _1XXX,1,Playback(agent-pass)
exten => _1XXX,2,read(PASS)
exten => _1XXX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _1XXX,4,GotoIf($[${abc}=7]?11)
exten => _1XXX,5,SET(DB(TAC-IN/${CALLERID(NUM)})=0)
exten => _1XXX,6,RemoveQueueMember(TAC-IN,SIP/${CALLERID(NUM)})
exten => _1XXX,7,Playback(agent-loggedoff)
exten => _1XXX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _1XXX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _1XXX,10,Goto(MBLTAC-logout,_1XXX,13)
exten => _1XXX,11,Playback(auth-incorrect)
exten => _1XXX,12,Goto(MBLTAC-logout,${EXTEN},2)
exten => _1XXX,13,Hangup()

[NTLTAC-Queue-Login]
exten => 788,1,Goto(NTLTAC-login,2,1)
exten => 789,1,Goto(NTLTAC-logout,1,1)

[NTLTAC-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _1XXX,1,SET(xx=${DB(NTL-IN/${CALLERID(NUM)})})
exten => _1XXX,2,GotoIf($[${xx}=7]?14)
exten => _1XXX,3,Playback(agent-pass)
exten => _1XXX,4,Read(PASS)
exten => _1XXX,5,AGI(agent-auth.agi|${EXTEN}|${PASS})
exten => _1XXX,6,GotoIf($[${abc}=7]?12)
exten => _1XXX,7,AddQueueMember(NTL-IN|SIP/${CALLERID(NUM)})
exten => _1XXX,8,SET(${DB(NTL-IN/${CALLERID(NUM)})}=7)
exten => _1XXX,9,Playback(agent-loginok)
exten => _1XXX,10,AGI(agent-log.agi|${EXTEN}|${CALLERID(NUM)}|login)
exten => _1XXX,11,Goto(NTLTAC-login,_1XXX,16)
exten => _1XXX,12,Playback(auth-incorrect)
exten => _1XXX,13,Goto(NTLTAC-login,${EXTEN},4)
exten => _1XXX,14,Playback(agent-alreadyon)
exten => _1XXX,15,Goto(NTLTAC-login,3,1)
exten => _1XXX,16,Hangup()

[NTLTAC-logout]
exten => 1,1,Background(agent-user)
exten => _1XXX,1,Playback(agent-pass)
exten => _1XXX,2,Read(PASS)
exten => _1XXX,3,AGI(agent-auth.agi|${EXTEN}|${PASS})
exten => _1XXX,4,GotoIf($[${abc}=7]?10)
exten => _1XXX,5,SET(${DB(NTL-IN/${CALLERID(NUM)})}=0)
exten => _1XXX,6,RemoveQueueMember(NTL-IN|SIP/${CALLERID(NUM)})
exten => _1XXX,7,Playback(agent-loggedoff)
exten => _1XXX,8,AGI(agent-log.agi|${EXTEN}|${CALLERID(NUM)}|logout)
exten => _1XXX,9,Goto(NTLTAC-logout,_1XXX,12)
exten => _1XXX,10,Playback(auth-incorrect)
exten => _1XXX,11,Goto(NTLTAC-logout,${EXTEN},2)
exten => _1XXX,12,Hangup()

[Sales-Queue-Login]
exten => 788,1,Goto(Sales-login,2,1)
exten => 789,1,Goto(Sales-logout,1,1)

[Sales-login]
;exten => 2,1,Background(agent-user)
;exten => 3,1,NoOp,${CALLERID}
;exten => _2XXX,1,Set(xx=${DB(SAL-IN/${CALLERID(NUM)})})
;exten => _2XXX,2,GotoIf($[${xx}=7]?15)
;exten => _2XXX,3,Playback(agent-pass)
;exten => _2XXX,4,Read(PASS)
;exten => _2XXX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
;exten => _2XXX,6,GotoIf($[${abc}=7]?13)
;exten => _2XXX,7,AddQueueMember(SAL-IN,SIP/${CALLERID(NUM)})
;exten => _2XXX,8,Set(DB(SAL-IN/${CALLERID(NUM)})=7)
;exten => _2XXX,9,Playback(agent-loginok)
;exten => _2XXX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
;exten => _2XXX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
;exten => _2XXX,12,Goto(sales-login,_2XXX,17)
;exten => _2XXX,13,Playback(auth-incorrect)
;exten => _2XXX,14,Goto(sales-login,${EXTEN},4)
;exten => _2XXX,15,Playback(agent-alreadyon)
;exten => _2XXX,16,Goto(sales-login,2,1)
;exten => _2XXX,17,Hangup()

exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _20XX,1,Set(xx=${DB(SAL-IN/${CALLERID(NUM)})})
exten => _20XX,2,GotoIf($[${xx}=7]?15)
exten => _20XX,3,Playback(agent-pass)
exten => _20XX,4,Read(PASS)
exten => _20XX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _20XX,6,GotoIf($[${abc}=7]?13)
exten => _20XX,7,AddQueueMember(SAL-IN,SIP/${CALLERID(NUM)})
exten => _20XX,8,Set(DB(SAL-IN/${CALLERID(NUM)})=7)
exten => _20XX,9,Playback(agent-loginok)
exten => _20XX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _20XX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _20XX,12,Goto(sales-login,_20XX,17)
exten => _20XX,13,Playback(auth-incorrect)
exten => _20XX,14,Goto(sales-login,${EXTEN},4)
exten => _20XX,15,Playback(agent-alreadyon)
exten => _20XX,16,Goto(sales-login,2,1)
exten => _20XX,17,Hangup()

exten => _21XX,1,Set(xx=${DB(SAL-IN/${CALLERID(NUM)})})
exten => _21XX,2,GotoIf($[${xx}=7]?15)
exten => _21XX,3,Playback(agent-pass)
exten => _21XX,4,Read(PASS)
exten => _21XX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _21XX,6,GotoIf($[${abc}=7]?13)
exten => _21XX,7,AddQueueMember(salfsd-IN,SIP/${CALLERID(NUM)})
exten => _21XX,8,Set(DB(SAL-IN/${CALLERID(NUM)})=7)
exten => _21XX,9,Playback(agent-loginok)
exten => _21XX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _21XX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _21XX,12,Goto(sales-login,_21XX,17)
exten => _21XX,13,Playback(auth-incorrect)
exten => _21XX,14,Goto(sales-login,${EXTEN},4)
exten => _21XX,15,Playback(agent-alreadyon)
exten => _21XX,16,Goto(sales-login,2,1)
exten => _21XX,17,Hangup()

exten => _22XX,1,Set(xx=${DB(SAL-IN/${CALLERID(NUM)})})
exten => _22XX,2,GotoIf($[${xx}=7]?15)
exten => _22XX,3,Playback(agent-pass)
exten => _22XX,4,Read(PASS)
exten => _22XX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _22XX,6,GotoIf($[${abc}=7]?13)
exten => _22XX,7,AddQueueMember(salsgd-IN,SIP/${CALLERID(NUM)})
exten => _22XX,8,Set(DB(SAL-IN/${CALLERID(NUM)})=7)
exten => _22XX,9,Playback(agent-loginok)
exten => _22XX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _22XX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _22XX,12,Goto(sales-login,_22XX,17)
exten => _22XX,13,Playback(auth-incorrect)
exten => _22XX,14,Goto(sales-login,${EXTEN},4)
exten => _22XX,15,Playback(agent-alreadyon)
exten => _22XX,16,Goto(sales-login,2,1)
exten => _22XX,17,Hangup()


[Sales-logout]
;exten => 1,1,Background(agent-user)
;exten => _2XXX,1,Playback(agent-pass)
;exten => _2XXX,2,read(PASS)
;exten => _2XXX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
;exten => _2XXX,4,GotoIf($[${abc}=7]?11)
;exten => _2XXX,5,SET(DB(SAL-IN/${CALLERID(NUM)})=0)
;exten => _2XXX,6,RemoveQueueMember(SAL-IN,SIP/${CALLERID(NUM)})
;exten => _2XXX,7,Playback(agent-loggedoff)
;exten => _2XXX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
;exten => _2XXX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
;exten => _2XXX,10,Goto(sales-logout,_2XXX,13)
;exten => _2XXX,11,Playback(auth-incorrect)
;exten => _2XXX,12,Goto(sales-logout,${EXTEN},2)
;exten => _2XXX,13,Hangup()


exten => 1,1,Background(agent-user)
exten => _20XX,1,Playback(agent-pass)
exten => _20XX,2,read(PASS)
exten => _20XX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _20XX,4,GotoIf($[${abc}=7]?11)
exten => _20XX,5,SET(DB(SAL-IN/${CALLERID(NUM)})=0)
exten => _20XX,6,RemoveQueueMember(SAL-IN,SIP/${CALLERID(NUM)})
exten => _20XX,7,Playback(agent-loggedoff)
exten => _20XX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _20XX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _20XX,10,Goto(sales-logout,_20XX,13)
exten => _20XX,11,Playback(auth-incorrect)
exten => _20XX,12,Goto(sales-logout,${EXTEN},2)
exten => _20XX,13,Hangup()

exten => _21XX,1,Playback(agent-pass)
exten => _21XX,2,read(PASS)
exten => _21XX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _21XX,4,GotoIf($[${abc}=7]?11)
exten => _21XX,5,SET(DB(SAL-IN/${CALLERID(NUM)})=0)
exten => _21XX,6,RemoveQueueMember(salfsd-IN,SIP/${CALLERID(NUM)})
exten => _21XX,7,Playback(agent-loggedoff)
exten => _21XX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _21XX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _21XX,10,Goto(sales-logout,_20XX,13)
exten => _21XX,11,Playback(auth-incorrect)
exten => _21XX,12,Goto(sales-logout,${EXTEN},2)
exten => _21XX,13,Hangup()

exten => _22XX,1,Playback(agent-pass)
exten => _22XX,2,read(PASS)
exten => _22XX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _22XX,4,GotoIf($[${abc}=7]?11)
exten => _22XX,5,SET(DB(SAL-IN/${CALLERID(NUM)})=0)
exten => _22XX,6,RemoveQueueMember(salsgd-IN,SIP/${CALLERID(NUM)})
exten => _22XX,7,Playback(agent-loggedoff)
exten => _22XX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _22XX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _22XX,10,Goto(sales-logout,_22XX,13)
exten => _22XX,11,Playback(auth-incorrect)
exten => _22XX,12,Goto(sales-logout,${EXTEN},2)
exten => _22XX,13,Hangup()

[Operator-Check]  ; new context for operator ext 441 by muuds  

exten => 722,1,Dial(SIP/722,60,rtT)
exten => 722,2,Hangup()
exten => 701,1,Dial(SIP/701,60,rtT)
exten => 701,2,Hangup()
exten => 720,1,Dial(SIP/720,60,rtT)
exten => 720,2,Hangup()
exten => 719,1,Dial(SIP/719,60,rtT)
exten => 719,2,Hangup()

exten => _5X,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => _7X,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)

exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)



;exten => 788,1,Goto(TAC,${EXTEN},1)
;exten => 789,1,Goto(TAC,${EXTEN},1)

exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)
;exten => 82,1,Dial(SIP/pcc-gcc/82)
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)
exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,${EXTEN},1);before l2 merger////Emergency shifting of TAC Access queue from CC1 to CC2 on dated 05-11-09


;exten => 84,1,Goto(dial-core-queue,87,1) ;L2 TAC merger

exten => 85,1,Goto(dial-ntl-queue,${EXTEN},1)
exten => 86,1,Goto(dial-system-queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)
exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)
;exten => 21X,1,Goto(tac-internal,${EXTEN},1
;exten => 2XZ,1,Goto(tac-internal,${EXTEN},1)
;exten => 210,1,Goto(tac-internal,${EXTEN},1)
exten => _X.,1,Goto(Operator-DialOut,${EXTEN},1)

[Operator-DialOut]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=Operator-Out)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=8310000)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=Operator-Out)
;exten => _003XXXXXXXXX,n,MixMonitor(Operator-Out-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _003XXXXXXXXX,n,Monitor(wav,Operator-Out-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-OPERATOR-OUT-F${CALLER}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _0Z.,1,Set(QDIALER_QUEUE=Operator-Out)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0Z.,n,Set(CALLERID(NUM)=8310000)
exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _0Z.,n,Set(QueueName=Operator-Out)
;exten => _0Z.,n,MixMonitor(Operator-Out-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav,Operator-Out-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-OPERATOR-OUT-F${CALLER}-T${EXTEN},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _XXX,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN})
exten => _XXX,n,Set(QueueName=Operator-Out)
;exten => _XXX,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _xxx,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-OPERATOR-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)



[NSS-Awam]  ;done by muuds on NSS req

exten => 722,1,Dial(SIP/722,60,rtT)
exten => 722,2,Hangup()
exten => 701,1,Dial(SIP/701,60,rtT)
exten => 701,2,Hangup()
exten => 720,1,Dial(SIP/720,60,rtT)
exten => 720,2,Hangup()
exten => 721,1,Dial(SIP/721,60,rtT)
exten => 721,2,Hangup()
exten => 719,1,Dial(SIP/719,60,rtT)
exten => 719,2,Hangup()
exten => 724,1,Dial(SIP/724,60,rtT)
exten => 724,2,Hangup()
exten => 725,1,Dial(SIP/725,60,rtT)
exten => 725,2,Hangup()

exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)
exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,${EXTEN},1)
exten => 85,1,Goto(dial-ntl-queue,${EXTEN},1)
exten => 86,1,Goto(dial-system-queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)
exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)


exten => _1xx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)
exten => 200,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)
exten => _3xx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)
exten => _4xx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)
exten => _5xx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)
exten => _6xx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)
exten => _7xx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)
exten => _8xx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)
exten => _9xx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)

exten => _2xxx,1,Dial(SIP/NTL-CC-FSD/${EXTEN},60,rtT)
exten => _3xxx,1,Dial(SIP/pwropbx2primcc/${EXTEN},60,rtT)
exten => _4xxx,1,Dial(SIP/grwopbx2primcc/${EXTEN},60,rtT)
exten => _6xxx,1,Dial(SIP/sgdopbx2primcc/${EXTEN},60,rtT)
exten => _7xxx,1,Dial(SIP/mtnopbx2primcc/${EXTEN},60,rtT)
exten => _8xxX,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)

[TAC-Check]

exten => _52xx,1,Dial(SIP/${EXTEN},60,rtT)    ; Work from home corona by muuds
;exten => _2XZ,1,Dial(SIP/${EXTEN},60,t)
exten => _5X,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => 77,1,Goto(dial-NSS-queue,${EXTEN},1)
exten => _7X,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)
exten => _4xxx,1,Dial(SIP/grwopbx2primcc/${EXTEN},60,rtT)
exten => _6xxx,1,Dial(SIP/sgdopbx2primcc/${EXTEN},60,rtT)
exten => _8xxx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)

exten => _10,1,Goto(TAC-Pause,10,1)
exten => _11,1,Goto(TAC-Pause,11,1)

exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)

exten => 788,1,Goto(TAC,${EXTEN},1)
exten => 789,1,Goto(TAC,${EXTEN},1)

;exten => 82,1,Dial(SIP/pcc-gcc/82)
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)
exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,${EXTEN},1);before l2 merger////Emergency shifting of TAC Access queue from CC1 to CC2 on dated 05-11-09


;exten => 84,1,Goto(dial-core-queue,87,1) ;L2 TAC merger

exten => 85,1,Goto(dial-ntl-queue,${EXTEN},1)
;exten => 86,1,Goto(dial-system-queue,${EXTEN},1)
exten => 86,1,Goto(Dial-Core-Queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)
exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)
;;;;exten => 21X,1,Goto(tac-internal,${EXTEN},1
;;;;exten => _2XZ,1,Goto(tac-internal,${EXTEN},1)
exten => _2XX,1,Goto(tac-internal,${EXTEN},1)
;exten => 210,1,Goto(tac-internal,${EXTEN},1)
exten => 81,1,Goto(TAC,${EXTEN},1)
exten => _X.,1,Goto(TAC,${EXTEN},1)
;exten=> 77,1,Goto(dial-NSS-queue,${EXTEN},1)

include =>dial-operator-queue
include =>dial-muuds-queue

[SALES-Check]


exten => _53xx,1,Dial(SIP/${EXTEN},60,rtT)    ; Work from home corona by muuds

exten => _5X,1,Dial(SIP/gcc-off/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => _7X,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)
exten => _4xxx,1,Dial(SIP/grwopbx2primcc/${EXTEN},60,rtT)
exten => _8xxx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)

exten => _10,1,Goto(SAL-Pause,10,1)    ;Done as per salman bhai req
exten => _11,1,Goto(SAL-Pause,11,1)

exten => 788,1,Goto(SALES,${EXTEN},1)
exten => 789,1,Goto(SALES,${EXTEN},1)


exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)


exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)
exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,${EXTEN},1) ;before l2 merger, Added for Emergency Shifting
exten => 69,1,Goto(dial-bilsales-queue,${EXTEN},1)

;exten => 84,1,Goto(dial-core-queue,87,1)    ;L2 TAC merger
exten => 86,1,Goto(Dial-Core-Queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)     
exten => 85,1,Goto(dial-ntl-queue,${EXTEN},1)
exten => 88,1,Goto(dial-TELM-queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)
exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)
exten => _40X,1,Goto(sales-internal,${EXTEN},1)
exten => _46X,1,Goto(sales-internal,${EXTEN},1)
exten => _58X,1,Goto(sales-internal,${EXTEN},1)
exten => 92,1,Goto(dial-salespwr-queue,${EXTEN},1)

exten => _X.,1,Goto(SALES,${EXTEN},1)
exten=> 77,1,Goto(dial-NSS-queue,${EXTEN},1)
;include =>dial-operator-queue

[SAL-Pause]
exten => 10,1,PauseQueueMember(SAL-IN,SIP/${CALLERID(num)},,Test Pause Code)
exten => 10,n,Hangup()

exten => 11,1,UnPauseQueueMember(SAL-IN,SIP/${CALLERID(num)})
exten => 11,n,Hangup()




[BILLING-Check]


exten => _54xx,1,Dial(SIP/${EXTEN},60,rtT)    ; Work from home corona by muuds

exten => _5X,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => _7X,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)
exten => _4xxx,1,Dial(SIP/grwopbx2primcc/${EXTEN},60,rtT)
exten => _8xxx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)

exten => _10,1,Goto(BIL-Pause,10,1)
exten => _11,1,Goto(BIL-Pause,11,1)

exten => 788,1,Goto(BILLING,${EXTEN},1)
exten => 789,1,Goto(BILLING,${EXTEN},1)

exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)


exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)
exten => 85,1,Goto(dial-ntl-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,${EXTEN},1) ;before l2 merger, Added for Emergency Shifting


;exten => 84,1,Goto(dial-core-queue,87,1) ; L2 TAC merger

;exten => 86,1,Goto(dial-system-queue,${EXTEN},1)     ; Added for Emergency Shifting
exten => 86,1,Goto(Dial-Core-Queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)
exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)
;exten => _4XX,1,Goto(billing-internal,${EXTEN},1)
exten => _45X,1,Goto(billing-internal,${EXTEN},1)
exten => _46X,1,Goto(billing-internal,${EXTEN},1)
exten => _48X,1,Goto(billing-internal,${EXTEN},1)
exten => _X.,1,Goto(BILLING,${EXTEN},1)
;include =>dial-operator-queue
exten=> 77,1,Goto(dial-NSS-queue,${EXTEN},1)

[TAC-NTL-Check]
exten => _5X,1,Dial(SIP/pcc-off/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => _7X,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)
exten => _4xxx,1,Dial(SIP/grwopbx2primcc/${EXTEN},60,rtT)

exten => 788,1,Goto(TAC-NTL,${EXTEN},1)
exten => 789,1,Goto(TAC-NTL,${EXTEN},1)
exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)

exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)

exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,${EXTEN},1) ; before l2 TAC merger


;exten => 84,1,Goto(dial-core-queue,87,1)  ; L2 TAC merger

exten => 86,1,Goto(dial-system-queue,${EXTEN},1)     
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)
exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)
exten => 2XZ,1,Goto(tac-internal),${EXTEN},1)
exten => _X.,1,Goto(TAC-NTL,${EXTEN},1)

[TAC]
include=> MBLTAC-Queue-Login 
include=> tac-internal
include=> internal
;include=> dial-tac-queue
include=> TAC-DialOut
include=> TAC-test

[TAC-test]
exten => 81,1,Playback(EngUrdu/tac_queue_ivr)  ;Eng Urdu IVR by Zaeem
exten => 81,2,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
exten => 81,3,Monitor(wav,${MONITOR_FILENAME},m)
exten => 81,4,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 81,5,Set(_CALLER=${CALLERID(NUM)})
exten => 81,6,set(_EXTEN=${EXTEN})
exten => 81,7,Queue(TAC-IN,tTc,,,,,,macro-queuemacro) ;changed on 26NOv due to suspected issuei , previous was the line above
exten => 81,8,Goto(queuefeedbackk,81,1)
exten => 81,9,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup


[TAC-Pause]
exten => 10,1,PauseQueueMember(TAC-IN,SIP/${CALLERID(num)},,Test Pause Code)
exten => 10,n,Hangup()

exten => 11,1,UnPauseQueueMember(TAC-IN,SIP/${CALLERID(num)})
exten => 11,n,Hangup()


[Tx-Pause]
exten => 10,1,PauseQueueMember(TX-IN,SIP/${CALLERID(num)},,Test Pause Code)
exten => 10,n,Hangup()

exten => 11,1,UnPauseQueueMember(TX-IN,SIP/${CALLERID(num)})
exten => 11,n,Hangup()

[BIL-Pause]
exten => 10,1,PauseQueueMember(BIL-IN,SIP/${CALLERID(num)},,Test Pause Code)
exten => 10,n,Hangup()

exten => 11,1,UnPauseQueueMember(BIL-IN,SIP/${CALLERID(num)})
exten => 11,n,Hangup()


[SALES]
include=> Sales-Queue-Login 
include=> sales-internal
include=> dial-operator-queue
include=> internal
include=> dial-tac-queue
include=> SALES-DialOut

[BILLING]
include=> Billing-Queue-Login 
include=> billing-internal
include=> dial-operator-queue
include=> internal
include=> dial-tac-queue
include=> BILLING-DialOut

[TAC-NTL]
include=> NTLTAC-Queue-Login 
include=> ttac-internalac-internal
include=> internal
include=> dial-ntl-queue
include=> NTL-DialOut


[internal]
;exten=> _200,1,Goto(dial-office,${EXTEN},1)
;exten=> _200,2,Hangup

exten => _2XZ,1,Goto(dial-tac-queue,81,1)
exten => _40X,1,Goto(dial-sales-queue,82,1)
exten => _45X,1,Goto(dial-billing-queue,83,1)
exten => _64X,1,Goto(dial-access-queue,84,1) ; before L2 TAC merger

;exten => _64X,1,Goto(dial-core-queue,87,1) ; L2 TAC merger

exten => _62X,1,Goto(dial-system-queue,86,1)
;exten => _56X,1,Goto(dial-salfsd-queue,90,1)

;exten => _XXX,1,Goto(dial-office,${EXTEN},1)
;exten => _XXX,2,Hangup()


[dial-operator-queue]
exten => 441,1,GotoIfTime(17:30-09:00,*,*,*?dial-operator-queue,441,100)  ;Normal Timings before ramzan
;exten => 441,1,GotoIfTime(15:30-09:00,*,*,*?dial-operator-queue,441,100)
;exten => 441,n,GotoIfTime(09:00-17:30|fri|05|feb?dial-operator-queue,441,100)  ;kashmir day by faiza
exten => 441,n,GotoIfTime(09:00-17:30|*|28-30|june?dial-operator-queue,441,100)  ;Iqbal Day 2022 diversion by Talal/NGN 
exten => 441,n,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)
exten => 441,n,NoOp(${CALLERID(num)})
exten => 441,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-OPERATOR-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
exten => 441,n,Monitor(wav,${MONITOR_FILENAME},m)
exten => 441,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 441,n,Set(_CALLER=${CALLERID(NUM)})
exten => 441,n,Queue(Operator-In,tT)
exten => 441,n,Playback(beep)
;exten => 441,n,Queue(Operator-In,tT)
exten => 441,n,Hangup


exten => 441,100,Playback(ENGLISH/operator_unavailable)
exten => 441,n,Goto(dial-tac-queue,81,1)
exten => 441,n,Hangup

[Mehmood-Queue-Login]
exten => 788,1,Goto(mehmood-login,2,1)
exten => 789,1,Goto(mehmood-logout,1,1)

[mehmood-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _1XXX,1,Set(xx=${DB(Muuds-In/${CALLERID(NUM)})})
exten => _1XXX,2,GotoIf($[${xx}=7]?16)
exten => _1XXX,3,Playback(agent-pass)
exten => _1XXX,4,Read(PASS)
exten => _1XXX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _1XXX,6,GotoIf($[${abc}=7]?13)
exten => _1XXX,7,AddQueueMember(Muuds-In,SIP/${CALLERID(NUM)})
exten => _1XXX,8,AddQueueMember(Muudsur-In,SIP/${CALLERID(NUM)})
exten => _1XXX,9,Set(DB(Muuds-In/${CALLERID(NUM)})=7)
exten => _1XXX,10,Playback(agent-loginok)
exten => _1XXX,11,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _1XXX,12,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _1XXX,13,Goto(mehmood-login,_1XXX,18)
exten => _1XXX,14,Playback(auth-incorrect)
exten => _1XXX,15,Goto(mehmood-login,${EXTEN},4)
exten => _1XXX,16,Playback(agent-alreadyon)
exten => _1XXX,17,Goto(mehmood-login,2,1)
exten => _1XXX,18,Hangup()

[mehmood-logout]
exten => 1,1,Background(agent-user)
exten => _1XXX,1,Playback(agent-pass)
exten => _1XXX,2,read(PASS)
exten => _1XXX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _1XXX,4,GotoIf($[${abc}=7]?12)
exten => _1XXX,5,SET(DB(Muuds-In/${CALLERID(NUM)})=0)
exten => _1XXX,6,RemoveQueueMember(Muuds-In,SIP/${CALLERID(NUM)})
exten => _1XXX,7,RemoveQueueMember(Muudsur-In,SIP/${CALLERID(NUM)})
exten => _1XXX,8,Playback(agent-loggedoff)
exten => _1XXX,9,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _1XXX,10,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _1XXX,11,Goto(mehmood-logout,_1XXX,14)
exten => _1XXX,12,Playback(auth-incorrect)
exten => _1XXX,13,Goto(mehmood-logout,${EXTEN},2)
exten => _1XXX,14,Hangup()


[dial-muuds-queue]

;exten => 17,1,NoOp(${CALLERID(num)})
;exten => 17,n,Set(CURLOPT(conntimeout)=3)
;exten => 17,n,Set(CURLOPT(httptimeout)=3)
;exten => 17,n,Set(CURL_RESULT1=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate.php?caller_id=${CALLERID(num)})})
;exten => 17,n,Set(CURL_RESULT1=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/late_hours_ivr.php?caller_id=${CALLERID(num)})})

;exten => 17,n,GotoIfTime(09:00-17:30|wed|05|feb?salesoff,s,1)  ;kashmir day div
;exten => 17,n,Playback(ENGLISH/welcomeivr)
;exten => 17,n,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)
;exten => 17,n,NoOp(${CALLERID(num)})
;exten => 17,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-MUUD-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
;exten => 17,n,Monitor(wav,${MONITOR_FILENAME},m)
;exten => 17,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
;exten => 17,n,Set(_CALLER=${CALLERID(NUM)})
;exten => 17,n,Playback(PROBLEMIVRS/11)
;exten => 17,n,Dial(SIP/221,60,trT)
;exten => 17,n,Playback(ECP)

exten => 17,1,Answer
exten => 17,n,Queue(Muuds-In,tTc)
exten => 17,n,NoOp(${QUEUESTATUS})
exten => 17,n,NoOp(${ABANDONED})
exten => 17,n,Hangup

[dial-muuds-queue-urdu]
exten => 18,1,GotoIfTime(09:00-17:30|wed|05|feb?salesoff,s,1)  ;kashmir day div
exten => 18,n,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)
exten => 18,n,NoOp(${CALLERID(num)})
exten => 18,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-MUUD-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
exten => 18,n,Monitor(wav,${MONITOR_FILENAME},m)
exten => 18,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 18,n,Set(_CALLER=${CALLERID(NUM)})
exten => 18,n,Playback(PROBLEMIVRS/11)
;exten => 18,n,Dial(SIP/221,60,trT)
exten => 18,n,Playback(beep)
exten => 18,n,Queue(Muudsur-In,tT)
exten => 18,n,Hangup

[mehmoodtest]

exten=> s,1,Answer()
exten=> s,2,GotoIfTime(7:00-10:30|mon|12|aug?eidivr,s,1) ;Eid ul Adha Diversion 2019 by Ateeq/NGN
exten=> s,3,Wait(1)
exten=> s,4,Set(TIMEOUT(response)=3)
exten=> s,5,Background(newivr/welcome)
exten=> 1,1,Goto(dial-tac-queue,81,1)
exten=> 2,1,Goto(dial-sales-queue,82,1)
exten=> 3,1,Goto(dial-billing-queue,83,1)
;exten=> 3,1,Goto(dial-tac-queue,81,1)
exten=> 0,1,Goto(MBL-Operator-menu,s,1)
exten=> 11,1,Goto(MBL-TAC-menu,s,1)
exten=> 12,1,Goto(MBL-TAC-menu,s,1)
exten=> 111,1,Goto(MBL-TAC-menu,s,1)
exten=> 1111,1,Goto(MBL-TAC-menu,s,1)
exten=> 77,1,Goto(dial-NSS-queue,${EXTEN},1)
exten=> 17,1,Goto(dial-muuds-queue,${EXTEN},1)




[dial-NSS-queue]  ; added by MUUDS on 22 JAN 2020 as per NSS rekuairmantx
exten => 77,1,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)
exten => 77,n,NoOp(${CALLERID(num)})
;exten => 77,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-OPERATOR-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
;exten => 77,n,Monitor(wav,${MONITOR_FILENAME},m)
exten => 77,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 77,n,Set(_CALLER=${CALLERID(NUM)})
exten=> 77,n,Background(ENGLISH/nssshortivr)
exten => 77,n,Queue(NSS-Queue,tT)
exten => 77,n,Playback(beep)
;exten => 77,n,Queue(Operator-In,tT)
exten => 77,n,Hangup
 

[dial-mood-queue]
exten => 81,1,NoOp(${CALLERID(num)})
exten => 81,2,Set(CURLOPT(conntimeout)=3)
exten => 81,3,Set(CURLOPT(httptimeout)=3)

exten => 81,4,Set(CURL_RESULT3=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)})})


exten => 81,5,GotoIf($["${CURL_RESULT3}" != ""] ?6:80)


exten => 81,80,Set(CURL_RESULT3=0)
exten => 81,81,Goto(dial-tac-queue,81,6)



exten => 81,6,GotoIf(${CURL_RESULT3} = 1?90:7)

exten => 81,7,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)


exten => 81,8,Set(CURLOPT(conntimeout)=3)
exten => 81,9,Set(CURLOPT(httptimeout)=3)

exten => 81,10,Set(VALUE=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/validate_outage.php?caller_id=${CALLERID(num)})})
exten => 81,11,NoOp(${VALUE})
exten => 81,12,Hangup


;[dial-mood-queue]
exten => 81,1,NoOp(${CALLERID(num)})
exten => 81,2,Set(CURLOPT(conntimeout)=3)
exten => 81,3,Set(CURLOPT(httptimeout)=3)

exten => 81,4,Set(CURL_RESULT3=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)})})


exten => 81,5,GotoIf($["${CURL_RESULT3}" != ""] ?6:80)


exten => 81,80,Set(CURL_RESULT3=0)
exten => 81,81,Goto(dial-tac-queue,81,6)



exten => 81,6,GotoIf(${CURL_RESULT3} = 1?90:7)

exten => 81,7,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)


exten => 81,8,Set(CURLOPT(conntimeout)=3)
exten => 81,9,Set(CURLOPT(httptimeout)=3)

exten => 81,10,Set(CURL_RESULTO5=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/validate_outage.php?caller_id=${CALLERID(num)})})
exten => 81,n,NoOp(${CURL_RESULTO5})
exten => 81,11,GotoIf(${CURL_RESULTO5} = 1?900:12)

exten => 81,12,GotoIfTime(09:00-17:30|*|fri|sep?sehri,s,1)
exten => 81,13,GotoIfTime(19:00-19:30|*|01-23|may?ramzan,s,1)

exten => 81,14,Set(ivr=${DB(ivr/ntl)})
exten => 81,15,GotoIf($[${ivr}=0]?17:16)
exten => 81,16,Playback(problem-ivr/ntl/${ivr})
;exten => 81,12,Playback(engproblem/68)
exten => 81,17,Answer
exten => 81,18,Playback(ENGLISH/tac_queue_ivr)
exten => 81,19,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
exten => 81,20,Monitor(wav,${MONITOR_FILENAME},m)
exten => 81,21,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 81,22,Set(_CALLER=${CALLERID(NUM)})
exten => 81,23,set(_EXTEN=${EXTEN})
;exten => 81,20,Playback(engproblem/78)
exten => 81,24,Queue(TAC-IN,tTc,,,,,,macro-queuemacro) ;changed on 26NOv due to suspected issuei , previous was the line above
;;exten => 81,21,Queue(TAC-IN,tTr,,,,,,macro-queuemacro)
exten => 81,25,Goto(queuefeedbackk,81,1)
exten => 81,26,Hangup

;exten=> 81,90,Background(newivr/tacautobonus) ; tac autobonus ivr
exten=> 81,90,Background(ENGLISH/tacautobonus)

exten => 1,1,Goto(dial-tac-queue,81,100)
exten => 12,1,Goto(dial-tac-queue,81,100)
exten => 11,1,Goto(dial-tac-queue,81,100)
exten => 111,1,Goto(dial-tac-queue,81,100)
exten => 1111,1,Goto(dial-tac-queue,81,100)


exten => 1,1,Goto(dial-tac-queue,81,100)
exten => 12,1,Goto(dial-tac-queue,81,100)
exten => 11,1,Goto(dial-tac-queue,81,100)
exten => 111,1,Goto(dial-tac-queue,81,100)
exten => 1111,1,Goto(dial-tac-queue,81,100)

exten=> 2,1,Goto(dial-billing-queue,83,1)
exten=> 21,1,Goto(dial-billing-queue,83,1)
exten=> 22,1,Goto(dial-billing-queue,83,1)
exten=> 222,1,Goto(dial-billing-queue,83,1)
exten=> 2222,1,Goto(dial-billing-queue,83,1)


exten=> 3,1,Goto(dial-tac-queue,81,7)
exten=> 31,1,Goto(dial-tac-queue,81,7)
exten=> 33,1,Goto(dial-tac-queue,81,7)
exten=> 333,1,Goto(dial-tac-queue,81,7)
exten=> 3333,1,Goto(dial-tac-queue,81,7)


exten => X.,1,Goto(dial-tac-queue,81,7)


exten => 81,100,NoOp(${CALLERID(num)})
exten => 81,101,Set(CURLOPT(conntimeout)=3)
exten => 81,102,Set(CURLOPT(httptimeout)=3)
exten => 81,103,Set(CURL_RESULT4=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)}&avail=true&queue=10)})


exten => 81,104,GotoIf($["${CURL_RESULT4}" != ""] ?105:600)


exten => 81,600,Set(CURL_RESULT4=0)
exten => 81,601,Goto(dial-tac-queue,81,105)


exten => 81,105,GotoIf(${CURL_RESULT4} = 1 ?400:500)


;exten => 81,400,Playback(autobonussuccessfinalivr) ; autobonus success IVR updated by AB on 26/12/19
exten => 81,400,Playback(ENGLISH/autobonussuccessfinalivr)
exten => 81,401,Hangup

;exten => 81,500,Playback(autobonusfailed) ; autobonus failed IVR
exten => 81,500,Playback(ENGLISH/autobonusfailed)   ;this ivr is missing btw
exten => 81,501,Hangup

exten => 81,900,Playback(engproblem/21)   ;this ivr is missing btw
exten => 81,901,Hangup



;[dial-tac-queue]    in case of issue, use this dial plan. 
exten => 81,1,Answer
exten => 81,n,Playback(ENGLISH/tac_queue_ivr)
exten => 81,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
exten => 81,n,Monitor(wav,${MONITOR_FILENAME},m)
exten => 81,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 81,n,Set(_CALLER=${CALLERID(NUM)})
exten => 81,n,set(_EXTEN=${EXTEN})
;exten => 81,n,Playback(Social)
exten => 81,n,Queue(TAC-IN,tTc,,,,,,macro-queuemacro) ;changed on 26NOv due to suspected issuei , previous was the line above
;;exten => 81,21,Queue(TAC-IN,tTr,,,,,,macro-queuemacro)
exten => 81,n,Goto(queuefeedbackk,81,1)
exten => 81,n,Hangup

;[dial-tac-queue]   ;02-04-2022 Without Ramzan Auto

exten => 81,1,NoOp(${CALLERID(num)})
exten => 81,2,Set(CURLOPT(conntimeout)=3)
exten => 81,3,Set(CURLOPT(httptimeout)=3)

exten => 81,4,Set(CURL_RESULT3=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)})})


exten => 81,5,GotoIf($["${CURL_RESULT3}" != ""] ?6:80)


exten => 81,80,Set(CURL_RESULT3=0)
exten => 81,81,Goto(dial-tac-queue,81,6)



exten => 81,6,GotoIf(${CURL_RESULT3} = 1?90:7)

exten => 81,7,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)


exten => 81,8,Set(CURLOPT(conntimeout)=3)
exten => 81,9,Set(CURLOPT(httptimeout)=3)

exten => 81,10,Set(CURL_RESULTO5=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/validate_outage.php?caller_id=${CALLERID(num)})})
exten => 81,11,GotoIf($["${CURL_RESULTO5}" != ""] ?12:110)
exten => 81,110,Set(CURL_RESULTO5=0)
exten => 81,111,Goto(dial-tac-queue,81,12)
exten => 81,12,GotoIf(${CURL_RESULTO5} = 1?900:13)

exten => 81,13,GotoIfTime(03:55-04:10|*|18-21|apr?sehri,s,1)
exten => 81,14,GotoIfTime(18:40-19:10|*|18-21|apr?ramzan,s,1)

exten => 81,15,Set(ivr=${DB(ivr/ntl)})
;exten => 81,16,GotoIf($[${ivr}=0]?17:16)
exten => 81,16,GotoIf($[${ivr}=0]?18:17)
exten => 81,17,Playback(problem-ivr/ntl/${ivr})
;exten => 81,17,Playback(problem-ivr/ntl/16)
exten => 81,18,Answer
;exten => 81,19,Playback(ENGLISH/tac_queue_ivr)
exten => 81,19,Playback(EngUrdu/tac_queue_ivr)  ;Eng Urdu IVR by Zaeem
exten => 81,20,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
exten => 81,21,Monitor(wav,${MONITOR_FILENAME},m)
exten => 81,22,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 81,23,Set(_CALLER=${CALLERID(NUM)})
exten => 81,24,set(_EXTEN=${EXTEN})
;exten => 81,25,Playback(engproblem/69)
exten => 81,25,Queue(TAC-IN,tTc,,,,,,macro-queuemacro) ;changed on 26NOv due to suspected issuei , previous was the line above
;;exten => 81,21,Queue(TAC-IN,tTr,,,,,,macro-queuemacro)
exten => 81,26,Goto(queuefeedbackk,81,1)
exten => 81,27,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup

;exten=> 81,90,Background(newivr/tacautobonus) ; tac autobonus ivr
;exten=> 81,90,Background(ENGLISH/tacautobonus)
exten=> 81,90,Background(EngUrdu/tacautobonus) ;Eng Urdu IVR by Zaeem

exten => 1,1,Goto(dial-tac-queue,81,100)
exten => 12,1,Goto(dial-tac-queue,81,100)
exten => 11,1,Goto(dial-tac-queue,81,100)
exten => 111,1,Goto(dial-tac-queue,81,100)
exten => 1111,1,Goto(dial-tac-queue,81,100)


exten => 1,1,Goto(dial-tac-queue,81,100)
exten => 12,1,Goto(dial-tac-queue,81,100)
exten => 11,1,Goto(dial-tac-queue,81,100)
exten => 111,1,Goto(dial-tac-queue,81,100)
exten => 1111,1,Goto(dial-tac-queue,81,100)

exten=> 2,1,Goto(dial-billing-queue,83,1)
exten=> 21,1,Goto(dial-billing-queue,83,1)
exten=> 22,1,Goto(dial-billing-queue,83,1)
exten=> 222,1,Goto(dial-billing-queue,83,1)
exten=> 2222,1,Goto(dial-billing-queue,83,1)


exten=> 3,1,Goto(dial-tac-queue,81,7)
exten=> 31,1,Goto(dial-tac-queue,81,7)
exten=> 33,1,Goto(dial-tac-queue,81,7)
exten=> 333,1,Goto(dial-tac-queue,81,7)
exten=> 3333,1,Goto(dial-tac-queue,81,7)


exten => X.,1,Goto(dial-tac-queue,81,7)


exten => 81,100,NoOp(${CALLERID(num)})
exten => 81,101,Set(CURLOPT(conntimeout)=3)
exten => 81,102,Set(CURLOPT(httptimeout)=3)
exten => 81,103,Set(CURL_RESULT4=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)}&avail=true&queue=10)})


exten => 81,104,GotoIf($["${CURL_RESULT4}" != ""] ?105:600)


exten => 81,600,Set(CURL_RESULT4=0)
exten => 81,601,Goto(dial-tac-queue,81,105)


exten => 81,105,GotoIf(${CURL_RESULT4} = 1 ?400:500)


;exten => 81,400,Playback(autobonussuccessfinalivr) ; autobonus success IVR updated by AB on 26/12/19
;exten => 81,400,Playback(ENGLISH/autobonussuccessfinalivr)
;exten => 81,400,Playback(ENGLISH/autobonussuccess1) ;changed on req of Salman bhai 25/05/21
exten => 81,400,Playback(EngUrdu/autobonussuccess1)  ;Eng Urdu IVR by Zaeem
exten => 81,401,Hangup

;exten => 81,500,Playback(autobonusfailed) ; autobonus failed IVR
;exten => 81,500,Playback(ENGLISH/autobonusfailed)   ;this ivr is missing btw
exten => 81,500,Playback(EngUrdu/autobonusfailed) ;Eng Urdu IVR by Zaeem
exten => 81,501,Hangup

exten => 81,900,Playback(problem-ivr/ntl/OutageRecord)   ;this ivr is missing btw
exten => 81,901,Hangup

;[dial-tac-queue]     ;02-04-2022  With Ramzan Auto
exten => 81,1,NoOp(${CALLERID(num)})

exten => 81,2,Set(ivr1=${DB(ivr/ramzan)})
exten => 81,3,GotoIf($[${ivr1}=1]?4:5)
exten => 81,4,Goto(RamzanTac,1,1)

exten => 81,5,Set(CURLOPT(conntimeout)=3)
exten => 81,6,Set(CURLOPT(httptimeout)=3)

exten => 81,7,Set(CURL_RESULT3=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)})})

exten => 81,8,GotoIf($["${CURL_RESULT3}" != ""] ?9:80)

exten => 81,80,Set(CURL_RESULT3=0)
exten => 81,81,Goto(dial-tac-queue,81,9)

exten => 81,9,GotoIf(${CURL_RESULT3} = 1?90:10)

exten => 81,10,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)

exten => 81,11,Set(CURLOPT(conntimeout)=3)
exten => 81,12,Set(CURLOPT(httptimeout)=3)

exten => 81,13,Set(CURL_RESULTO5=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/validate_outage.php?caller_id=${CALLERID(num)})})
exten => 81,14,GotoIf($["${CURL_RESULTO5}" != ""] ?15:110)
exten => 81,110,Set(CURL_RESULTO5=0)
exten => 81,111,Goto(dial-tac-queue,81,15)
exten => 81,15,GotoIf(${CURL_RESULTO5} = 1?900:16)

;exten => 81,13,GotoIfTime(03:55-04:10|*|18-21|apr?sehri,s,1)
;exten => 81,14,GotoIfTime(18:40-19:10|*|18-21|apr?ramzan,s,1)

exten => 81,16,Set(ivr=${DB(ivr/ntl)})
exten => 81,17,GotoIf($[${ivr}=0]?19:18)
exten => 81,18,Playback(problem-ivr/ntl/${ivr})
exten => 81,19,Answer
;exten => 81,19,Playback(ENGLISH/tac_queue_ivr)
exten => 81,20,Playback(EngUrdu/tac_queue_ivr)  ;Eng Urdu IVR by Zaeem
exten => 81,21,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
exten => 81,22,Monitor(wav,${MONITOR_FILENAME},m)
exten => 81,23,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 81,24,Set(_CALLER=${CALLERID(NUM)})
exten => 81,25,set(_EXTEN=${EXTEN})
;exten => 81,26,Playback(engproblem/69)
exten => 81,26,Queue(TAC-IN,tTc,,,,,,macro-queuemacro) ;changed on 26NOv due to suspected issuei , previous was the line above
;;exten => 81,21,Queue(TAC-IN,tTr,,,,,,macro-queuemacro)
exten => 81,27,Goto(queuefeedbackk,81,1)
exten => 81,28,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup

;exten=> 81,90,Background(newivr/tacautobonus) ; tac autobonus ivr
;exten=> 81,90,Background(ENGLISH/tacautobonus)
exten=> 81,90,Background(EngUrdu/tacautobonus) ;Eng Urdu IVR by Zaeem

exten => 1,1,Goto(dial-tac-queue,81,100)
exten => 12,1,Goto(dial-tac-queue,81,100)
exten => 11,1,Goto(dial-tac-queue,81,100)
exten => 111,1,Goto(dial-tac-queue,81,100)
exten => 1111,1,Goto(dial-tac-queue,81,100)


exten => 1,1,Goto(dial-tac-queue,81,100)
exten => 12,1,Goto(dial-tac-queue,81,100)
exten => 11,1,Goto(dial-tac-queue,81,100)
exten => 111,1,Goto(dial-tac-queue,81,100)
exten => 1111,1,Goto(dial-tac-queue,81,100)

exten=> 2,1,Goto(dial-billing-queue,83,1)
exten=> 21,1,Goto(dial-billing-queue,83,1)
exten=> 22,1,Goto(dial-billing-queue,83,1)
exten=> 222,1,Goto(dial-billing-queue,83,1)
exten=> 2222,1,Goto(dial-billing-queue,83,1)


exten=> 3,1,Goto(dial-tac-queue,81,10)
exten=> 31,1,Goto(dial-tac-queue,81,10)
exten=> 33,1,Goto(dial-tac-queue,81,10)
exten=> 333,1,Goto(dial-tac-queue,81,10)
exten=> 3333,1,Goto(dial-tac-queue,81,10)


exten => X.,1,Goto(dial-tac-queue,81,10)


exten => 81,100,NoOp(${CALLERID(num)})
exten => 81,101,Set(CURLOPT(conntimeout)=3)
exten => 81,102,Set(CURLOPT(httptimeout)=3)
exten => 81,103,Set(CURL_RESULT4=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)}&avail=true&queue=10)})


exten => 81,104,GotoIf($["${CURL_RESULT4}" != ""] ?105:600)


exten => 81,600,Set(CURL_RESULT4=0)
exten => 81,601,Goto(dial-tac-queue,81,105)


exten => 81,105,GotoIf(${CURL_RESULT4} = 1 ?400:500)


;exten => 81,400,Playback(ENGLISH/autobonussuccess1) ;changed on req of Salman bhai 25/05/21
exten => 81,400,Playback(EngUrdu/autobonussuccess1)  ;Eng Urdu IVR by Zaeem
exten => 81,401,Hangup

;exten => 81,500,Playback(autobonusfailed) ; autobonus failed IVR
exten => 81,500,Playback(EngUrdu/autobonusfailed) ;Eng Urdu IVR by Zaeem
;exten => 81,500,Playback(ENGLISH/autobonusfailed)   ;this ivr is missing btw
exten => 81,501,Hangup

exten => 81,900,Playback(problem-ivr/ntl/OutageRecord)   ;this ivr is missing btw
exten => 81,901,Hangup


[dial-tac-queue]   ;Multi IVR setup  Implemented by Talal/NGN on 29/05/2022

exten => 81,1,NoOp(${CALLERID(num)})

;;;;;;;;;;;;;;;;;;;; Ramzan Timing ;;;;;;;;;;;;;;;;;;;
exten => 81,2,Set(ivr1=${DB(ivr/ramzan)})
exten => 81,3,GotoIf($[${ivr1}=1]?4:5)
exten => 81,4,Goto(RamzanTac,1,1)


exten => 81,5,Set(CURLOPT(conntimeout)=4)
exten => 81,6,Set(CURLOPT(httptimeout)=4)

;Ye master API hogi jo ke repsonse de ki ke ya krna ha. Incase timeout hota ha to ham call TAC mein land kara dein ge
;exten => 81,7,Set(CURL_RESULT_Main=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id==${CALLERID(num)}&new_call=1)})

;-----New-API-----
exten => 81,7,Set(CURL_RESULT_Main=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id==${CALLERID(num)}&new_call=1)})


exten => 81,8,GotoIf($["${CURL_RESULT_Main}"!=""] ?10:9)

exten => 81,9,Set(CURL_RESULT_Main=5)	 ; Is line mein wo value daal dein ge jo ke timeout ke lye ho gi
exten => 81,10,Goto(dial-tac-queue,81,11)

exten => 81,11,GotoIf($["${CURL_RESULT_Main}"="5"]?217:12)   				; Normal Call Landing in TAC
exten => 81,12,GotoIf($["${CURL_RESULT_Main}"="0"]?autobonus,81,90:13) 			; Auto Bonus
exten => 81,13,GotoIf($["${CURL_RESULT_Main}"="1"]?outage,s,1:14) 			; Outage IVR
exten => 81,14,GotoIf($["${CURL_RESULT_Main}"="2"]?maintenance,s,800:15) 		; Maintenance Activity
exten => 81,15,GotoIf($["${CURL_RESULT_Main}"="3"]?ont_red,s,700:16) 			; Fiber Break
exten => 81,16,GotoIf($["${CURL_RESULT_Main}"="4"]?ont_off,s,750:17) 			; ONT Off
exten => 81,17,GotoIf($["${CURL_RESULT_Main}"="6"]?dial-billing-queue,83,13:18)		; Auto Bonus not elligible
exten => 81,18,GotoIf($["${CURL_RESULT_Main}"="10"]?TT_Launched_red,s,1:19)             ; ONT Off with TT already launched 
exten => 81,19,GotoIf($["${CURL_RESULT_Main}"="11"]?TT_Launched_off,s,1:217)            ; ONT Red with TT already launched



exten => 81,217,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)        ;;;;;;;;;;; Iske baad normal TAC dialling honi ha (Queue mein call jaye gi)
;exten => 81,218,GotoIfTime(03:55-04:10|*|18-21|apr?sehri,s,1)
;exten => 81,219,GotoIfTime(18:40-19:10|*|18-21|apr?ramzan,s,1)
exten => 81,218,Set(ivr=${DB(ivr/ntl)})
exten => 81,219,GotoIf($[${ivr}=0]?221:220)
exten => 81,220,Playback(problem-ivr/ntl/${ivr})


exten => 81,221,Set(CURLOPT(conntimeout)=2)
exten => 81,222,Set(CURLOPT(httptimeout)=1)

exten => 81,223,background(EngUrdu/Req_Comp_IVR)  ;opt for req or comp
;exten => 1,1,Set(CURL_REQ=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id==${CALLERID(num)}&queue=13)})
;------NEW-API-----
exten => 1,1,Set(CURL_REQ=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id==${CALLERID(num)}&queue=13)})

exten => 1,2,Goto(dial-tac-queue,81,225)

;exten => 11,1,Set(CURL_REQ=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id==${CALLERID(num)}&queue=13)})

;-----NEW-API------
exten => 11,1,Set(CURL_REQ=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id==${CALLERID(num)}&queue=13)})

exten => 11,2,Goto(dial-tac-queue,81,225)

;exten => 2,1,Set(CURL_REQ=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id==${CALLERID(num)}&queue=12)})

;----NEW-API------
exten => 2,1,Set(CURL_REQ=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id==${CALLERID(num)}&queue=12)})


exten => 2,2,Goto(dial-tac-queue,81,225)

;exten => 22,1,Set(CURL_REQ=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id==${CALLERID(num)}&queue=12)})

;----NEW-API----
exten => 22,1,Set(CURL_REQ=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id==${CALLERID(num)}&queue=12)})

exten => 22,2,Goto(dial-tac-queue,81,225)

exten => i,1,Goto(dial-tac-queue,81,223)
exten => t,1,Goto(dial-tac-queue,81,223)




;exten => 81,221,Answer
exten => 81,225,Playback(EngUrdu/tac_queue_ivr)  ;Eng Urdu IVR by Zaeem
exten => 81,226,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
exten => 81,227,Monitor(wav,${MONITOR_FILENAME},m)
exten => 81,228,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 81,229,Set(_CALLER=${CALLERID(NUM)})
exten => 81,230,set(_EXTEN=${EXTEN})
exten => 81,231,Queue(TAC-IN,tTc,,,,,,macro-queuemacro) ;changed on 26NOv due to suspected issuei , previous was the line above
exten => 81,232,Goto(queuefeedbackk,81,1)
exten => 81,233,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup



[autobonus]
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;; Section for Auto Bonus ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

exten => 81,90,Background(EngUrdu/availautobonus)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;; Press 1 for availing Auto bonus ;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

exten => 1,1,Goto(autobonus,81,100)
exten => 12,1,Goto(autobonus,81,100)
exten => 11,1,Goto(autobonus,81,100)
exten => 111,1,Goto(autobonus,81,100)
exten => 1111,1,Goto(autobonus,81,100)

exten => 81,100,NoOp(${CALLERID(num)})
exten => 81,101,Set(CURLOPT(conntimeout)=3)
exten => 81,102,Set(CURLOPT(httptimeout)=3)
;exten => 81,103,Set(CURL_RESULT_AvailBonus=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id=${CALLERID(num)}&avail=true)})

;-----NEW-API-------
exten => 81,103,Set(CURL_RESULT_AvailBonus=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id=${CALLERID(num)}&avail=true)})


exten => 81,104,GotoIf($["${CURL_RESULT_AvailBonus}"!=""] ?107:105)

;In case timeout occurs
exten => 81,105,Set(CURL_RESULT_AvailBonus=0)
exten => 81,106,Goto(autobonus,81,107)

exten => 81,107,GotoIf($["${CURL_RESULT_AvailBonus}"="1"]?108:110)
exten => 81,108,Playback(EngUrdu/autobonussuccess1)  ;Eng Urdu IVR by Zaeem
exten => 81,109,Hangup

exten => 81,110,Playback(EngUrdu/autobonusfailed) ;Eng Urdu IVR by Zaeem
exten => 81,111,Hangup


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;; Press 2 for dialling Billing ;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

exten => 2,1,Set(CURLOPT(conntimeout)=1)
exten => 2,2,Set(CURLOPT(httptimeout)=1)
;exten => 2,3,Set(call_status=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id==${CALLERID(num)}&bonus_tac=1)})

;----NEW-API------
exten => 2,3,Set(call_status=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id==${CALLERID(num)}&bonus_tac=1)})


exten => 2,4,Goto(dial-billing-queue,83,1)

; Dial Billing queue for any other response
exten => i,1,Goto(dial-billing-queue,83,1)


[maintenance]

exten => s,800,Background(EngUrdu/maintenance_act)   

;In case customer presses one Dial TAC Queue with all the checks (Time based + IVR activated by NOC)
exten=> 1,1,Set(CURLOPT(conntimeout)=3)
exten=> 1,2,Set(CURLOPT(httptimeout)=3)
;exten=> 1,3,Set(call_status=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id==${CALLERID(num)}&call_status=16)})


;----NEW-API-----
exten=> 1,3,Set(call_status=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id==${CALLERID(num)}&call_status=16)})

exten=> 1,4,Goto(dial-tac-queue,81,217)

;In case of anyother Input the call needs to be disconnected and nothing pressed call disconnect

exten=> t,1,Hangup()
exten=> i,1,Hangup()


[ont_red]
exten => s,700,Background(EngUrdu/ont_red)   ;IVR for Fiber break

;In case customer presses two  Dial TAC Queue with all the checks (Time based + IVR activated by NOC)

exten=> 1,1,Goto(ont_red,s,702)
exten=> 11,1,Goto(ont_red,s,702)
exten=> 12,1,Goto(ont_red,s,702)
exten=> 111,1,Goto(ont_red,s,702)
exten=> 1111,1,Goto(ont_red,s,702)

exten => s,702,NoOp(${CALLERID(num)})
exten => s,703,Set(CURLOPT(conntimeout)=3)
exten => s,704,Set(CURLOPT(httptimeout)=3)
;exten => s,705,Set(CURL_RESULT_break=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id=${CALLERID(num)}&generate_tt=3)})

;-----NEW-API----
exten => s,705,Set(CURL_RESULT_break=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id=${CALLERID(num)}&generate_tt=3)})



exten => s,706,Playback(EngUrdu/TT_Launched)  ; IVR that TT is launched
exten => s,707,Hangup()

;In case customer presses 2

exten=> 2,1,Set(CURLOPT(conntimeout)=3)
exten=> 2,2,Set(CURLOPT(httptimeout)=3)
;exten=> 2,3,Set(call_status=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id==${CALLERID(num)}&call_status=14)})

;----NEW-API-----
exten=> 2,3,Set(call_status=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id==${CALLERID(num)}&call_status=14)})


exten=> 2,4,Goto(dial-tac-queue,81,217)


exten=> t,1,Goto(ont_red,s,700)
exten=> i,1,Goto(ont_red,s,700)


[ont_off]

exten => s,750,Background(EngUrdu/ont_off_updated)   
exten => 83,14,GotoIfTime(09:00-20:00|*|28-30|june?salesoff,s,1)                 ;EID ADHA 2023 by AJ

;In case customer presses two Dial TAC Queue with all the checks (Time based + IVR activated by NOC)

exten=> 1,1,Goto(ont_off,s,752)
exten=> 11,1,Goto(ont_off,s,752)
exten=> 12,1,Goto(ont_off,s,752)
exten=> 111,1,Goto(ont_off,s,752)
exten=> 1111,1,Goto(ont_off,s,752)

exten => s,752,NoOp(${CALLERID(num)})
exten => s,753,Set(CURLOPT(conntimeout)=3)
exten => s,754,Set(CURLOPT(httptimeout)=3)
;exten => s,755,Set(CURL_RESULT_OFF=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id=${CALLERID(num)}&generate_tt=4)})

;----NEW-API-----
exten => s,755,Set(CURL_RESULT_OFF=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id=${CALLERID(num)}&generate_tt=4)})

exten => s,756,Playback(EngUrdu/TT_Launched)  ; IVR that TT is launched
exten => s,757,Hangup()


exten=> 2,1,Set(CURLOPT(conntimeout)=3)
exten=> 2,2,Set(CURLOPT(httptimeout)=3)
;exten=> 2,3,Set(call_status=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id==${CALLERID(num)}&call_status=15)})

;----NEW-API------
exten=> 2,3,Set(call_status=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id==${CALLERID(num)}&call_status=15)})


exten=> 2,4,Goto(dial-tac-queue,81,217)

; In case of invalid response, repeat the process
exten=> t,1,Goto(ont_off,s,750)
exten=> i,1,Goto(ont_off,s,750)



[outage]

exten => s,1,Playback(problem-ivr/ntl/OutageRecord)   ;Outage IVR to be provided.
exten => s,n,Hangup


[TT_Launched_red]
exten => s,1,Background(EngUrdu/TT_ont_red)

exten => 1,1,Set(CURLOPT(conntimeout)=3)
exten => 1,2,Set(CURLOPT(httptimeout)=3)
;exten => 1,3,Set(call_status=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id==${CALLERID(num)}&call_status=17)})

;-----NEW-API------
exten => 1,3,Set(call_status=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id==${CALLERID(num)}&call_status=17)})



exten => 1,4,Goto(dial-tac-queue,81,217)
exten => 1,5,Hangup()

exten=> t,1,Goto(s,1)
exten=> i,1,Goto(s,1)

[TT_Launched_off]
exten => s,1,Background(EngUrdu/TT_ont_off)

exten => 1,1,Set(CURLOPT(conntimeout)=3)
exten => 1,2,Set(CURLOPT(httptimeout)=3)
;exten => 1,3,Set(call_status=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id==${CALLERID(num)}&call_status=18)})

;----NEW-API----
exten => 1,3,Set(call_status=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id==${CALLERID(num)}&call_status=18)})


exten => 1,4,Goto(dial-tac-queue,81,217)
exten => 1,5,Hangup()

exten=> t,1,Goto(s,1)
exten=> i,1,Goto(s,1)


[RamzanTac]
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;; Sehri Timings 2022 ;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;exten => 1,1,GotoIfTime(12:03-12:50|*|02|apr?sehri,s,1)
exten => 1,1,GotoIfTime(04:30-04:45|*|23-26|mar?sehri,s,1)
exten => 1,2,GotoIfTime(04:25-04:40|*|27-29|mar?sehri,s,1)
exten => 1,3,GotoIfTime(04:20-04:35|*|30-31|mar?sehri,s,1)
exten => 1,4,GotoIfTime(04:20-04:35|*|01-02|mar?sehri,s,1)
exten => 1,5,GotoIfTime(04:15-04:30|*|03-05|apr?sehri,s,1)
exten => 1,6,GotoIfTime(04:10-04:25|*|06-08|apr?sehri,s,1)
exten => 1,7,GotoIfTime(04:05-04:20|*|09-12|apr?sehri,s,1)
exten => 1,8,GotoIfTime(04:00-04:15|*|13-15|apr?sehri,s,1)
exten => 1,9,GotoIfTime(03:55-04:10|*|16-18|apr?sehri,s,1)
exten => 1,10,GotoIfTime(03:50-04:00|*|19-21|apr?sehri,s,1)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;***Aftaar Timings 2022***;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

exten => 1,11,GotoIfTime(18:23-18:53|*|23-24|mar?ramzan,s,1)
exten => 1,12,GotoIfTime(18:25-18:55|*|25-31|mar?ramzan,s,1)
exten => 1,13,GotoIfTime(18:30-19:00|*|01-06|apr?ramzan,s,1)
exten => 1,14,GotoIfTime(18:35-19:05|*|07-13|apr?ramzan,s,1)
exten => 1,15,GotoIfTime(18:40-19:10|*|14-19|apr?ramzan,s,1)
exten => 1,16,GotoIfTime(18:45-19:15|*|20-21|apr?ramzan,s,1)


exten => 1,17,Goto(dial-tac-queue,81,5)
exten => 1,18,Hangup




;[dial-tac-queue]   ;API working fine 19th april

exten => 81,1,NoOp(${CALLERID(num)})
exten => 81,2,Set(CURLOPT(conntimeout)=3)
exten => 81,3,Set(CURLOPT(httptimeout)=3)

exten => 81,4,Set(CURL_RESULT3=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)})})


exten => 81,5,GotoIf($["${CURL_RESULT3}" != ""] ?6:80)


exten => 81,80,Set(CURL_RESULT3=0)
exten => 81,81,Goto(dial-tac-queue,81,6)



exten => 81,6,GotoIf(${CURL_RESULT3} = 1?90:7)

exten => 81,7,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)


exten => 81,8,Set(CURLOPT(conntimeout)=3)
exten => 81,9,Set(CURLOPT(httptimeout)=3)

exten => 81,10,Set(CURL_RESULTO5=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/validate_outage.php?caller_id=${CALLERID(num)})})
exten => 81,11,GotoIf($["${CURL_RESULTO5}" != ""] ?12:110)
exten => 81,110,Set(CURL_RESULTO5=0)
exten => 81,111,Goto(dial-tac-queue,81,12)
exten => 81,12,GotoIf(${CURL_RESULTO5} = 1?900:13)

exten => 81,13,GotoIfTime(09:00-17:30|*|fri|sep?sehri,s,1)
exten => 81,14,GotoIfTime(19:00-19:30|*|01-23|may?ramzan,s,1)

exten => 81,15,Set(ivr=${DB(ivr/ntl)})
;exten => 81,16,GotoIf($[${ivr}=0]?17:16)
exten => 81,16,GotoIf($[${ivr}=0]?18:17)
exten => 81,17,Playback(problem-ivr/ntl/${ivr})
exten => 81,18,Answer
exten => 81,19,Playback(ENGLISH/tac_queue_ivr)
exten => 81,20,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
exten => 81,21,Monitor(wav,${MONITOR_FILENAME},m)
exten => 81,22,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 81,23,Set(_CALLER=${CALLERID(NUM)})
exten => 81,24,set(_EXTEN=${EXTEN})
;exten => 81,20,Playback(engproblem/78)
;exten => 81,25,Playback(problem-ivr/ntl/70)
exten => 81,25,Queue(TAC-IN,tTc,,,,,,macro-queuemacro) ;changed on 26NOv due to suspected issuei , previous was the line above
;;exten => 81,21,Queue(TAC-IN,tTr,,,,,,macro-queuemacro)
exten => 81,26,Goto(queuefeedbackk,81,1)
exten => 81,27,Hangup

;exten=> 81,90,Background(newivr/tacautobonus) ; tac autobonus ivr
exten=> 81,90,Background(ENGLISH/tacautobonus)

exten => 1,1,Goto(dial-tac-queue,81,100)
exten => 12,1,Goto(dial-tac-queue,81,100)
exten => 11,1,Goto(dial-tac-queue,81,100)
exten => 111,1,Goto(dial-tac-queue,81,100)
exten => 1111,1,Goto(dial-tac-queue,81,100)


exten => 1,1,Goto(dial-tac-queue,81,100)
exten => 12,1,Goto(dial-tac-queue,81,100)
exten => 11,1,Goto(dial-tac-queue,81,100)
exten => 111,1,Goto(dial-tac-queue,81,100)
exten => 1111,1,Goto(dial-tac-queue,81,100)

exten=> 2,1,Goto(dial-billing-queue,83,1)
exten=> 21,1,Goto(dial-billing-queue,83,1)
exten=> 22,1,Goto(dial-billing-queue,83,1)
exten=> 222,1,Goto(dial-billing-queue,83,1)
exten=> 2222,1,Goto(dial-billing-queue,83,1)


exten=> 3,1,Goto(dial-tac-queue,81,7)
exten=> 31,1,Goto(dial-tac-queue,81,7)
exten=> 33,1,Goto(dial-tac-queue,81,7)
exten=> 333,1,Goto(dial-tac-queue,81,7)
exten=> 3333,1,Goto(dial-tac-queue,81,7)


exten => X.,1,Goto(dial-tac-queue,81,7)


exten => 81,100,NoOp(${CALLERID(num)})
exten => 81,101,Set(CURLOPT(conntimeout)=3)
exten => 81,102,Set(CURLOPT(httptimeout)=3)
exten => 81,103,Set(CURL_RESULT4=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)}&avail=true&queue=10)})


exten => 81,104,GotoIf($["${CURL_RESULT4}" != ""] ?105:600)


exten => 81,600,Set(CURL_RESULT4=0)
exten => 81,601,Goto(dial-tac-queue,81,105)


exten => 81,105,GotoIf(${CURL_RESULT4} = 1 ?400:500)


;exten => 81,400,Playback(autobonussuccessfinalivr) ; autobonus success IVR updated by AB on 26/12/19
exten => 81,400,Playback(ENGLISH/autobonussuccessfinalivr)
exten => 81,401,Hangup

;exten => 81,500,Playback(autobonusfailed) ; autobonus failed IVR
exten => 81,500,Playback(ENGLISH/autobonusfailed)   ;this ivr is missing btw
exten => 81,501,Hangup

exten => 81,900,Playback(problem-ivr/ntl/OutageRecord)   ;this ivr is missing btw
exten => 81,901,Hangup


;[dial-tac-queue]

exten => 81,1,NoOp(${CALLERID(num)})
exten => 81,2,Set(CURLOPT(conntimeout)=3)
exten => 81,3,Set(CURLOPT(httptimeout)=3)

exten => 81,4,Set(CURL_RESULT3=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)})})


exten => 81,5,GotoIf($["${CURL_RESULT3}" != ""] ?6:80)


exten => 81,80,Set(CURL_RESULT3=0)
exten => 81,81,Goto(dial-tac-queue,81,6)



exten => 81,6,GotoIf(${CURL_RESULT3} = 1?90:7)

exten => 81,7,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)

exten => 81,8,GotoIfTime(03:15-03:30|*|01-23|may?sehri,s,1)	
exten => 81,9,GotoIfTime(19:00-19:30|*|01-23|may?ramzan,s,1)   
;exten => 81,9,Playback(16) for emergency case
exten => 81,10,Set(ivr=${DB(ivr/ntl)})
exten => 81,11,GotoIf($[${ivr}=0]?13:12)
exten => 81,12,Playback(problem-ivr/ntl/${ivr})
;exten => 81,12,Playback(engproblem/${ivr})
exten => 81,13,Answer
;exten => 81,14,Playback(newivr/tac_queue_ivr)
exten => 81,14,Playback(ENGLISH/tac_queue_ivr)
exten => 81,15,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
exten => 81,16,Monitor(wav,${MONITOR_FILENAME},m)
exten => 81,17,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 81,18,Set(_CALLER=${CALLERID(NUM)})
exten => 81,19,set(_EXTEN=${EXTEN})
exten => 81,20,Queue(TAC-IN,tTc,,,,,,macro-queuemacro) ;changed on 26NOv due to suspected issuei , previous was the line above
;;exten => 81,20,Queue(TAC-IN,tTr,,,,,,macro-queuemacro)
exten => 81,21,Goto(queuefeedbackk,81,1)
exten => 81,22,Hangup

;exten=> 81,90,Background(newivr/tacautobonus) ; tac autobonus ivr
exten=> 81,90,Background(ENGLISH/tacautobonus)

exten => 1,1,Goto(dial-tac-queue,81,100)
exten => 12,1,Goto(dial-tac-queue,81,100)
exten => 11,1,Goto(dial-tac-queue,81,100)
exten => 111,1,Goto(dial-tac-queue,81,100)
exten => 1111,1,Goto(dial-tac-queue,81,100)


exten => 1,1,Goto(dial-tac-queue,81,100)
exten => 12,1,Goto(dial-tac-queue,81,100)
exten => 11,1,Goto(dial-tac-queue,81,100)
exten => 111,1,Goto(dial-tac-queue,81,100)
exten => 1111,1,Goto(dial-tac-queue,81,100)

exten=> 2,1,Goto(dial-billing-queue,83,1)
exten=> 21,1,Goto(dial-billing-queue,83,1)
exten=> 22,1,Goto(dial-billing-queue,83,1)
exten=> 222,1,Goto(dial-billing-queue,83,1)
exten=> 2222,1,Goto(dial-billing-queue,83,1)


exten=> 3,1,Goto(dial-tac-queue,81,7)
exten=> 31,1,Goto(dial-tac-queue,81,7)
exten=> 33,1,Goto(dial-tac-queue,81,7)
exten=> 333,1,Goto(dial-tac-queue,81,7)
exten=> 3333,1,Goto(dial-tac-queue,81,7)


exten => X.,1,Goto(dial-tac-queue,81,7)


exten => 81,100,NoOp(${CALLERID(num)})
exten => 81,101,Set(CURLOPT(conntimeout)=3)
exten => 81,102,Set(CURLOPT(httptimeout)=3)
exten => 81,103,Set(CURL_RESULT4=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)}&avail=true&queue=10)})


exten => 81,104,GotoIf($["${CURL_RESULT4}" != ""] ?105:600)


exten => 81,600,Set(CURL_RESULT4=0)
exten => 81,601,Goto(dial-tac-queue,81,105)


exten => 81,105,GotoIf(${CURL_RESULT4} = 1 ?400:500)


;exten => 81,400,Playback(autobonussuccessfinalivr) ; autobonus success IVR updated by AB on 26/12/19
exten => 81,400,Playback(ENGLISH/autobonussuccessfinalivr)
exten => 81,401,Hangup

;exten => 81,500,Playback(autobonusfailed) ; autobonus failed IVR
exten => 81,500,Playback(ENGLISH/autobonusfailed)   ;this ivr is missing btw
exten => 81,501,Hangup



;[dial-tac-queue]
;exten => 81,1,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)
;exten => 81,2,Set(ivr=${DB(ivr/ntl)})

;exten => 81,3,GotoIf($[${ivr}=0]?5:4) 
 
;exten => 81,4,Playback(problem-ivr/ntl/${ivr})
;exten => 81,5,Answer
;exten => 81,6,Playback(newivr/tac_queue_ivr)
;;exten => 81,7,Set(MONITOR_FILENAME=TAC-IN-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}})
;exten => 81,7,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
;exten => 81,8,Monitor(wav,${MONITOR_FILENAME},m)
;exten => 81,9,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
;exten => 81,10,Set(_CALLER=${CALLERID(NUM)})
;exten => 81,11,set(_EXTEN=${EXTEN})
;;exten => 81,11,Queue(TAC-IN,tT,,,120)
;;exten => 81,11,Queue(TAC-IN,tTc,,,,,,queuemacro)
;exten => 81,12,Queue(TAC-IN,tTc,,,,,,macro-queuemacro) ;changed on 26NOv due to suspected issuei , previous was the line above 
;;exten => 81,12,Goto(queuefeedbackk,s,1)
;exten => 81,13,Goto(queuefeedbackk,81,1)
;exten => 81,14,Hangup

;exten => 81,1,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)
;exten => 81,2,Set(ivr=${DB(ivr/ntl)})
;exten => 81,3,Set(ivr2=${DB(ivr2/ntl)})
;exten => 81,4,GotoIf($[${ivr2}=0]?5:20)
;exten => 81,5,GotoIf($[${ivr}=0]?7:6)
;exten => 81,6,Playback(problem-ivr/ntl/${ivr})
;exten => 81,7,Answer
;exten => 81,6,Playback(newivr/tac_queue_ivr)
;;exten => 81,7,Set(MONITOR_FILENAME=TAC-IN-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}})
;exten => 81,7,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
;exten => 81,8,Monitor(wav,${MONITOR_FILENAME},m)
;exten => 81,9,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
;exten => 81,10,Set(_CALLER=${CALLERID(NUM)})
;exten => 81,11,Queue(TAC-IN,tT,,,120)
;exten => 81,12,Goto(recordnumber,s,1)
;exten => 81,13,Hangup


;exten => 81,20,Answer
;exten => 81,21,Playback(newivr/tac_queue_ivr)
;exten => 81,22,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
;exten => 81,23,Monitor(wav,${MONITOR_FILENAME},m)
;exten => 81,24,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
;exten => 81,25,Set(_CALLER=${CALLERID(NUM)})
;exten => 81,26,Set(QUEUE_PRIO=100)
;exten => 81,27,Queue(TAC-IN,tT,,,120)
;exten => 81,28,Goto(recordnumber,s,1)
;exten => 81,29,Hangup


[macro-queuemacro]
exten => s,1,NoOp(*** MACRO : Queue Macro : ${MEMBERNAME} -- ${MEMBERINTERFACE} --  ***)




;FOR FSD QUEUE;;;;;;;;;;;;;;;;;;;;;;;;;;;

;exten => 91,1,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)
;exten => 91,2,Set(ivr=${DB(ivr/ntl)})
;exten => 91,3,Set(ivr2=${DB(ivr2/ntl)})
;exten => 91,4,GotoIf($[${ivr2}=0]?5:20)
;exten => 91,5,GotoIf($[${ivr}=0]?7:6)
;exten => 91,6,Set(QUEUE_PRIO=100)
;exten => 91,7,Answer
;exten => 91,8,Playback(newivr/tac_queue_ivr)
;;exten => 81,7,Set(MONITOR_FILENAME=TAC-IN-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}})
;exten => 91,9,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
;exten => 91,10,Monitor(wav,${MONITOR_FILENAME},m)
;exten => 91,11,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
;exten => 91,12,Set(_CALLER=${CALLERID(NUM)})
;exten => 91,13,Queue(TAC-IN,tT,,,120)
;exten => 91,14,Goto(recordnumber,s,1)
;exten => 91,15,Hangup


;exten => 91,20,Playback(problem-ivr/ntl/${ivr})
;exten => 91,21,Answer
;exten => 91,22,Playback(newivr/tac_queue_ivr)
;exten => 91,23,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN}) ;changed by saqlain for format
;exten => 91,24,Monitor(wav,${MONITOR_FILENAME},m)
;exten => 91,25,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
;exten => 91,26,Set(_CALLER=${CALLERID(NUM)})
;exten => 91,27,Queue(TAC-IN,tT,,,120)
;exten => 91,28,Goto(recordnumber,s,1)
;exten => 91,29,Hangup

;----------------Priority 8 to 11 for Q Feedback and callback option setup------------------------------
;exten => 81,8,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
;exten => 81,9,Set(_CALLER=${CALLERID(NUM)})
;exten => 81,10,Queue(TAC-IN,tTF(queuefeedback,s,1),,,180)
;exten => 81,11,Goto(recordnumber,s,1) 
;-------------------------------------------------------------------------------------------------------


[feedback-test]
exten => 81,1,GotoIfTime(13:00-14:00,fri,*,*?jumma,s,1)
exten => 81,2,Set(ivr=${DB(ivr/ntl)})
exten => 81,3,GotoIf($[${ivr}=0]?5:4)
exten => 81,4,Playback(problem-ivr/ntl/${ivr})
exten => 81,5,Answer
exten => 81,6,Playback(newivr/tac_queue_ivr)
;exten => 81,7,Set(MONITOR_FILENAME=TAC-IN-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}})
exten => 81,7,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN})
;exten => 81,8,Monitor(wav,${MONITOR_FILENAME},m)
;exten => 81,9,Queue(TAC-IN,tT)
exten => 81,8,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 81,9,Set(_CALLER=${CALLERID(NUM)})
;exten => 81,10,Queue(TAC-IN,tTF(queuefeedback,s,1),,,180)
exten => 81,10,Queue(TAC-IN,tT,,,180)
exten => 81,11,Goto(recordnumber,s,1)
exten => 81,12,Hangup


[queuefeedbackk]
exten => 81,1,set(_EXTEN=${EXTEN})
;exten => 81,n,Playback(feedbackrating)
;exten => 81,n,Playback(ENGLISH/feedbackrating)
;exten => 81,n,Playback(EngUrdu/feedbackrating)  ;Eng Urdu IVR by Zaeem
;exten => 81,n,Read(FDBAK,beep,1,2,2)
exten => 81,n,Read(FDBAK,EngUrdu/feedbackrating,1,,2,2)
exten => 81,n,NoOP(----FDBAK=${FDBAK}----)
exten => 81,n,NoOP(AGENTEXX=${MEMBERINTERFACE:4})
exten => 81,n,AGI(dialoutagentt,${MEMBERINTERFACE:4})
exten => 81,n,Set(QDIALER_AGENT=${AGENT})
exten => 81,n,Set(CALLER=${CALLERID(NUM)})
;exten => 81,n,Playback(thankyou)
;exten => 81,n,Playback(ENGLISH/thank-you-for-calling)
exten => 81,n,Playback(EngUrdu/thank-you-for-calling) ;Eng Urdu IVR by Zaeem
exten => 81,n,AGI(feedbackk.agi,${DATIME},${CALLER},${FDBAK},${EXTEN},${AGENT},${MEMBERINTERFACE:4})
exten => 81,n,Hangup

[feedbacksales]
exten => 82,1,set(_EXTEN=${EXTEN})
;exten => 81,n,Playback(feedbackrating)
;exten => 82,n,Playback(ENGLISH/feedbackrating)
exten => 82,n,Playback(EngUrdu/feedbackrating) ; Eng Urdu IVR by Zaeem
exten => 82,n,Read(FDBAK,beep,1,2,2)
exten => 82,n,NoOP(----FDBAK=${FDBAK}----)
exten => 82,n,NoOP(AGENTEXX=${MEMBERINTERFACE:4})
exten => 82,n,AGI(dialoutagentt,${MEMBERINTERFACE:4})
exten => 82,n,Set(QDIALER_AGENT=${AGENT})
exten => 82,n,Set(CALLER=${CALLERID(NUM)})
;exten => 82,n,Playback(thankyou)
;exten => 82,n,Playback(ENGLISH/thank-you-for-calling)
exten => 82,n,Playback(EngUrdu/thank-you-for-calling) ; Eng Urdu IVR by Zaeem
exten => 82,n,AGI(feedbackk.agi,${DATIME},${CALLER},${FDBAK},${EXTEN},${AGENT},${MEMBERINTERFACE:4})
exten => 82,n,Hangup

[feedbackbilling]
exten => 83,1,set(_EXTEN=${EXTEN})
;exten => 81,n,Playback(feedbackrating)
;exten => 83,n,Playback(ENGLISH/feedbackrating)
exten => 83,n,Playback(EngUrdu/feedbackrating)  ;Eng Urdu IVR by Zaeem
exten => 83,n,Read(FDBAK,beep,1,2,2)
exten => 83,n,NoOP(----FDBAK=${FDBAK}----)
exten => 83,n,NoOP(AGENTEXX=${MEMBERINTERFACE:4})
exten => 83,n,AGI(dialoutagentt,${MEMBERINTERFACE:4})
exten => 83,n,Set(QDIALER_AGENT=${AGENT})
exten => 83,n,Set(CALLER=${CALLERID(NUM)})
;exten => 82,n,Playback(thankyou)
;exten => 83,n,Playback(ENGLISH/thank-you-for-calling)
exten => 83,n,Playback(EngUrdu/thank-you-for-calling) ;Eng Urdu IVR by Zaeem
exten => 83,n,AGI(feedbackk.agi,${DATIME},${CALLER},${FDBAK},${EXTEN},${AGENT},${MEMBERINTERFACE:4})
exten => 83,n,Hangup

[feedbackcore]
exten => 87,1,set(_EXTEN=${EXTEN})
;exten => 81,n,Playback(feedbackrating)
;exten => 87,n,Playback(ENGLISH/feedbackrating)
exten => 87,n,Playback(EngUrdu/feedbackrating)  ;Eng Urdu IVR by Zaeem
exten => 87,n,Read(FDBAK,beep,1,2,2)
exten => 87,n,NoOP(----FDBAK=${FDBAK}----)
exten => 87,n,NoOP(AGENTEXX=${MEMBERINTERFACE:4})
exten => 87,n,AGI(dialoutagentt,${MEMBERINTERFACE:4})
exten => 87,n,Set(QDIALER_AGENT=${AGENT})
exten => 87,n,Set(CALLER=${CALLERID(NUM)})
;exten => 82,n,Playback(thankyou)
;exten => 87,n,Playback(ENGLISH/thank-you-for-calling)
exten => 87,n,Playback(EngUrdu/thank-you-for-calling) ;Eng Urdu IVR by Zaeem
exten => 87,n,AGI(feedbackk.agi,${DATIME},${CALLER},${FDBAK},${EXTEN},${AGENT},${MEMBERINTERFACE:4})
exten => 87,n,Hangup

[recordnumber]
;exten => s,1,Read(CBOPT,getcboption,1,1,2)
;exten => s,2,GotoIf($[${CBOPT}=1]?10:20)

exten => 1,1,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
;exten => s,11,Read(CBNUM,entercbnum,11,2,2)
exten => 1,2,Read(CBNUM,beep,11,2,2)
exten => 1,3,NoOP(----CBNUM=${CBNUM}----)
exten => 1,4,AGI(callback.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
;exten => 1,5,Playback(thank-you-for-calling)
;exten => 1,5,Playback(ENGLISH/thank-you-for-calling)
exten => 1,5,Playback(EngUrdu/thank-you-for-calling) ;Eng Urdu by Zaeem
exten => 1,6,AGI(test.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => 1,7,Hangup

;exten => s,20,Goto(dial-tac-queue,81,8)

[queuetest]
exten = _X.,1,Goto(queuefeedback,s,1)

[queuefeedback]
exten => s,1,NoOP(TAC Queue Feedback)
;exten => s,n,Playback(pls-enter-num-message-after-tone)
exten => s,n,Playback(ENGLISH/pls-enter-num-message-after-tone)   ; IVR is not available
exten => s,n,Read(FDBAK,beep,1,,2,)
exten => s,n,NoOP(Feedback = ${FDBAK})
exten => s,n,AGI(feedback.agi,${DATIME},${CALLER},${FDBAK})
exten => s,n,Hangup



;[dial-sales-queue]

exten => 82,1,NoOp(${CALLERID(num)})			; used to print callerid value in console
exten => 82,n,Set(CURLOPT(conntimeout)=3)		; Curl Option values used to set timeout values to hit API after specified interval to avoid looping of calls
exten => 82,n,Set(CURLOPT(httptimeout)=3)		; Same as above
exten => 82,n,Set(CURL_RESULT=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/cti_api2.php?caller_id=${CALLERID(num)}&queue=2)}) ; Value that is being returned is being stored in CURL_RESULTvariable


exten => 82,n,GotoIfTime(20:00-09:00|mon-sat|*|*?salesoff,s,1)        ;OFF timings diversion to Call back feature
exten => 82,n,GotoIfTime(20:00-11:30|sun|*|*?salesoff,s,1)            ;Sunday Updated Timings
exten => 82,n,GotoIfTime(15:30-09:00|*|*|*?salesoff,s,1)             ;Ramzan Timings 2018 by Abdullah/NGN


;exten => 82,n,GotoIfTime(09:00-23:59|sun|01|may?salesoff,s,1)                     ;1 May 2022 Malik
exten => 82,n,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                           ;Jumma IVR
exten => 82,n,Answer
;exten => 82,n,Playback(newivr/sales_queue_ivr)
;exten => 82,n,Playback(ENGLISH/sales_queue_ivr)
exten => 82,n,Playback(EngUrdu/sales_queue_ivr) ;Eng Urdu IVR by Zaeem
exten => 82,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-SALES-IN-F${CALLERID(NUM)}-T${EXTEN}) ; call recording file name

exten => 82,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 82,n,Set(_CALLER=${CALLERID(NUM)})
;exten => 82,n,Queue(SAL-IN,tT)	; call enter in sales queue
exten => 82,n,Queue(SAL-IN,tTc,,,,,,macro-queuemacro)
exten => 82,n,Goto(feedbacksales,82,1)
exten => 82,n,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup

[dial-sales-queue]  ;Dial Plan of Sales with APIs

exten => 82,1,NoOp(${CALLERID(num)})                    ; used to print callerid value in console
;exten => 82,n,Set(CURLOPT(conntimeout)=3)               ; Curl Option values used to set timeout values to hit API after specified interval to avoid looping of calls
;exten => 82,n,Set(CURLOPT(httptimeout)=3)               ; Same as above
;exten => 82,n,Set(CURL_RESULT=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/cti_api2.php?caller_id=${CALLERID(num)}&queue=2)}) ; Value that is being returned is being stored in CURL_RESULTvariable

exten => 82,2,Set(CURLOPT(conntimeout)=3)
exten => 82,3,Set(CURLOPT(httptimeout)=3)

exten => 82,4,Set(CURL_RESULTO5=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/validate_outage.php?caller_id=${CALLERID(num)})})

;---NEW-API---
;exten => 82,4,Set(CURL_RESULTO5=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id=${CALLERID(num)})})


exten => 82,5,GotoIf($["${CURL_RESULTO5}" != ""] ?6:900)
exten => 82,900,Set(CURL_RESULTO5=0)
exten => 82,901,Goto(dial-sales-queue,82,6)
exten => 82,6,GotoIf(${CURL_RESULTO5} = 1?800:7)

exten => 82,7,Set(CURLOPT(conntimeout)=3)
exten => 82,8,Set(CURLOPT(httptimeout)=3)

exten => 82,9,Set(CURL_RESULT3=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)})})

;---NEW-API----
;exten => 82,9,Set(CURL_RESULT3=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id=${CALLERID(num)})})


exten => 82,10,GotoIf($["${CURL_RESULT3}" != ""] ?11:80)
exten => 82,80,Set(CURL_RESULT3=0)
exten => 82,81,Goto(dial-sales-queue,82,11)

exten => 82,11,GotoIf(${CURL_RESULT3} = 1?90:12)

exten => 82,12,GotoIfTime(20:00-09:00|mon-sat|*|*?salesoff,s,1)        ;OFF timings diversion to Call back feature
exten => 82,13,GotoIfTime(18:00-10:30|sun|*|*?salesoff,s,1)            ;Sunday Updated Timings
;exten => 82,12,GotoIfTime(17:30-09:00|mon-sat|*|*?salesoff,s,1)       ;Ramzan Timings 2022 by aye/NGN
;exten => 82,13,GotoIfTime(17:30-11:00|sun|*|*?salesoff,s,1)           ;Ramzan Sunday timings 2022 by aye/NGN

exten => 82,14,GotoIfTime(09:00-20:00|*|08|feb?salesoff,s,1)          ;8th feb  Day 2024 diversion


exten => 82,15,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                           ;Jumma IVR

exten => 82,16,Set(ivr=${DB(ivr/sal)})
exten => 82,17,GotoIf($[${ivr}=0]?19:18)
exten => 82,18,Playback(problem-ivr/ntl/${ivr})

exten => 82,19,Answer
;exten => 82,n,Playback(ENGLISH/sales_queue_ivr)
exten => 82,20,Playback(EngUrdu/sales_queue_ivr) ;Eng Urdu IVR by Zaeem
exten => 82,21,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-SALES-IN-F${CALLERID(NUM)}-T${EXTEN}) ; call recording file name
exten => 82,22,Monitor(wav,${MONITOR_FILENAME},m) ; .wav generated
exten => 82,23,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 82,24,Set(_CALLER=${CALLERID(NUM)})
;exten => 82,n,Queue(SAL-IN,tT) ; call enter in sales queue
exten => 82,25,Queue(SAL-IN,tTc,,,,,,macro-queuemacro)
exten => 82,26,Goto(feedbacksales,82,1)
exten => 82,27,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup

exten => 82,800,Playback(problem-ivr/ntl/OutageRecord)   ;this ivr is missing btw
exten => 82,801,Hangup

exten=> 82,90,Background(EngUrdu/tacautobonus) ;Eng Urdu IVR by Zaeem

exten => 1,1,Goto(dial-sales-queue,82,100)
exten => 12,1,Goto(dial-sales-queue,82,100)
exten => 11,1,Goto(dial-sales-queue,82,100)
exten => 111,1,Goto(dial-sales-queue,81,100)
exten => 1111,1,Goto(dial-sales-queue,82,100)

exten=> 2,1,Goto(dial-billing-queue,83,1)
exten=> 21,1,Goto(dial-billing-queue,83,1)
exten=> 22,1,Goto(dial-billing-queue,83,1)
exten=> 222,1,Goto(dial-billing-queue,83,1)
exten=> 2222,1,Goto(dial-billing-queue,83,1)

exten=> 3,1,Goto(dial-tac-queue,81,217)
exten=> 31,1,Goto(dial-tac-queue,81,217)
exten=> 33,1,Goto(dial-tac-queue,81,217)
exten=> 333,1,Goto(dial-tac-queue,81,217)
exten=> 3333,1,Goto(dial-tac-queue,81,217)

exten => X.,1,Goto(dial-tac-queue,81,217)

exten => 82,100,NoOp(${CALLERID(num)})
exten => 82,101,Set(CURLOPT(conntimeout)=3)
exten => 82,102,Set(CURLOPT(httptimeout)=3)
exten => 82,103,Set(CURL_RESULT4=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate_queue.php?caller_id=${CALLERID(num)}&avail=true&queue=10)})

;----NEW-API-----
;exten => 82,103,Set(CURL_RESULT4=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id=${CALLERID(num)}&avail=true&queue=10)})




exten => 82,104,GotoIf($["${CURL_RESULT4}" != ""] ?105:600)
exten => 82,600,Set(CURL_RESULT4=0)
exten => 82,601,Goto(dial-sales-queue,82,105)

exten => 82,105,GotoIf(${CURL_RESULT4} = 1 ?400:500)

;exten => 82,400,Playback(ENGLISH/autobonussuccess1) ;changed on req of Salman bhai 25/05/21
exten => 82,400,Playback(EngUrdu/autobonussuccess1)  ;Eng Urdu IVR by Zaeem
exten => 82,401,Hangup

exten => 82,500,Playback(EngUrdu/autobonusfailed) ;Eng Urdu IVR by Zaeem
;exten => 82,500,Playback(ENGLISH/autobonusfailed)   ;this ivr is missing btw
exten => 82,501,Hangup

[dial-bilsales-queue]      ;done as per request from saad malik billing 

;exten => 69,1,NoOp(${CALLERID(num)})                    ; used to print callerid value in console
;exten => 69,n,Set(CURLOPT(conntimeout)=3)               ; Curl Option values used to set timeout values to hit API after specified interval to avoid loops
;exten => 69,n,Set(CURLOPT(httptimeout)=3)               ; Same as above
;exten => 69,n,Set(CURL_RESULT=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/cti_api2.php?caller_id=${CALLERID(num)}&queue=2)})
;exten => 69,n,GotoIfTime(17:30-09:00|*|*|*?salesoff,s,1)                          ;OFF timings diversion to Call back feature
exten => 69,1,Answer
exten => 69,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-SALES-IN-F${CALLERID(NUM)}-T${EXTEN}) ; call recording file name
exten => 69,n,Monitor(wav,${MONITOR_FILENAME},m) ; .wav generated
exten => 69,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 69,n,Set(_CALLER=${CALLERID(NUM)})
;exten => 69,n,Answer
;exten => 69,n,Queue(BIL-IN,tTc)
exten => 69,n,Queue(BIL-IN,tTc,,,,,,macro-queuemacro)
exten => 69,n,Hangup

[recordnumsal]
;exten => s,1,Read(CBOPT,getcboptions,1,1,2)
;exten => s,2,GotoIf($[${CBOPT}=1]?10:20)
exten => 1,1,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 1,2,Read(CBNUM,beep,11,2,2)
exten => 1,3,NoOP(----CBNUM=${CBNUM}----)
exten => 1,4,AGI(callback.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
;exten => 1,5,Playback(thank-you-for-calling)
;exten => 1,5,Playback(ENGLISH/thank-you-for-calling)
exten => 1,5,Playback(EngUrdu/thank-you-for-calling) ;Eng Urdu by Zaeem
exten => 1,6,AGI(callbacksal.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => 1,7,Hangup

;exten => s,20,Goto(dial-sales-queue,82,10)

[salesoff]
exten => s,1,NoOp(${CALLERID(num)})
exten => s,n,Set(CURLOPT(conntimeout)=3)
exten => s,n,Set(CURLOPT(httptimeout)=3)
;;exten => s,n,Set(CURL_RESULT1=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate.php?caller_id=${CALLERID(num)})})
exten => s,n,Set(CURL_RESULT1=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/late_hours_ivr.php?caller_id=${CALLERID(num)})})

;---NEW-API----
;exten => s,n,Set(CURL_RESULT1=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id=${CALLERID(num)})})




;;exten => s,n,playback(normalsales)
exten => s,n,playback(ENGLISH/salesteamavailability)
;exten => s,n,playback(ENGLISH/RamzanSales)
exten => s,n,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => s,n,Read(CBNUM,beep,11,2,2)
exten => s,n,NoOP(----CBNUM=${CBNUM}----)
exten => s,n,AGI(callback.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
;exten => s,n,Playback(thank-you-for-calling)
exten => s,n,Playback(ENGLISH/thank-you-for-calling)
exten => s,n,AGI(callbacksal.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => s,n,Hangup




[dial-billing-oldqueue]

exten => 83,1,NoOp(${CALLERID(num)})
exten => 83,2,Set(CURLOPT(conntimeout)=3)
exten => 83,3,Set(CURLOPT(httptimeout)=3)

exten => 83,4,Set(CURL_RESULT1=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate.php?caller_id=${CALLERID(num)})})

;---NEW-API----
;exten => 83,4,Set(CURL_RESULT1=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id=${CALLERID(num)})})


exten => 83,5,GotoIf($["${CURL_RESULT1}" != ""] ?6:80)

exten => 83,80,Set(CURL_RESULT1=0)       
exten => 83,81,Goto(dial-billing-queue,83,6)
    

exten => 83,6,GotoIf(${CURL_RESULT1} = 1?90:7)

exten => 83,7,GotoIfTime(*|sun|*|*?billoff,s,1)                            ;Sunday Diversion to TAC
exten => 83,8,GotoIfTime(09:00-20:00|tue-thu|21-23|aug?billoff,s,1)       ;Eid ul Azha 2022 Diversion by Talal/NGN 
exten => 83,9,GotoIfTime(09:00-20:00|05|feb?billoff,s,1)               ;5th feb 2019 Diversion
exten => 83,10,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                    ;Jumma IVR diversion
exten => 83,11,GotoIfTime(17:30-09:00|sat|*|*?billoff,s,1)                  ;Saturday Timings
exten => 83,12,GotoIfTime(20:00-09:00|*|*|*?billoff,s,1)                    ;OFF Timing Diversion to billoff IVR
;exten => 83,11,GotoIfTime(15:30-09:00|sat|*|*?billoff,s,1)                  ;Saturday Timings during ramzan
;exten => 83,12,GotoIfTime(17:30-09:00|*|*|*?billoff,s,1)                    ;ramzan timings
exten => 83,13,Answer
;exten => 83,14,Playback(newivr/bill_queue_ivr)
exten => 83,14,Playback(ENGLISH/bill_queue_ivr)
exten => 83,15,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-BILLING-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 83,16,Monitor(wav,${MONITOR_FILENAME},m)
exten => 83,17,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 83,18,Set(_CALLER=${CALLERID(NUM)})
exten => 83,19,Queue(BIL-IN,tT)
exten => 83,20,Hangup

;exten => 83,90,Background(availautobonus) ; avail autobous press 1, else for billing press 2
exten => 83,90,Background(ENGLISH/availautobonus) ; avail autobous press 1, else for billing press 2

exten => 1,1,Goto(dial-billing-queue,83,100)
exten => 12,1,Goto(dial-billing-queue,83,100)
exten => 11,1,Goto(dial-billing-queue,83,100)
exten => 111,1,Goto(dial-billing-queue,83,100)
exten => 1111,1,Goto(dial-billing-queue,83,100)

exten => 2,1,Goto(dial-billing-queue,83,7)
exten => 21,1,Goto(dial-billing-queue,83,7)
exten => 22,1,Goto(dial-billing-queue,83,7)
exten => 222,1,Goto(dial-billing-queue,83,7)
exten => 2222,1,Goto(dial-billing-queue,83,7)

exten => X.,1,Goto(dial-billing-queue,83,7)


exten => 83,100,NoOp(${CALLERID(num)})
exten => 83,101,Set(CURLOPT(conntimeout)=3)
exten => 83,102,Set(CURLOPT(httptimeout)=3)
exten => 83,103,Set(CURL_RESULT2=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate.php?caller_id=${CALLERID(num)}&avail=true)})

;---NEW-API----
;exten => 83,103,Set(CURL_RESULT2=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id=${CALLERID(num)}&avail=true)})



exten => 83,104,GotoIf($["${CURL_RESULT2}" != ""] ?105:600)


exten => 83,600,Set(CURL_RESULT2=0)
exten => 83,601,Goto(dial-billing-queue,83,105)



exten => 83,105,GotoIf(${CURL_RESULT2} = 1 ?200:300)


;exten => 83,200,Playback(autobonussuccessfull) ; autobonus success IVR
exten => 83,200,Playback(ENGLISH/autobonussuccessfinalivr)
exten => 83,201,Hangup

;exten => 83,300,Playback(autobonusfailed) ; autobonus failed IVR
exten => 83,300,Playback(ENGLISH/autobonusfailed)
exten => 83,301,Hangup






[recordnumbil]
;exten => s,1,Read(CBOPT,getcboptionz,1,1,2)
;exten => s,2,GotoIf($[${CBOPT}=1]?10:20)
exten => 1,1,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 1,2,Read(CBNUM,beep,11,2,2)
exten => 1,3,NoOP(----CBNUM=${CBNUM}----)
exten => 1,4,AGI(callback.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
;exten => 1,5,Playback(thank-you-for-calling)
exten => 1,5,Playback(ENGLISH/thank-you-for-calling)
exten => 1,6,AGI(callbackbil.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => 1,7,Hangup

;exten => s,20,Goto(dial-billing-queue,83,10)

[billingoff]
;exten => s,1,playback(normalbilling)
exten => s,1,playback(ENGLISH/normalbilling)
exten => s,2,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => s,3,Read(CBNUM,beep,11,2,2)
exten => s,4,NoOP(----CBNUM=${CBNUM}----)
exten => s,5,AGI(callback.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
;exten => s,6,Playback(thank-you-for-calling)
exten => s,6,Playback(ENGLISH/thank-you-for-calling)
exten => s,7,AGI(callbackbil.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => s,8,Hangup

;[dial-access-queue]  ;02-04-2022 Without Ramzan Auto
;exten => 84,1,GotoIfTime(*|fri|10|dec?dial-tac-queue,81,2)     ;kashmir day

;exten => 84,1,GotoIfTime(08:00-00:00|mon-wed|12-14|sep?dial-tac-queue,81,2)      ; Eid Diversion to TAC applied on 9th sept 16
exten => 84,1,GotoIfTime(00:00-08:00|*|*|*?dial-tac-queue,81,2)      ;done by wajahat/sohail/AB on 23/06/20
exten => 84,2,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)
exten => 84,3,Answer
;exten => 84,2,Set(MONITOR_FILENAME=ACC-IN-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}})
exten => 84,4,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-ACCESS-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 84,5,Monitor(wav,${MONITOR_FILENAME},m)
exten => 84,6,Queue(ACC-IN,tTc)
exten => 84,7,Hangup()

[dial-access-queue]  ;02-04-2022 With Ramzan Auto by Zaeem
;exten => 84,1,GotoIfTime(*|fri|10|dec?dial-tac-queue,81,2)     ;kashmir day
;exten => 84,1,GotoIfTime(08:00-00:00|mon-wed|12-14|sep?dial-tac-queue,81,2)      ; Eid Diversion to TAC applied on 9th sept 16
exten => 84,1,GotoIfTime(23:59-08:00|*|*|*?dial-tac-queue,81,2)      ;done by Ahmed on req of Ahsan Shafiq 06/04/2022
exten => 84,2,Set(ivr1=${DB(ivr/ramzan)})
exten => 84,3,GotoIf($[${ivr1}=1]?4:5)
exten => 84,4,Goto(RamzanAccess,1,1)
exten => 84,5,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)
exten => 84,6,Answer
exten => 84,7,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-ACCESS-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 84,8,Monitor(wav,${MONITOR_FILENAME},m)
exten => 84,9,Queue(ACC-IN,tTc)
exten => 84,10,Hangup()


[RamzanAccess]
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;***Aftaar Timings 2022***;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

exten => 1,1,GotoIfTime(18:23-18:53|*|23-24|mar?ramzan,s,1)
exten => 1,2,GotoIfTime(18:25-18:55|*|25-31|mar?ramzan,s,1)
exten => 1,3,GotoIfTime(18:30-19:00|*|01-06|mar?ramzan,s,1)
exten => 1,4,GotoIfTime(18:35-19:05|*|07-13|apr?ramzan,s,1)
exten => 1,5,GotoIfTime(18:40-19:10|*|14-19|apr?ramzan,s,1)
exten => 1,6,GotoIfTime(18:45-19:15|*|20-21|apr?ramzan,s,1)


exten => 1,7,Goto(dial-access-queue,84,5)
exten => 1,8,Hangup


[dial-ntl-queue]
;exten => 85,1,Goto(dial-tac-queue,81,1)
;exten => 85,2,Answer
;exten => 85,3,Set(MONITOR_FILENAME=NTL-IN-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}})
;exten => 85,4,Queue(NTL-IN|tT)
;exten => 85,5,Hangup()

;[dial-system-queue]
;exten => 86,1,GotoIfTime(*|sun|*|*?dial-tac-queue,81,1)
;exten => 86,2,GotoIfTime(23:00-09:00|*|*|*?dial-tac-queue,81,1)    ;ramazan timing diversion 
;exten => 86,3,Answer
;exten => 86,4,Set(MONITOR_FILENAME=SYS-IN-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}})
;exten => 86,5,Queue(SYS-IN|tT)
;exten => 86,6,Hangup()



;[dial-core-queue]    ;02-04-2022 Without Ramzan Auto
exten => 87,1,GotoIfTime(*|sun|*|*?dial-tac-queue,81,2)
;exten => 87,n,GotoIfTime(09:00-23:59|fri|31|jul?dial-tac-queue,81,2)     ;diversion to level 1 on labour day 2018
exten => 87,n,GotoIfTime(23:59-08:00|tue|19|oct?dial-tac-queue,81,2)    ;Eid Milad un Nabi 2021 by Talal
exten => 87,n,GotoIfTime(08:00-23:59|*|28-31|jul?dial-tac-queue,81,2)     ;23rd March 2022 diversion by AJ 
exten => 87,n,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                       ;Jumma IVR
exten => 87,n,GotoIfTime(23:59-08:00|*|*|*?dial-tac-queue,81,2) ;ramadan Diversion enabled as per email of Ali Malik by muud/NGN on 28/04/20
exten => 87,n,Answer
exten => 87,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-CORE-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 87,n,Monitor(wav,${MONITOR_FILENAME},m)
exten => 87,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 87,n,Set(_CALLER=${CALLERID(NUM)})
;exten => 87,n,Queue(COR-IN,tTc)
;exten => 87,n,Hangup()
exten => 87,n,Queue(COR-IN,tTc,,,,,,macro-queuemacro)
exten => 87,n,Goto(feedbackcore,87,1)
exten => 87,n,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup

[dial-core-queue]      ;02-04-2022 With Ramzan Auto
exten => 87,1,GotoIfTime(*|sun|*|*?dial-tac-queue,81,2)
exten => 87,2,GotoIfTime(08:00-23:59|*|25|dec?dial-tac-queue,81,2)     ;Quaid Day diversion by Ahmed/NGN
exten => 87,3,GotoIfTime(23:59-08:00|*|*|*?dial-tac-queue,81,2) ;ramadan Diversion enabled as per email of Ahsan Shafiq by Ahmed on 06/04/2022
exten => 87,4,Set(ivr1=${DB(ivr/ramzan)})
exten => 87,5,GotoIf($[${ivr1}=1]?6:7)
exten => 87,6,Goto(RamzanCore,1,1)
exten => 87,7,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                       ;Jumma IVR
exten => 87,8,Answer
exten => 87,9,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-CORE-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 87,10,Monitor(wav,${MONITOR_FILENAME},m)
exten => 87,11,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 87,12,Set(_CALLER=${CALLERID(NUM)})
exten => 87,13,Queue(COR-IN,tTc,,,,,,macro-queuemacro)
exten => 87,14,Goto(feedbackcore,87,1)
exten => 87,15,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup


[RamzanCore]
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;***Aftaar Timings 2022***;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

exten => 1,1,GotoIfTime(18:23-18:53|*|23-24|mar?ramzan,s,1)
exten => 1,2,GotoIfTime(18:25-18:55|*|25-31|mar?ramzan,s,1)
exten => 1,3,GotoIfTime(18:30-19:00|*|01-06|mar?ramzan,s,1)
exten => 1,4,GotoIfTime(18:35-19:05|*|07-13|apr?ramzan,s,1)
exten => 1,5,GotoIfTime(18:40-19:10|*|14-19|apr?ramzan,s,1)
exten => 1,6,GotoIfTime(18:45-19:15|*|20-21|apr?ramzan,s,1)

exten => 1,7,Goto(dial-core-queue,87,7)
exten => 1,8,Hangup



[dial-system-direct]
exten => _62X,1,Dial(SIP/${EXTEN},60,Tt)
exten => _62X,2,Hangup()


[internal-Callback]
exten => _9XXX,1,Dial(SIP/${EXTEN},60,Tt)
exten => _9XXX,2,DBput(CallBack/${CALLERID(NUM)}=${EXTEN})
exten => _9XXX,3,Goto(call-status-internal,s-${DIALSTATUS},1)
exten => _9XXX,4,Hangup()

[call-status-internal]
exten => s-CHANUNAVAIL,1,Playback(busy-pls-hold)
exten => s-CHANUNAVAIL,2,wait(3)
exten => s-CHANUNAVAIL,3,DBget(dialed_num=CallBack/${CALLERID(NUM)})
exten => s-CHANUNAVAIL,4,Goto(internal-Callback,${dialed_num},1)

exten => s-BUSY,1,Playback(busy-pls-hold)
exten => s-BUSY,2,wait(3)
exten => s-BUSY,3,DBget(dialed_num=CallBack/${CALLERID(NUM)})
exten => s-BUSY,4,Goto(internal-CallBack,${dialed_num},1)

[tac-spy]
exten => 1947,1,chanspy(SIP/201)

[super-spy]
;include => dial-muuds-queue
exten => 201,1,chanspy(SIP/201,dbwE)
exten => 202,1,chanspy(SIP/202,dbwE)
exten => 203,1,chanspy(SIP/203,dbwE)
exten => 204,1,chanspy(SIP/204,dbwE)
exten => 205,1,chanspy(SIP/205,dbwE)
exten => 206,1,chanspy(SIP/206,dbwE)
exten => 207,1,chanspy(SIP/207,dbwE)
exten => 208,1,chanspy(SIP/208,dbwE)
exten => 209,1,chanspy(SIP/209,dbwE)
exten => 210,1,chanspy(SIP/210,dbwE)
exten => 211,1,chanspy(SIP/211,dbwE)
exten => 212,1,chanspy(SIP/212,dbwE)
exten => 213,1,chanspy(SIP/213,dbwE)
exten => 214,1,chanspy(SIP/214,dbwE)
exten => 215,1,chanspy(SIP/215,dbwE)
exten => 216,1,chanspy(SIP/216,dbwE)
exten => 217,1,chanspy(SIP/217,dbwE)
exten => 218,1,chanspy(SIP/218,dbwE)
exten => 219,1,chanspy(SIP/219,dbwE)
exten => 220,1,chanspy(SIP/220,dbwE)
exten => 221,1,chanspy(SIP/213,dbwE)
exten => 222,1,chanspy(SIP/214,dbwE)
exten => 223,1,chanspy(SIP/215,dbwE)
exten => 224,1,chanspy(SIP/216,dbwE)
exten => 225,1,chanspy(SIP/217,dbwE)
exten => 226,1,chanspy(SIP/218,dbwE)
exten => 227,1,chanspy(SIP/227,dbwE)
exten => 228,1,chanspy(SIP/220,dbwE)


[sales-spy]
exten => 400,1,chanspy(SIP/400,dbwE)
exten => 401,1,chanspy(SIP/401,dbwE)
exten => 402,1,chanspy(SIP/402,dbwE)
exten => 403,1,chanspy(SIP/403,dbwE)
exten => 404,1,chanspy(SIP/404,dbwE)
exten => 405,1,chanspy(SIP/405,dbwE)
exten => 406,1,chanspy(SIP/406,dbwE)
exten => 407,1,chanspy(SIP/407,dbwE)
exten => 408,1,chanspy(SIP/408,dbwE)
exten => 409,1,chanspy(SIP/409,dbwE)
exten => 422,1,chanspy(SIP/422,dbwE)
exten => 428,1,chanspy(SIP/428,dbwE)
exten => 429,1,chanspy(SIP/429,dbwE)
exten => 449,1,chanspy(SIP/449,dbwE)
exten => 443,1,chanspy(SIP/443,dbwE)


[bill-spy]
exten => 467,1,chanspy(SIP/467,dbwE)
exten => 438,1,chanspy(SIP/438,dbwE)
exten => 484,1,chanspy(SIP/484,dbwE)
exten => 486,1,chanspy(SIP/486,dbwE)
exten => 487,1,chanspy(SIP/487,dbwE)
exten => 460,1,chanspy(SIP/460,dbwE)
exten => 464,1,chanspy(SIP/464,dbwE)
exten => 458,1,chanspy(SIP/458,dbwE)
exten => 468,1,chanspy(SIP/468,dbwE)
exten => 461,1,chanspy(SIP/461,dbwE)
exten => 451,1,chanspy(SIP/451,dbwE)
exten => 465,1,chanspy(SIP/465,dbwE)
;exten => 452,1,chanspy(SIP/452,dbwE)
exten => 453,1,chanspy(SIP/453,dbwE)
exten => 455,1,chanspy(SIP/455,dbwE)
exten => 443,1,chanspy(SIP/443,dbwE)
;exten => 450,1,chanspy(SIP/450,dbwE)
;exten => 454,1,chanspy(SIP/454,dbwE)
;exten => 455,1,chanspy(SIP/455,dbwE)
;exten => 456,1,chanspy(SIP/456,dbwE)
;exten => 457,1,chanspy(SIP/457,dbwE)
;exten => 458,1,chanspy(SIP/458,dbwE)
;exten => 459,1,chanspy(SIP/459,dbwE)
;exten => 462,1,chanspy(SIP/462,dbwE)
;exten => 463,1,chanspy(SIP/463,dbwE)
;exten => 464,1,chanspy(SIP/464,dbwE)
;exten => 466,1,chanspy(SIP/466,dbwE)
;exten => 467,1,chanspy(SIP/467,dbwE)
;exten => 468,1,chanspy(SIP/468,dbwE)
;exten => 469,1,chanspy(SIP/469,dbwE)
;exten => 480,1,chanspy(SIP/480,dbwE)
;exten => 481,1,chanspy(SIP/481,dbwE)
;exten => 482,1,chanspy(SIP/482,dbwE)
;exten => 483,1,chanspy(SIP/483,dbwE)
;exten => 485,1,chanspy(SIP/485,dbwE)
;exten => 486,1,chanspy(SIP/486,dbwE)
;exten => 487,1,chanspy(SIP/487,dbwE)
;exten => 485,1,chanspy(SIP/493,dbwE)
;exten => 486,1,chanspy(SIP/494,dbwE)


[tac-internal]
exten=> _200,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,tT)
exten=> _200,2,Hangup

;;;;exten => _21X,1,Dial(SIP/${EXTEN},60,t)
;;;;exten => _21X,2,Hangup

;;;;exten => _2XZ,1,Dial(SIP/${EXTEN},60,t)
;;;;exten => _2XZ,2,Hangup

exten => _2XX,1,Dial(SIP/${EXTEN},60,t)
exten => _2XX,2,Hangup

;exten => _2XZ,2,Monitor(wav|TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}|m)
;exten => _2XZ,3,Hangup
;exten => _2XZ,4,Hangup


[sales-internal]

exten => _40X,1,Dial(SIP/${EXTEN},60,t)
exten => _40X,2,Hangup

exten => _42[02789],1,Dial(SIP/${EXTEN},60,Ttr)
exten => _42[02789],n,hangup()

exten => _4[56]X,1,Dial(SIP/${EXTEN},60,t)
exten => _4[56]X,2,Hangup

[billing-internal]
exten => 489,1,Dial(SIP/NTL-CC-OFF/${EXTEN})
exten => 489,2,Hangup

exten => _45X,1,Dial(SIP/${EXTEN},60,t)
exten => _45X,2,Hangup

exten => _46X,1,Dial(SIP/${EXTEN},60,t)
exten => _46X,2,Hangup

exten => _48X,1,Dial(SIP/${EXTEN},60,t)
exten => _48X,2,Hangup

[from-trunk]
include => parkedcalls
include => internal
include => dial-tac-queue
include => dial-sales-queue
include => dial-billing-queue
include => dial-ntl-queue

[dial-office]
include => parkedcalls
;exten=> _XXX,1,Dial(SIP/pcc-off/${EXTEN},60,tT)
;exten=> _XXX,2,Hangup

;[dial-PSTN]
;exten => 0Z.,1,SET(CALLED=${EXTEN})
;exten => 0Z.,2,Monitor(wav|PSTN-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}|m)
;exten => 0Z.,3,Dial(DAHDI/g0/${EXTEN},60,t)
;exten => 0Z.,4,GotoIf($[${DIALSTATUS}=ANSWERED]?:100)
;exten => 0Z.,5,Hangup
;
;exten => 0Z.,100,Dial(DAHDI/g0/${EXTEN},60,tT)
;exten => 0Z.,101,Hangup


[TAC-DialOut]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=8310000)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=TAC-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _003XXXXXXXXX,n,Monitor(wav,TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLER}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _0Z.,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
;exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0Z.,n,Set(CALLERID(NUM)=8310000)
exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
;exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN})
exten => _0Z.,n,Set(QueueName=TAC-OUT)
;exten => _0Z.,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav,TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLER}-T${EXTEN},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)


exten => _00Z.,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _00Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _00Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _00Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _00Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _00Z.,n,Set(CALLERID(NUM)=8310000)
exten => _00Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _00Z.,n,Set(QueueName=TAC-OUT)
exten => _00z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLER}-T${EXTEN},m)
exten => _00Z.,n,Goto(qm-queuedial,${EXTEN},1)


exten => _XXX,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN})
exten => _XXX,n,Set(QueueName=TAC-OUT)
;exten => _XXX,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _xxx,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)

;below lines are test lines for fsd opbx testing

exten => _2XXX,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _2XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _2XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _2XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _2XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN})
exten => _2XXX,n,Set(QueueName=TAC-OUT)
;exten => _2XXX,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _2XXX,n,Monitor(wav|TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _2xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _2XXX,n,Goto(qm-queuedial,${EXTEN},1)



exten => _3XXX,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _3XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _3XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _3XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _3XXX,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN})
exten => _3XXX,n,Set(QueueName=TAC-OUT)
exten => _3xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _3XXX,n,Goto(qm-queuedial,${EXTEN},1)




exten => _0041.,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _0041.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0041.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0041.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0041.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0041.,n,Set(CALLERID(NUM)=8310000)
exten => _0041.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN:1})
exten => _0041.,n,Set(QueueName=TAC-OUT)
;exten => _0041.,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0041.,n,Monitor(wav,TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0041.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLER}-T${EXTEN},m)
exten => _0041.,n,Goto(qm-queuedial,${EXTEN},1)



exten => _0091.,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _0091.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0091.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0091.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0091.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0091.,n,Set(CALLERID(NUM)=8310000)
exten => _0091.,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN:1})
exten => _0091.,n,Set(QueueName=TAC-OUT)
exten => _0091.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLER}-T${EXTEN},m)
exten => _0091.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _00Z.,1,Set(QDIALER_QUEUE=ACCESS-OUT)
exten => _00Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _00Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _00Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _00Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _00Z.,n,Set(CALLERID(NUM)=8310000)
exten => _00Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _00Z.,n,Set(QueueName=ACCESS-OUT)
;exten => _0Z.,n,MixMonitor(ACCESS-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav|ACCESS-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _00Z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-ACCESS-OUT-F${CALLER}-T${EXTEN},m)
exten => _00Z.,n,Goto(qm-queuedial,${EXTEN},1)


[NTL-DialOut]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=NTL-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=DAHDI/g0/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=NTL-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(NTL-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
exten => _003XXXXXXXXX,n,Monitor(wav|NTL-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _0Z.,1,Set(QDIALER_QUEUE=NTL-OUT)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0Z.,n,Set(QDIALER_CHANNEL=DAHDI/g0/${EXTEN:1})
exten => _0Z.,n,Set(QueueName=NTL-OUT)
;exten => _0Z.,n,MixMonitor(NTL-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
exten => _0Z.,n,Monitor(wav|NTL-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _XXX,1,Set(QDIALER_QUEUE=NTL-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/pcc-off/${EXTEN})
exten => _XXX,n,Set(QueueName=NTL-OUT)
;exten => _XXX,n,MixMonitor(NTL-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
exten => _XXX,n,Monitor(wav|NTL-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)

;below lines are test lines for fsd opbx testing

;exten => _XXXX,1,Set(QDIALER_QUEUE=NTL-OUT)
;exten => _XXXX,n,Set(QDIALER_NUMBER=${EXTEN})
;exten => _XXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
;exten => _XXXX,n,Set(QDIALER_AGENT=${AGENT})
;exten => _XXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-opbx_bck/${EXTEN})
;exten => _XXXX,n,Set(QueueName=NTL-OUT)
;;exten => _XXX,n,MixMonitor(NTL-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;;exten => _XXX,n,Monitor(wav|NTL-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
;exten => _xxxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
;exten => _XXXX,n,Goto(qm-queuedial,${EXTEN},1)

[BILLING-DialOut]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=BILLING-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=8310000)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=BILLING-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(BILLING-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _003XXXXXXXXX,n,Monitor(wav|BILLING-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BILLING-OUT-F${CALLER}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _0Z.,1,Set(QDIALER_QUEUE=BILLING-OUT)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0Z.,n,Set(CALLERID(NUM)=8310000)
exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _0Z.,n,Set(QueueName=BILLING-OUT)
;exten => _0Z.,n,MixMonitor(BILLING-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav|BILLING-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0Z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BILLING-OUT-F${CALLER}-T${EXTEN},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _XXX,1,Set(QDIALER_QUEUE=BILLING-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN})
exten => _XXX,n,Set(QueueName=BILLING-OUT)
;exten => _XXX,n,MixMonitor(BILLING-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|BILLING-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _XXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BILLING-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)




exten => _0041.,1,Set(QDIALER_QUEUE=BILLING-OUT)
exten => _0041.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0041.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0041.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0041.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0041.,n,Set(CALLERID(NUM)=8310000)
exten => _0041.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN:1})
exten => _0041.,n,Set(QueueName=BILLING-OUT)
;exten => _0041.,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0041.,n,Monitor(wav,TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0041.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BILLING-OUT-F${CALLER}-T${EXTEN},m)
exten => _0041.,n,Goto(qm-queuedial,${EXTEN},1)





;below lines are test lines for fsd opbx testing

;exten => _XXXX,1,Set(QDIALER_QUEUE=BILLING-OUT)
;exten => _XXXX,n,Set(QDIALER_NUMBER=${EXTEN})
;exten => _XXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
;exten => _XXXX,n,Set(QDIALER_AGENT=${AGENT})
;exten => _XXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-opbx_bck/${EXTEN})
;exten => _XXXX,n,Set(QueueName=BILLING-OUT)
;;exten => _XXX,n,MixMonitor(BILLING-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;;exten => _XXX,n,Monitor(wav|BILLING-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
;exten => _xxxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
;exten => _XXXX,n,Goto(qm-queuedial,${EXTEN},1)



;FSD EXTENSION DIAL TEST DIALPLAN 27-3-2017

exten => _2XXX,1,Set(QDIALER_QUEUE=BILLING-OUT)
exten => _2XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _2XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _2XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _2XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN})
exten => _2XXX,n,Set(QueueName=BILLING-OUT)
;exten => _2XXX,n,MixMonitor(BILLING-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _2XXX,n,Monitor(wav|BILLING-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _2xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BILLING-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _2XXX,n,Goto(qm-queuedial,${EXTEN},1)


exten => _3XXX,1,Set(QDIALER_QUEUE=BILLING-OUT)
exten => _3XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _3XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _3XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _3XXX,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN})
exten => _3XXX,n,Set(QueueName=BILLING-OUT)
exten => _3xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BILLING-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _3XXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _4XXX,1,Set(QDIALER_QUEUE=SALES-OUT)
exten => _4XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _4XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _4XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _4XXX,n,Set(QDIALER_CHANNEL=SIP/grwopbx2primcc/${EXTEN})
exten => _4XXX,n,Set(QueueName=SALES-OUT)
exten => _4xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BILLING-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _4XXX,n,Goto(qm-queuedial,${EXTEN},1)


exten => _6XXX,1,Set(QDIALER_QUEUE=SALES-OUT)
exten => _6XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _6XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _6XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _6XXX,n,Set(QDIALER_CHANNEL=SIP/sgdopbx2primcc/${EXTEN})
exten => _6XXX,n,Set(QueueName=SALES-OUT)
exten => _6xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BILLING-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _6XXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _7XXX,1,Set(QDIALER_QUEUE=SALES-OUT)
exten => _7XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _7XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _7XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _7XXX,n,Set(QDIALER_CHANNEL=SIP/mtnopbx2primcc/${EXTEN})
exten => _7XXX,n,Set(QueueName=SALES-OUT)
exten => _7xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BILLING-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _7XXX,n,Goto(qm-queuedial,${EXTEN},1)


[SALES-DialOut]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=SALES-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=8310000)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=SALES-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(SALES-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _003XXXXXXXXX,n,Monitor(wav|SALES-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-SALES-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _00Z.,1,Set(QDIALER_QUEUE=SALES-OUT)              ; Done by Muuds as per service desk tt 9596677
exten => _00Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _00Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _00Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _00Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _00Z.,n,Set(CALLERID(NUM)=8310000)
exten => _00Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _00Z.,n,Set(QueueName=SALES-OUT)
;exten => _00Z.,n,MixMonitor(SALES-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _00Z.,n,Monitor(wav|SALES-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _00Z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-SALES-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _00Z.,n,Goto(qm-queuedial,${EXTEN},1)


exten => _0Z.,1,Set(QDIALER_QUEUE=SALES-OUT)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0Z.,n,Set(CALLERID(NUM)=8310000)
exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _0Z.,n,Set(QueueName=SALES-OUT)
;exten => _0Z.,n,MixMonitor(SALES-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav|SALES-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0Z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-SALES-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _XXX,1,Set(QDIALER_QUEUE=SALES-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN})
exten => _XXX,n,Set(QueueName=SALES-OUT)
;exten => _XXX,n,MixMonitor(SALES-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|SALES-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _XXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-SALES-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)


;below lines are test lines for fsd opbx testing

;exten => _XXXX,1,Set(QDIALER_QUEUE=SALES-OUT)
;exten => _XXXX,n,Set(QDIALER_NUMBER=${EXTEN})
;exten => _XXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
;exten => _XXXX,n,Set(QDIALER_AGENT=${AGENT})
;exten => _XXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-opbx_bck/${EXTEN})
;exten => _XXXX,n,Set(QueueName=SALES-OUT)
;;exten => _XXX,n,MixMonitor(SALES-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;;exten => _XXX,n,Monitor(wav|SALES-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
;exten => _xxxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
;exten => _XXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _2XXX,1,Set(QDIALER_QUEUE=SALES-OUT)
exten => _2XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _2XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _2XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _2XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN})
exten => _2XXX,n,Set(QueueName=SALES-OUT)
;exten => _2XXX,n,MixMonitor(SALES-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _2XXX,n,Monitor(wav|SALES-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _2xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-SALES-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _2XXX,n,Goto(qm-queuedial,${EXTEN},1)


exten => _3XXX,1,Set(QDIALER_QUEUE=SALES-OUT)
exten => _3XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _3XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _3XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _3XXX,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN})
exten => _3XXX,n,Set(QueueName=SALES-OUT)
exten => _3xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-SALES-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _3XXX,n,Goto(qm-queuedial,${EXTEN},1)


exten => _4XXX,1,Set(QDIALER_QUEUE=SALES-OUT)
exten => _4XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _4XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _4XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _4XXX,n,Set(QDIALER_CHANNEL=SIP/grwopbx2primcc/${EXTEN})
exten => _4XXX,n,Set(QueueName=SALES-OUT)
exten => _4xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-SALES-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _4XXX,n,Goto(qm-queuedial,${EXTEN},1)


exten => _6XXX,1,Set(QDIALER_QUEUE=SALES-OUT)
exten => _6XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _6XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _6XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _6XXX,n,Set(QDIALER_CHANNEL=SIP/sgdopbx2primcc/${EXTEN})
exten => _6XXX,n,Set(QueueName=SALES-OUT)
exten => _6xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-SALES-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _6XXX,n,Goto(qm-queuedial,${EXTEN},1)


exten => _7XXX,1,Set(QDIALER_QUEUE=SALES-OUT)
exten => _7XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _7XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _7XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _7XXX,n,Set(QDIALER_CHANNEL=SIP/mtnopbx2primcc/${EXTEN})
exten => _7XXX,n,Set(QueueName=SALES-OUT)
exten => _7xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-SALES-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _7XXX,n,Goto(qm-queuedial,${EXTEN},1)

[Access-DialOut]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=ACCESS-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=8310000)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=ACCESS-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(ACCESS-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _003XXXXXXXXX,n,Monitor(wav|ACCESS-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-ACCESS-OUT-F${CALLER}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _0Z.,1,Set(QDIALER_QUEUE=ACCESS-OUT)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0Z.,n,Set(CALLERID(NUM)=8310000)
exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _0Z.,n,Set(QueueName=ACCESS-OUT)
;exten => _0Z.,n,MixMonitor(ACCESS-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav|ACCESS-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0Z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-ACCESS-OUT-F${CALLER}-T${EXTEN},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _00Z.,1,Set(QDIALER_QUEUE=ACCESS-OUT)
exten => _00Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _00Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _00Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _00Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _00Z.,n,Set(CALLERID(NUM)=8310000)
exten => _00Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _00Z.,n,Set(QueueName=ACCESS-OUT)
;exten => _0Z.,n,MixMonitor(ACCESS-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav|ACCESS-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _00Z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-ACCESS-OUT-F${CALLER}-T${EXTEN},m)
exten => _00Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _XXX,1,Set(QDIALER_QUEUE=ACCESS-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _XXX,n,Set(CALLERID(NUM)=8310000)
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN})
exten => _XXX,n,Set(QueueName=ACCESS-OUT)
;exten => _XXX,n,MixMonitor(ACCESS-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|ACCESS-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _XXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-ACCESS-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)

;below lines are test lines for fsd opbx testing

exten => _XXXX,1,Set(QDIALER_QUEUE=ACCESS-OUT)
exten => _XXXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN})
exten => _XXXX,n,Set(QueueName=ACCESS-OUT)
;exten => _XXX,n,MixMonitor(ACCESS-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|ACCESS-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _xxxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-ACCESS-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _0041.,1,Set(QDIALER_QUEUE=ACCESS-OUT)
exten => _0041.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0041.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0041.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0041.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0041.,n,Set(CALLERID(NUM)=8310000)
exten => _0041.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN:1})
exten => _0041.,n,Set(QueueName=ACCESS-OUT)
;exten => _0041.,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0041.,n,Monitor(wav,TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0041.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-ACCESS-OUT-F${CALLER}-T${EXTEN},m)
exten => _0041.,n,Goto(qm-queuedial,${EXTEN},1)

[System-DialOut]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=SYSTEM-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=SYSTEM-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(SYSTEM-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
exten => _003XXXXXXXXX,n,Monitor(wav|SYSTEM-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _0Z.,1,Set(QDIALER_QUEUE=SYSTEM-OUT)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _0Z.,n,Set(QueueName=SYSTEM-OUT)
;exten => _0Z.,n,MixMonitor(SYSTEM-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
exten => _0Z.,n,Monitor(wav|SYSTEM-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _XXX,1,Set(QDIALER_QUEUE=SYSTEM-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN})
exten => _XXX,n,Set(QueueName=SYSTEM-OUT)
;exten => _XXX,n,MixMonitor(SYSTEM-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
exten => _XXX,n,Monitor(wav|SYSTEM-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)


;below lines are test lines for fsd opbx testing

exten => _XXXX,1,Set(QDIALER_QUEUE=SYSTEM-OUT)
exten => _XXXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN})
exten => _XXXX,n,Set(QueueName=SYSTEM-OUT)
;exten => _XXX,n,MixMonitor(SYSTEM-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|SYSTEM-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _xxxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXXX,n,Goto(qm-queuedial,${EXTEN},1)

[activate-announcement]
exten => _11,1,Read(mblorntl|menuivr/mblntloption|1|||)
exten => _11,2,GotoIf($[${mblorntl}=1]?3:15)

exten => _11,3,Read(option|menuivr/ativatedeactivateoption|1|||)
exten => _11,4,GotoIf($[${option}=0]?5:9)

exten => _11,5,Set(DB(ivr/mbl)=0)
exten => _11,6,Playback(menuivr/announcementdeactivated)
exten => _11,7,Playback(vm-goodbye)
exten => _11,8,HangUp()

exten => _11,9,Read(ivrno|menuivr/enteranouncementnumber|2|||)
exten => _11,10,Set(DB(ivr/mbl)=${ivrno})
exten => _11,11,Playback(menuivr/announcementactivated)
exten => _11,12,Playback(problem-ivr/mbl/${ivrno})
exten => _11,13,Playback(vm-goodbye)
exten => _11,14,HangUp()

exten => _11,15,Read(option|menuivr/ativatedeactivateoption|1|||)
exten => _11,16,GotoIf($[${option}=0]?17:21)

exten => _11,17,Set(DB(ivr/ntl)=0)
exten => _11,18,Playback(menuivr/announcementdeactivated)
exten => _11,19,Playback(vm-goodbye)
exten => _11,20,HangUp()

exten => _11,21,Read(ivrno|menuivr/enteranouncementnumber|2|||)
exten => _11,22,Set(DB(ivr/ntl)=${ivrno})
exten => _11,23,Playback(menuivr/announcementactivated)
exten => _11,24,Playback(problem-ivr/ntl/${ivrno})
exten => _11,25,Playback(vm-goodbye)
exten => _11,26,HangUp()


;exten => _12,1,Read(mblorntl|menuivr/mblntloption|1|||)
exten => _12,1,Read(mblorntl,menuivr/mblntloption,1,,,)
exten => _12,2,GotoIf($[${mblorntl}=1]?3:15)

exten => _12,3,Read(option,menuivr/ativatedeactivateoption,1,,,)
exten => _12,4,GotoIf($[${option}=0]?5:9)

exten => _12,5,Set(DB(ivr/ntl)=0)
exten => _12,6,Playback(menuivr/announcementdeactivated)
exten => _12,7,Playback(vm-goodbye)
exten => _12,8,HangUp()

exten => _12,9,Read(ivrno,menuivr/enteranouncementnumber,2,,,)
exten => _12,10,Set(DB(ivr/ntl)=${ivrno})
exten => _12,11,Playback(menuivr/announcementactivated)
exten => _12,12,Playback(problem-ivr/ntl/${ivrno})
exten => _12,13,Playback(vm-goodbye)
exten => _12,14,HangUp()

exten => _12,15,Read(option,menuivr/ativatedeactivateoption,1,,,)
exten => _12,16,GotoIf($[${option}=0]?17:21)

exten => _12,17,Set(DB(ivr/ntl)=0)
exten => _12,18,Playback(menuivr/announcementdeactivated)
exten => _12,19,Playback(vm-goodbye)
exten => _12,20,HangUp()

exten => _12,21,Read(ivrno,menuivr/enteranouncementnumber,2,,,)
exten => _12,22,Set(DB(ivr/ntl)=${ivrno})
exten => _12,23,Playback(menuivr/announcementactivated)
exten => _12,24,Playback(problem-ivr/ntl/${ivrno})
exten => _12,25,Playback(vm-goodbye)
exten => _12,26,HangUp()

;For fsd queue priority test and IVR

exten => _13,1,Read(mblorntl,menuivr/mblntloption,1,,,)
exten => _13,2,GotoIf($[${mblorntl}=1]?3:15)

exten => _13,3,Read(option,menuivr/ativatedeactivateoption,1,,,)
exten => _13,4,GotoIf($[${option}=0]?5:9)

exten => _13,5,Set(DB(ivr2/ntl)=0)
exten => _13,6,Playback(menuivr/announcementdeactivated)
exten => _13,7,Playback(vm-goodbye)
exten => _13,8,HangUp()

exten => _13,9,Read(ivrno,menuivr/enteranouncementnumber,2,,,)
exten => _13,10,Set(DB(ivr2/ntl)=${ivrno})
exten => _13,11,Playback(menuivr/announcementactivated)
exten => _13,12,Playback(problem-ivr/ntl/${ivrno})
exten => _13,13,Playback(vm-goodbye)
exten => _13,14,HangUp()

exten => _13,15,Read(option,menuivr/ativatedeactivateoption,1,,,)
exten => _13,16,GotoIf($[${option}=0]?17:21)

exten => _13,17,Set(DB(ivr2/ntl)=0)
exten => _13,18,Playback(menuivr/announcementdeactivated)
exten => _13,19,Playback(vm-goodbye)
exten => _13,20,HangUp()

exten => _13,21,Read(ivrno,menuivr/enteranouncementnumber,2,,,)
exten => _13,22,Set(DB(ivr2/ntl)=${ivrno})
exten => _13,23,Playback(menuivr/announcementactivated)
exten => _13,24,Playback(problem-ivr/ntl/${ivrno})
exten => _13,25,Playback(vm-goodbye)
exten => _13,26,HangUp()

;For IVR activation from billing extensions
exten => _19,1,Read(mblorntl,menuivr/mblntloption,1,,,)
exten => _19,2,GotoIf($[${mblorntl}=1]?3:15)

exten => _19,3,Read(option,menuivr/ativatedeactivateoption,1,,,)
exten => _19,4,GotoIf($[${option}=0]?9:5)

exten => _19,5,Set(DB(ivr/bill)=0)
exten => _19,6,Playback(menuivr/announcementdeactivated)
exten => _19,7,Playback(vm-goodbye)
exten => _19,8,HangUp()

exten => _19,9,Read(ivrno,menuivr/enteranouncementnumber,2,,,)
exten => _19,10,Set(DB(ivr/bill)=${ivrno})
exten => _19,11,Playback(menuivr/announcementactivated)
exten => _19,12,Playback(problem-ivr/mbl/${ivrno})
exten => _19,13,Playback(vm-goodbye)
exten => _19,14,HangUp()

exten => _19,15,Read(option,menuivr/ativatedeactivateoption,1,,,)
exten => _19,16,GotoIf($[${option}=0]?17:21)
exten => _19,17,Set(DB(ivr/bill)=0)
exten => _19,18,Playback(menuivr/announcementdeactivated)
exten => _19,19,Playback(vm-goodbye)
exten => _19,20,HangUp()

exten => _19,21,Read(ivrno,menuivr/enteranouncementnumber,2,,,)
exten => _19,22,Set(DB(ivr/bill)=${ivrno})
exten => _19,23,Playback(menuivr/announcementactivated)
exten => _19,24,Playback(problem-ivr/ntl/${ivrno})
exten => _19,25,Playback(vm-goodbye)
exten => _19,26,HangUp()

;For IVR activation from Sales extension 187            (change by hamza for sal srf 24-10-2022)
exten => _20,1,Read(mblorntl,menuivr/mblntloption,1,,,)
exten => _20,2,GotoIf($["${mblorntl}"="1"]?3:15)

exten => _20,3,Read(option,menuivr/ativatedeactivateoption,1,,,)
exten => _20,4,GotoIf($["${option}"="0"]?9:5)

exten => _20,5,Set(DB(ivr/sal)=0)
exten => _20,6,Playback(menuivr/announcementdeactivated)
exten => _20,7,Playback(vm-goodbye)
exten => _20,8,HangUp()

exten => _20,9,Read(ivrno,menuivr/enteranouncementnumber,2,,,)
exten => _20,10,Set(DB(ivr/sal)=${ivrno})
exten => _20,11,Playback(menuivr/announcementactivated)
exten => _20,12,Playback(problem-ivr/mbl/${ivrno})
exten => _20,13,Playback(vm-goodbye)
exten => _20,14,HangUp()

exten => _20,15,Read(option,menuivr/ativatedeactivateoption,1,,,)
exten => _20,16,GotoIf($["${option}"="0"]?17:21)
exten => _20,17,Set(DB(ivr/sal)=0)
exten => _20,18,Playback(menuivr/announcementdeactivated)
exten => _20,19,Playback(vm-goodbye)
exten => _20,20,HangUp()

exten => _20,21,Read(ivrno,menuivr/enteranouncementnumber,2,,,)
exten => _20,22,Set(DB(ivr/sal)=${ivrno})
exten => _20,23,Playback(menuivr/announcementactivated)
exten => _20,24,Playback(problem-ivr/ntl/${ivrno})
exten => _20,25,Playback(vm-goodbye)
exten => _20,26,HangUp()

[MBL-menu]
exten=> s,1,Background(new-ivr/F-MBL)
exten=> 1,1,Goto(MBL-TAC-menu,s,1)
exten=> 2,1,Goto(MBL-Sales-menu,s,1)
exten=> 3,1,Goto(MBL-Billing-menu,s,1)
exten=> 0,1,Goto(MBL-Operator-menu,s,1)

exten => _2XX,1,Goto(MBL-TAC-menu,s,1)
exten => _2XX,2,Hangup

exten=> t,1,Goto(MBL-menu,s,1)
;exten=> i,1,Playback(invalid)
exten=> i,1,Playback(ENGLISH/invalid)
exten=> i,2,Goto(MBL-menu,s,1)



[tac-jumma-test]
exten => s,1,GotoIfTime(16:00-18:00|fri|*|*?jumma,s,1)
exten => s,2,Set(ivr=${DB(ivr/mbl)})
exten => s,3,GotoIf($[${ivr}=0]?5:4)
exten => s,4,Playback(problem-ivr/mbl/${ivr})
exten => s,5,Playback(mbl-ivr/tac-trans)
exten => s,6,Goto(dial-tac-queue,81,1)





[MBL-Operator-menu]
exten => s,1,GotoIfTime(*|sun|*|*?MBL-Operator-menu,s,20)
exten => s,2,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)
;exten => s,3,GotoIfTime(15:30-09:00|*|*|*?MBL-Operator-menu,s,20)
exten => s,3,GotoIfTime(17:30-09:00|*|*|*?MBL-Operator-menu,s,20)
;exten => s,4,GotoIfTime(*|mon-wed|12-14|sep?MBL-Operator-menu,s,20) ;Eid Diversion
;exten => s,4,GotoIfTime(*|fri|1|aug?MBL-Operator-menu,s,20)          ;eid diversion
;;exten => s,4,Goto(sip-office,441,1) ;Dial Operator On Office Machine
exten => s,4,Goto(dial-operator-queue,441,1)   ;will be done on 23rd DEC after COB time mehmud

exten => s,20,Playback(newivr/operator_unavailable)
exten => s,21,Goto(dial-tac-queue,81,1)

[sip-office]
;exten => _XXX,1,Dial(SIP/gcc-off/${EXTEN},,)
;exten => _XXX,1,Set(CALLERID(NUM)=${EXTEN})
;exten => _XXX,1,Set(CALLERID(NUM)=0${CALLERID(num)})

exten => _2XXX,1,Dial(SIP/NTL-CC-OFF/${EXTEN},,)
exten => _2XXX,2,Hangup()

exten => _3XXX,1,Dial(SIP/NTL-CC-OFF/${EXTEN},,)
exten => _3XXX,2,Hangup()


exten => _4XXX,1,Dial(SIP/NTL-CC-OFF/${EXTEN},,)
exten => _4XXX,2,Hangup()

exten => _4XXX,1,Dial(SIP/NTL-CC-OFF/${EXTEN},,)
exten => _4XXX,2,Hangup()


exten => _6XXX,1,Dial(SIP/sgdopbx2primcc/${EXTEN},,)
exten => _6XXX,2,Hangup()


exten => _7XXX,1,Dial(SIP/mtnopbx2primcc/${EXTEN},,)
exten => _7XXX,2,Hangup()

exten => _XXX,1,Dial(SIP/NTL-CC-OFF/${EXTEN},,)
exten => _XXX,2,Hangup()


[jumma]
;exten => s,1,Playback(newivr/jumma_ivr)
;exten => s,1,Playback(ENGLISH/jumma_ivr)
exten => s,1,Playback(EngUrdu/jumma_ivr)
exten => s,2,Hangup

[ramzan]
;exten => s,1,Playback(newivr/ramzanneww)
exten => s,1,Playback(ENGLISH/ramzanneww)
exten => s,2,Hangup

[sehri]
;exten => s,1,Playback(newivr/sehrinew)
exten => s,1,Playback(ENGLISH/sehrinew)
exten => s,2,Hangup

[billoff]
;exten => s,1,Playback(newivr/billingoffupdatedd)  ; IVR UPDATED ON 31 MAY 2020 by AB/NGN  
;exten => s,1,Playback(ENGLISH/billingoffupdatedd)
exten => s,1,Playback(EngUrdu/billingoffupdatedd)
;exten => s,1,Playback(EngUrdu/BillingRamzan)
exten => s,2,Hangup


[billnormal]
exten => s,1,Playback(newivr/Recording)
;exten => s,1,Playback(ENGLISH/Recording)  ;IVR is not available need to check further
exten => s,2,Hangup


[TX]
;exten => s,1,Playback(newivr/operatortx)
exten => s,1,Playback(ENGLISH/operatortx)  ;IVR is not available
;exten => s,1,Playback(newivr/ramzanivr)
exten => s,2,Hangup


[MBL-Eid]
exten => s,1,Playback(eid-ivr/mbleidivr)
exten => s,2,GotoIfTime(07:00-10:30|sat|16|jun?MBL-Eid,s,1)
exten => s,3,Goto(dial-tac-queue,81,1)
exten => s,4,Hangup

[mblporblemivr]
exten => s,1,Set(ivr=${DB(ivr/mbl)})
exten => s,2,Playback(problem-ivr/mbl/${ivr})
exten => s,3,Hangup

[NTL-menu]
exten=> s,1,Background(new-ivr/F-Nayatel)
exten=> 1,1,Goto(NTL-tac-menu,s,1)
exten=> 2,1,Goto(NTL-sales-marketing-menu,s,1)

exten => _2XX,1,Goto(NTL-tac-menu,s,1)
exten => _2XX,2,Hangup

include=> sip-office

exten=> t,1,Goto(NTL-menu,s,1)
exten=> i,1,Playback(invalid)
exten=> i,2,Goto(NTL-menu,s,1)

[NTL-TAC-menu]
exten => s,1,GotoIfTime(07:00-10:30|fri|25|sep?NTL-Eid,s,1)
exten => s,2,GotoIfTime(13:00-13:45|fri|*|*?jumma,s,1)
exten => s,3,Set(ivr=${DB(ivr/ntl)})
exten => s,4,GotoIf($[${ivr}=0]?6:5)
exten => s,5,Playback(problem-ivr/ntl/${ivr})
exten => s,6,Goto(dial-ntl-queue,85,1)
;exten => s,6,Dial(SIP/pcc-gcc/85);

[NTL-sales-marketing-menu]
exten => s,1,GotoIfTime(07:00-10:30|thu-sat|24-26|sep?NTL-Eid,s,1)
exten => s,2,GotoIfTime(13:00-13:45|fri|*|*?jumma,s,1)
exten => s,3,Goto(dial-sales-queue,82,1) ;Send The caller to Primary-Call-Center Sales Queue

[NTL-Eid]
exten => s,1,Playback(eid-ivr/ntleidivr)
exten => s,2,GotoIfTime(07:00-10:30|sat|16|jun?NTL-Eid,s,1)   ; EID UL FITR IVR 2018 by Abdullah/NGN
exten => s,3,Goto(dial-ntl-queue,85,1)
exten => s,4,Hangup
 
[from_PTCL_trunk]
exten => s,1,Dial(SIP/2096001,60,rt)
exten => s,2,Hangup()

[NSS-Awam-OG]
include =>NSS-Awam

exten => _0X.,1,Set(CALLERID(NUM)=8310000)
exten => _0X.,2,Dial(SIP/NTL-CC-1/${EXTEN:1},60,rtT)
exten => _0X.,3,Hangup()


[from-sip-trunk]

exten => 722,1,Dial(SIP/722,60,trT)
exten => 722,2,Hangup()
exten => 701,1,Dial(SIP/701,60,trT)
exten => 701,2,Hangup()
exten => 720,1,Dial(SIP/720,60,trT)
exten => 720,2,Hangup()
exten => 721,1,Dial(SIP/721,60,trT)
exten => 721,2,Hangup()
exten => 706,1,Dial(SIP/706,60,trT)
exten => 706,2,Hangup()
exten => 719,1,Dial(SIP/719,60,trT)
exten => 719,2,Hangup()
exten => 723,1,Dial(SIP/723,60,trT)
exten => 723,2,Hangup()



exten => 8310703,1,Goto(dial-L2TEST-queue,95,1)
exten => 8310703,2,Hangup

exten => 409,1,Answer
exten => 409,2,Queue(SAL-IN|tT)
;exten => 409,2,Dial(SIP/409,60,tT)
exten => 409,3,Hangup

exten => 643,1,GotoIfTime(00:00-07:59|*|*|*?from-sip-trunk,643,10)
exten => 643,10,Dial(SIP/643,60,tT)
exten => 643,11,Hangup
;exten => 77,1,Goto(dial-NSS-queue,${EXTEN},1)

exten => _461,1,Dial(SIP/461,10,tTr) ;CFW towards 459 if unanswered for 3 rings. As per request of haseeb/AM fin. on 22-07-2017

;exten => _461,2,Dial(SIP/452,60,tTr); changed from 459 to 452 on 25/8/2017 as per request of haseeb bhai AM/fin.

exten => _461,2,Dial(SIP/465,60,tTr); changed from 452 to 465 on 10/10/2017 as per request of haseeb bhai AM/fin.
exten => _461,3,Hangup


exten => _453,1,Dial(SIP/453,60,tT)
exten => _453,2,Hangup

exten => _452,1,Dial(SIP/452,60,tT)
exten => _452,2,Hangup

exten => _675,1,Dial(SIP/675,60,tT)
exten => _675,2,Hangup



include => activate-announcement
include => out-hotline-zap
include => parkedcalls
include => internal
include => dial-tac-queue
include => dial-sales-queue
include => dial-billing-queue
;include => dial-ntl-queue
include => dial-access-queue
;include => dial-system-queue
include => dial-core-queue
include => Dial-Core-Queue
include => dial-tx-queue
include => dahdi-out
include => dial-salfsd-queue
include => dial-salespwr-queue
include => dial-BD-queue
include => dial-NSS-queue
include => dial-salesgrw-queue
include => dial-salessgd-queue
include => dial-salesmtn-queue
exten => 99,1,Goto(Mainmenu,s,1)



[out-hotline-zap]
exten=> _hX.,1,Set(CALLERID(all)=Nayatel<51${CALLERID(num)}>)
exten=> _hX.,2,Dial(DAHDI/g0/${EXTEN:1},60,t)
exten=> _hX.,3,Hangup

[dahdi-out]


exten=> 08310000,1,Goto(Mainmenu,s,1)

;exten=> _0X.,1,Set(CALLERID(all)=<${CALLERID(num)}>)

;exten=> _0X.,1,GotoIf(${CALLERID(num)}=8310088?2:10)
;exten=> _0X.,2,Dial(SIP/NTL-CC-1/${EXTEN:1},60,t)
;exten=> _0X.,3,Hangup


exten=> _0X.,1,Set(CALLERID(all)=Nayatel<8310${CALLERID(num)}>)
exten=> _0X.,2,Dial(SIP/NTL-CC-1/${EXTEN:1},60,t)
exten=> _0X.,3,Hangup

exten=> _2X.,1,Set(CALLERID(all)=Nayatel<$8310{CALLERID(num)}>) 
exten=> _2X.,2,Dial(SIP/NTL-CC-1/${EXTEN:1},60,t)
exten=> _2X.,3,Hangup

[Core-Check]


;exten => _55xx,1,Dial(SIP/{EXTEN},60,rtT)    ; Work from home corona by muuds


exten => _5X,1,Dial(SIP/gcc-off/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => _7XXXX,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)

exten => _20,1,Goto(Core-Pause,20,1)
exten => _21,1,Goto(Core-Pause,21,1)

exten => 788,1,Goto(Core-TAC,${EXTEN},1)
exten => 789,1,Goto(Core-TAC,${EXTEN},1)

exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)
exten => 200,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,trT)

exten => 81,1,Hangup	; as per requirement of Salman/AM TAC for blocking calls from L2 to L1 by Abdullah/NGN

;exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)  ; Uncomment when TAC Q is shifted to NEWCC
;exten => 81,1,Dial(SIP/NTL-CC-PRI/${EXTEN},1)   ; FOr TAC Calls from CORQ to PCC; COmment when TACQ is shifted to NEWCC

exten => 82,1,Goto(dial-sales-queue,${EXTEN},1) ; Uncomment when SALQ is shifted to NEWCC
;exten => 82,1,Dial(SIP/NTL-CC-SEC/${EXTEN},1)  ; FOR SALES Calls from CORQ to SEC CC; Comment when SALQ is shifted to NEWCC

exten => 83,1,Goto(dial-billing-queue,${EXTEN},1) ;Uncomment when BILQ is shifted to NEWCC
;exten => 83,1,Dial(SIP/NTL-CC-SEC/${EXTEN},1)  ; FOR BILLING Calls from CORQ to SEC CC; Comment when BILLQ is shifted to NEWCC

exten => 84,1,Goto(dial-access-queue,${EXTEN},1)  ;before L2 Tac merger, Uncomment when ACCQ is shifted to NEWCC

;exten => 84,1,Goto(dial-core-queue,87,1)   ; L2 TAC merger

exten => 84,1,Dial(SIP/NTL-CC-PRI/${EXTEN},1)   ; FOr ACC-TAC Calls from CORQ to PCC; COmment when ACC-Q is shifted to NEWCC
exten => 86,1,Goto(Dial-Core-Queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)

exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)

exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)

exten => 87,1,Goto(dial-core-queue,${EXTEN},1)

exten => _X.,1,Goto(Core-TAC,${EXTEN},1)

exten => _2xxx,1,Dial(SIP/NTL-CC-FSD/${EXTEN},60,rtT)
exten => _3xxx,1,Dial(SIP/pwropbx2primcc/${EXTEN},60,rtT)
exten => _4xxx,1,Dial(SIP/grwopbx2primcc/${EXTEN},60,rtT)
exten => _6xxx,1,Dial(SIP/sgdopbx2primcc/${EXTEN},60,rtT)
exten => _7xxx,1,Dial(SIP/mtnopbx2primcc/${EXTEN},60,rtT)

exten => _8xxx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,rtT)

[Core-TAC]
include=> Core-queue-Login
include=> CoreTAC-internal
include=> dial-operator-queue
include=> internal
include=> Core-DialOut

[CoreTAC-internal]
exten => _62X,1,Dial(SIP/${EXTEN},60,rt)
exten => _62X,2,Hangup


exten => _64X,1,Dial(SIP/${EXTEN},60,rt) ; L2 TAC merger
exten => _64X,2,hangup   ; L2 TAC merger



[Core-Pause]
exten => 20,1,PauseQueueMember(COR-IN,SIP/${CALLERID(num)},,Test Pause Code)
exten => 20,n,Hangup()

exten => 21,1,UnPauseQueueMember(COR-IN,SIP/${CALLERID(num)})
exten => 21,n,Hangup()


;[dial-core-queue]
;exten => 87,1,Answer
;exten => 87,2,Set(MONITOR_FILENAME=CORQ-${CALLERID(NUM)}--${STRFTIME(${EPOCH},,%d-%m-%Y_%H:%M:%S)-${UNIQUEID}})
;exten => 87,3,Queue(COR-IN|tT)
;exten => 87,4,Hangup()


[Core-queue-Login]
exten => 788,1,Goto(CoreTAC-login,2,1)
exten => 789,1,Goto(CoreTAC-logout,1,1)

[CoreTAC-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _6XXX,1,Set(xx=${DB(COR-IN/${CALLERID(NUM)})})
exten => _6XXX,2,GotoIf($[${xx}=7]?15)
exten => _6XXX,3,Playback(agent-pass)
exten => _6XXX,4,Read(PASS)
exten => _6XXX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _6XXX,6,GotoIf($[${abc}=7]?13)
exten => _6XXX,7,AddQueueMember(COR-IN,SIP/${CALLERID(NUM)})
exten => _6XXX,8,Set(DB(COR-IN/${CALLERID(NUM)})=7)
exten => _6XXX,9,Playback(agent-loginok)
exten => _6XXX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _6XXX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _6XXX,12,Goto(CoreTAC-login,_6XXX,17)
exten => _6XXX,13,Playback(auth-incorrect)
exten => _6XXX,14,Goto(CoreTAC-login,${EXTEN},4)
exten => _6XXX,15,Playback(agent-alreadyon)
exten => _6XXX,16,Goto(CoreTAC-login,2,1)
exten => _6XXX,17,Hangup()

[CoreTAC-logout]
exten => 1,1,Background(agent-user)
exten => _6XXX,1,Playback(agent-pass)
exten => _6XXX,2,read(PASS)
exten => _6XXX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _6XXX,4,GotoIf($[${abc}=7]?11)
exten => _6XXX,5,SET(DB(COR-IN/${CALLERID(NUM)})=0)
exten => _6XXX,6,RemoveQueueMember(COR-IN,SIP/${CALLERID(NUM)})
exten => _6XXX,7,Playback(agent-loggedoff)
exten => _6XXX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _6XXX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _6XXX,10,Goto(CoreTAC-logout,_6XXX,13)
exten => _6XXX,11,Playback(auth-incorrect)
exten => _6XXX,12,Goto(CoreTAC-logout,${EXTEN},2)
exten => _6XXX,13,Hangup()

[Core-DialOut]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=CORE-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=8310000)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=CORE-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(CORE-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _003XXXXXXXXX,n,Monitor(wav|CORE-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-CORE-OUT-F${CALLER}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _0Z.,1,Set(QDIALER_QUEUE=CORE-OUT)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0z.,n,Set(CALLERID(NUM)=8310000)
exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _0Z.,n,Set(QueueName=CORE-OUT)
;exten => _0Z.,n,MixMonitor(CORE-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav|CORE-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0Z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-CORE-OUT-F${CALLER}-T${EXTEN},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _XXX,1,Set(QDIALER_QUEUE=CORE-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN})
exten => _XXX,n,Set(QueueName=CORE-OUT)
;exten => _XXX,n,MixMonitor(CORE-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|CORE-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _XXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-CORE-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)

;below lines are test lines for fsd opbx testing

exten => _2XXX,1,Set(QDIALER_QUEUE=CORE-OUT)
exten => _2XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _2XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _2XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _2XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN})
exten => _2XXX,n,Set(QueueName=CORE-OUT)
;exten => _2XXX,n,MixMonitor(CORE-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _2XXX,n,Monitor(wav|CORE-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _2xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-CORE-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _2XXX,n,Goto(qm-queuedial,${EXTEN},1)



exten => _3XXX,1,Set(QDIALER_QUEUE=CORE-OUT)
exten => _3XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _3XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _3XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _3XXX,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN})
exten => _3XXX,n,Set(QueueName=CORE-OUT)
exten => _3xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-CORE-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _3XXX,n,Goto(qm-queuedial,${EXTEN},1)







exten => _0041.,1,Set(QDIALER_QUEUE=CORE-OUT)
exten => _0041.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0041.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0041.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0041.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0041.,n,Set(CALLERID(NUM)=8310000)
exten => _0041.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN:1})
exten => _0041.,n,Set(QueueName=CORE-OUT)
;exten => _0041.,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0041.,n,Monitor(wav,TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0041.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-CORE-OUT-F${CALLER}-T${EXTEN},m)
exten => _0041.,n,Goto(qm-queuedial,${EXTEN},1)



exten => _0091.,1,Set(QDIALER_QUEUE=CORE-OUT)
exten => _0091.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0091.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0091.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0091.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0091.,n,Set(CALLERID(NUM)=8310000)
exten => _0091.,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN:1})
exten => _0091.,n,Set(QueueName=CORE-OUT)
exten => _0091.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-CORE-OUT-F${CALLER}-T${EXTEN},m)
exten => _0091.,n,Goto(qm-queuedial,${EXTEN},1)




[TEST-DialOut]
exten => _XX.,1,Set(QDIALER_QUEUE=TEST-OUT)
exten => _XX.,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XX.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XX.,n,Set(QDIALER_AGENT=${AGENT})
exten => _XX.,n,Set(QDIALER_CHANNEL=SIP/gcc-off/${EXTEN})
exten => _XX.,n,Set(QueueName=TEST-OUT)
;exten => _XXX.,n,MixMonitor(TEST-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
exten => _XX.,n,Monitor(wav|TST-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _XX.,n,Goto(qm-queuedialtest,${EXTEN},1)

[qm-queuedial]
exten => _XX.,1,NoOp("Outbound call -> A:${QDIALER_AGENT} N:${QDIALER_NUMBER} Q:${QDIALER_QUEUE} Ch:${QDIALER_CHANNEL}")
exten => _XX.,n,Set(ST=${EPOCH})
exten => _XX.,n,Set(GM=QDV-${QDIALER_AGENT})
exten => _XX.,n,Set(GLOBAL(${GM})=U)
exten => _XX.,n,Set(GLOBAL(${GM}ans)=0)
exten => _XX.,n,Macro(queuelog,${ST},${UNIQUEID},${QDIALER_QUEUE},${QDIALER_AGENT},ENTERQUEUE,-,${QDIALER_NUMBER})
exten => _XX.,n,Dial(${QDIALER_CHANNEL},30,gM(queuedial-answer^${UNIQUEID}^${GM}^${QDIALER_QUEUE}^${QDIALER_AGENT}^${ST}))
exten => _XX.,n,Set(CAUSECOMPLETE=${IF($["${DIALSTATUS}" = "ANSWER"]?C)})

; Trapping call termination here
exten => h,1,NoOp( "Call exiting: status ${GLOBAL(${GM})} answered at: ${GLOBAL(${GM}ans)} DS: ${DIALSTATUS}"  )
exten => h,n,Goto(case-${GLOBAL(${GM})})
exten => h,n,Hangup()

; Call unanswered
exten => h,n(case-U),Set(WT=$[${EPOCH} - ${ST}])
exten => h,n,Macro(queuelog,${EPOCH},${UNIQUEID},${QDIALER_QUEUE},${QDIALER_AGENT},ABANDON,1,1,${WT})
exten => h,n,Hangup()

; call answered: agent/callee hung
exten => h,n(case-A),Set(COMPLETE=${IF($["${CAUSECOMPLETE}" = "C"]?COMPLETECALLER:COMPLETEAGENT)})
exten => h,n,Set(WT=$[${GLOBAL(${GM}ans)} - ${ST}])
exten => h,n,Set(CT=$[${EPOCH} - ${GLOBAL(${GM}ans)}])
exten => h,n,Macro(queuelog,${EPOCH},${UNIQUEID},${QDIALER_QUEUE},${QDIALER_AGENT},${COMPLETE},${WT},${CT})
exten => h,n,Hangup()

exten => 441,1,Goto(dial-operator-queue,441,1)
exten => 411,n,Hangup()

[macro-queuedial-answer]
exten => s,1,NoOp("Macro: queuedial-answer UID:${ARG1} GR:${ARG2} Q:${ARG3} A:${ARG4} E:${ARG5}")
exten => s,n,Set(NOW=${EPOCH})
exten => s,n,Set(WD=$[${NOW} - ${ARG5}])
exten => s,n,Macro(queuelog,${NOW},${ARG1},${ARG3},${ARG4},CONNECT,${WD})
exten => s,n,Set(GLOBAL(${ARG2})=A)
exten => s,n,Set(GLOBAL(${ARG2}ans)=${NOW})
exten => s,n,NoOp("Macro queuedial-answer terminating" )

[macro-queuelog]
;exten => s,1,System( echo "${ARG1}|${ARG2}|${ARG3|${ARG4}|${ARG5}|${ARG6}|${ARG7}|${ARG8}" >> /var/log/asterisk/queue_log )
exten => s,1,QueueLog(${ARG3},${ARG2},${ARG4},${ARG5},${ARG6}|${ARG7}|${ARG8})


[eidivr]
exten => s,1,Playback(newivr/eid_ivr)
;exten => s,2,GotoIfTime(7:00-10:30|sat|01|aug?eidivr,s,1) ;Eid-ul-Azha 2020 by AB/NGN
;exten => s,3,Goto(Mainmenu,s,2)
exten => s,2,Hangup

[eidivrtest]
exten => _X.,1,Goto(eidivr,s,1)

;[queuetest]
;exten => 88,1,Answer
;exten => 88,2,Queue(TEST-IN|tT)
;exten => 88,3,Hangup

[LOCKIVR]
exten => s,1,Answer
exten => s,n,Wait(1)
exten => s,n,Playback(lockivr)
exten => s,n,Goto(LOCKIVR,s,1)


[IVRTEST]
exten => 81,1,GotoIfTime(19:00-23:00|thu-fri|26-27|jun?3:2)
exten => 81,2,Playback(outageivr26june)
exten => 81,3,Answer
exten => 81,4,Playback(newivr/tac_queue_ivr)
exten => 81,5,Hangup

[test]

;exten = _11,1,Goto(activate-announcement,11,1)

;include= activate-announcement
;exten => _X.,1,Dial(SIP/NTL-CC-1/${EXTEN},60,tT)
;exten => _X.,2,Hangup

;[incoming]
;exten => 8734460,1,Set(CALLERID(NUM)=0${CALLERID(num)}) ;Append Zero To CallerID
;exten => 8734460,2,Dial(SIP/NTL-CC-1/100,60,rtT)

[cbtest]
exten => _X.,1,Answer
exten => _X.,2,Goto(recordnumber,s,1)
exten => _X.,3,Hangup

[SOUNDTEST]
exten => s,1,Answer
;exten => s,2,playback(newivr/billingoff)
exten => s,2,Playback(pakistan/national_anthem)
exten => s,3,Hangup

[Tac-Access-test]
exten => 81,1,NoOP(CallerID is ${CALLERID(NUM)})
exten => 81,2,Set(CALLERID(NUM)=0${CALLERID(NUM)})
exten => 81,3,NoOP(CallerID after changing is ${CALLERID(NUM)})
exten => 81,4,Dial(SIP/NTL-CC-PRI/${EXTEN},60,tT)
exten => 81,5,Hangup



[Tx-Check]

exten => _57xx,1,Dial(SIP/${EXTEN},60,rtT)

exten => _5X,1,Dial(SIP/gcc-off/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)	
exten => _7X,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)

exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)


exten => 788,1,Goto(Tx-Team,${EXTEN},1)
exten => 789,1,Goto(Tx-Team,${EXTEN},1)
exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)    
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)   
exten => 83,1,Goto(dial-billing-queue,${EXTEN},1) 
exten => 85,1,Goto(dial-ntl-queue,${EXTEN},1)
exten => 86,1,Goto(dial-system-queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,${EXTEN},1) ; before L2 Tac merger

;exten => 84,1,Goto(dial-core-queue,87,1)    ;L2 TAC merger

exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)
;exten => 61X,1,Goto(billing-internal,${EXTEN},1)
exten => _X.,1,Goto(Tx-Team,${EXTEN},1)

[Tx-Queue-Login]
exten => 788,1,Goto(Tx-login,2,1)
exten => 789,1,Goto(Tx-logout,1,1)


[Tx-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _7XXX,1,Set(xx=${DB(TX-IN/${CALLERID(NUM)})})
exten => _7XXX,2,GotoIf($[${xx}=7]?15)
exten => _7XXX,3,Playback(agent-pass)
exten => _7XXX,4,Read(PASS)
exten => _7XXX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _7XXX,6,GotoIf($[${abc}=7]?13)
exten => _7XXX,7,AddQueueMember(TX-IN,SIP/${CALLERID(NUM)})
exten => _7XXX,8,Set(DB(Tx-IN/${CALLERID(NUM)})=7)
exten => _7XXX,9,Playback(agent-loginok)
exten => _7XXX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _7XXX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _7XXX,12,Goto(Tx-login,_7XXX,17)
exten => _7XXX,13,Playback(auth-incorrect)
exten => _7XXX,14,Goto(Tx-login,${EXTEN},4)
exten => _7XXX,15,Playback(agent-alreadyon)
exten => _7XXX,16,Goto(Tx-login,2,1)
exten => _7XXX,17,Hangup()

[Tx-logout]
exten => 1,1,Background(agent-user)
exten => _7XXX,1,Playback(agent-pass)
exten => _7XXX,2,read(PASS)
exten => _7XXX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _7XXX,4,GotoIf($[${abc}=7]?11)
exten => _7XXX,5,SET(DB(TX-IN/${CALLERID(NUM)})=0)
exten => _7XXX,6,RemoveQueueMember(Tx-IN,SIP/${CALLERID(NUM)})
exten => _7XXX,7,Playback(agent-loggedoff)
exten => _7XXX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _7XXX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _7XXX,10,Goto(Tx-logout,_7XXX,13)
exten => _7XXX,11,Playback(auth-incorrect)
exten => _7XXX,12,Goto(Tx-logout,${EXTEN},2)
exten => _7XXX,13,Hangup()


[Tx-Team]
include=> Tx-Queue-Login
include=> internal
include=> Tx-Dialout
include=> dial-tx-queue
include=> Tx-Pause

[internal]
;exten=> _200,1,Goto(dial-office,${EXTEN},1)
;exten=> _200,2,Hangup
exten => _2XZ,1,Goto(dial-tac-queue,81,1)
exten => _40X,1,Goto(dial-sales-queue,82,1)
exten => _45X,1,Goto(dial-billing-queue,83,1)
exten => _64X,1,Goto(dial-access-queue,84,1)    ; before L2 TAC merger
exten => 77,1,Goto(dial-NSS-queue,77,1)
exten => 86,1,Goto(Dial-Core-Queue,86,1)
;exten => _64X,1,Goto(dial-core-queue,87,1)          ; L2 TAC merger

exten => _62X,1,Goto(dial-system-queue,86,1)
;exten => _XXX,1,Goto(dial-office,${EXTEN},1)
;exten => _XXX,2,Hangup()




[dial-tx-queue]
;exten => 89,1,GotoIfTime(*|sun|*|*?dial-tac-queue,81,2)             ;Sunday diversion to LEVEL 1 TAC
;exten => 89,n,GotoIfTime(17:30-09:00|*|*|*?TX,s,1)                  ;OFF Timing Diversion to OFF hours IVR
;exten => 89,n,GotoIfTime(15:30-09:00|mon-sat|*|*?TX,s,1)           ;Ramzan 2022 Timings by Ahmed/NGN
;****************************************Gazetted Holidays & Ramdan Diversions*********************************************
;exten => 89,n,GotoIfTime(09:00-17:30|wed|23|mar?TX,s,1)             ;23rd March 2022 diversion by AJ
;exten => 89,n,GotoIfTime(09:00-17:30|*|08-12|jul?TX,s,1)            ;eid ul fitr 2022 By Talal/NGN
;exten => 89,n,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)             ;Jumma IVR
;exten => 89,n,GotoIfTime(09:00-17:30|sat-sun|01-02|aug?TX,s,1)
;exten => 89,n,Answer
;exten => 89,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TX-IN-F${CALLERID(NUM)}-T${EXTEN})
;exten => 89,n,Monitor(wav,${MONITOR_FILENAME},m)
;exten => 89,n,Queue(TX-IN,tTc)
exten => 89,1,Hangup()



;[callbacktx]
;exten => s,1,Read(CBOPT,getcboption,1,1,2)
;exten => s,2,GotoIf($[${CBOPT}=1]?10:20)

;exten => s,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
;exten => s,11,Read(CBNUM,entercbnum,11,2,2)
;exten => s,11,Read(CBNUM,beep,11,2,2)
;exten => s,12,NoOP(----CBNUM=${CBNUM}----)
;exten => s,13,AGI(callback.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
;exten => s,14,Playback(thank-you-for-calling)
;exten => s,15,AGI(test.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
;exten => s,16,Hangup

;exten => s,20,Goto(dial-tx-queue,89,10)

[Tx-Dialout]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=TX-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=8310000)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=TX-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(TX-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _003XXXXXXXXX,n,Monitor(wav,TX-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TX-OUT-F${CALLER}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _0Z.,1,Set(QDIALER_QUEUE=TX-OUT)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0Z.,n,Set(CALLERID(NUM)=8310000)
exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _0Z.,n,Set(QueueName=TX-OUT)
;exten => _0Z.,n,MixMonitor(TX-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav,TX-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TX-OUT-F${CALLER}-T${EXTEN},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _XXX,1,Set(QDIALER_QUEUE=TX-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _XXX,n,Set(CALLERID(NUM)=8310000)
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN})
exten => _XXX,n,Set(QueueName=TX-OUT)
;exten => _XXX,n,MixMonitor(TX-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|TX-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _xxx,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TX-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)

;below lines are test lines for fsd opbx testing

exten => _2XXX,1,Set(QDIALER_QUEUE=TX-OUT)
exten => _2XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _2XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _2XXX,n,Set(QDIALER_AGENT=${AGENT})
;exten => _2XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-opbx_bck/${EXTEN})
exten => _2XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN})     ; added due to failure in TX queue dialing FSD OPBX extension issue reported on 17-2-2017
exten => _2XXX,n,Set(QueueName=TX-OUT)
;exten => _2XXX,n,MixMonitor(TX-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _2XXX,n,Monitor(wav|TX-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)

;exten => _2xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLERID(NUM)}-T${EXTEN},m)

exten => _2xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TX-OUT-F${CALLERID(NUM)}-T${EXTEN},m)  ;changed on 17-2-2017 on geenrally observing tx out call recording format

exten => _2XXX,n,Goto(qm-queuedial,${EXTEN},1)






exten => _3XXX,1,Set(QDIALER_QUEUE=TX-OUT)
exten => _3XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _3XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _3XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _3XXX,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN})    
exten => _3XXX,n,Set(QueueName=TX-OUT)
exten => _3xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TX-OUT-F${CALLERID(NUM)}-T${EXTEN},m)  
exten => _3XXX,n,Goto(qm-queuedial,${EXTEN},1)











[Salesfsd-Check]
exten => _5X,1,Dial(SIP/gcc-off/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => _7X,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)
exten => _4xxx,1,Dial(SIP/grwopbx2primcc/${EXTEN},60,rtT)
exten => _6xxx,1,Dial(SIP/sgdopbx2primcc/${EXTEN},60,rtT)
exten => _7xxx,1,Dial(SIP/mtnopbx2primcc/${EXTEN},60,rtT)

exten => 788,1,Goto(salfsd-Team,${EXTEN},1)
exten => 789,1,Goto(salfsd-Team,${EXTEN},1)

exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)


exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)
exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)
exten => 85,1,Goto(dial-ntl-queue,${EXTEN},1)
exten => 86,1,Goto(dial-system-queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,${EXTEN},1)   ; before L2 TAC merger

;exten => 84,1,Goto(dial-core-queue,87,1)    ;   L2 TAC merger

exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)
;exten => 61X,1,Goto(billing-internal,${EXTEN},1)
exten => _X.,1,Goto(salfsd-Team,${EXTEN},1)
exten=> 89,1,Goto(dial-tx-queue,${EXTEN},1)


[salfsd-Queue-Login]
exten => 788,1,Goto(salfsd-login,2,1)
exten => 789,1,Goto(salfsd-logout,1,1)

[salfsd-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _8XXX,1,Set(xx=${DB(salfsd-IN/${CALLERID(NUM)})})
exten => _8XXX,2,GotoIf($[${xx}=7]?15)
exten => _8XXX,3,Playback(agent-pass)
exten => _8XXX,4,Read(PASS)
exten => _8XXX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _8XXX,6,GotoIf($[${abc}=7]?13)
exten => _8XXX,7,AddQueueMember(salfsd-IN,SIP/${CALLERID(NUM)})
exten => _8XXX,8,Set(DB(salfsd-IN/${CALLERID(NUM)})=7)
exten => _8XXX,9,Playback(agent-loginok)
exten => _8XXX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _8XXX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _8XXX,12,Goto(salfsd-login,_8XXX,17)
exten => _8XXX,13,Playback(auth-incorrect)
exten => _8XXX,14,Goto(salfsd-login,${EXTEN},4)
exten => _8XXX,15,Playback(agent-alreadyon)
exten => _8XXX,16,Goto(salfsd-login,2,1)
exten => _8XXX,17,Hangup()

[salfsd-logout]
exten => 1,1,Background(agent-user)
exten => _8XXX,1,Playback(agent-pass)
exten => _8XXX,2,read(PASS)
exten => _8XXX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _8XXX,4,GotoIf($[${abc}=7]?11)
exten => _8XXX,5,SET(DB(salfsd-IN/${CALLERID(NUM)})=0)
exten => _8XXX,6,RemoveQueueMember(salfsd-IN,SIP/${CALLERID(NUM)})
exten => _8XXX,7,Playback(agent-loggedoff)
exten => _8XXX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _8XXX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _8XXX,10,Goto(salfsd-logout,_8XXX,13)
exten => _8XXX,11,Playback(auth-incorrect)
exten => _8XXX,12,Goto(salfsd-logout,${EXTEN},2)
exten => _8XXX,13,Hangup()



[salfsd-Team]
include=> salfsd-Queue-Login
include=> internal
include=> salfsd-Dialout
include=> dial-salfsd-queue


[internal]
;exten=> _200,1,Goto(dial-office,${EXTEN},1)
;exten=> _200,2,Hangup
exten => _2XZ,1,Goto(dial-tac-queue,81,1)
exten => _40X,1,Goto(dial-sales-queue,82,1)
exten => _45X,1,Goto(dial-billing-queue,83,1)
exten => _64X,1,Goto(dial-access-queue,84,1) ; before l2 TAC merger

;exten => _64X,1,Goto(dial-core-queue,87,1)  ; L2 TAC merger

exten => _62X,1,Goto(dial-core-queue,87,1)
exten => _26xX,1,Dial(SIP/${EXTEN},60,rt)
exten => _26xX,2,Hangup
;exten => _XXX,1,Goto(dial-office,${EXTEN},1)
;exten => _XXX,2,Hangup()





[dial-salfsd-queue]

exten => 90,1,GotoIfTime(20:00-09:00|mon-sat|*|*?salesofffsd,s,1)        ;OFF timings diversion to Call back feature
exten => 90,n,GotoIfTime(18:00-10:30|sun|*|*?salesofffsd,s,1)

;******************************************Gazetted Holidays & Ramadan Diversions*******************************************
exten => 90,n,GotoIfTime(09:00-20:00|*|08|feb?salesofffsd,s,1)          ;8th feb  diversion by Arooj/NGN
;exten => 90,n,GotoIfTime(09:00-20:00|*|01|Jul?salesofffsd,s,1)
exten => 90,n,GotoIfTime(17:00-10:59|*|01|may?salesofffsd,s,1)    	         ;25th December 2022  diversion by Talal/NGN
exten => 90,n,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                  ;Jumma IVR
exten => 90,n,Answer
;exten => 90,n,Playback(newivr/sales_queue_ivr)
exten => 90,n,Playback(EngUrdu/sales_queue_ivr)
exten => 90,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-salfsd-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 90,n,Monitor(wav,${MONITOR_FILENAME},m)
exten => 90,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 90,n,Set(_CALLER=${CALLERID(NUM)})
;exten => 90,n,Queue(salfsd-IN,tT) on request of salman bhai divert call
;exten => 90,n,Queue(SAL-IN,tT)  ; call enter in sales iSB queue as per salu bhai req queue
;exten => 90,n,Queue(salfsd-IN,tT,,,10,,macro-queuemacro)
exten => 90,n,Queue(SAL-IN,tT)
exten => 90,n,Goto(feedbacksales,82,1)
exten => 90,n,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup

[recordnumsalfsd]
;exten => s,1,Read(CBOPT,getcboptions,1,1,2)
;exten => s,2,GotoIf($[${CBOPT}=1]?10:20)
exten => 1,1,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 1,2,Read(CBNUM,beep,11,2,2)
exten => 1,3,NoOP(----CBNUM=${CBNUM}----)
exten => 1,4,Playback(thank-you-for-calling)
exten => 1,5,AGI(callbacksalfsd.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => 1,6,Hangup

[salesofffsd]
;exten => s,1,playback(normalsales)
exten => s,1,playback(ENGLISH/normalsales)
exten => s,2,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => s,3,Read(CBNUM,beep,11,2,2)
exten => s,4,NoOP(----CBNUM=${CBNUM}----)
;exten => s,5,Playback(thank-you-for-calling)
exten => s,5,Playback(ENGLISH/thank-you-for-calling)
exten => s,6,AGI(callbacksalfsd.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => s,7,Hangup

[salfsd-Dialout]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=salfsd-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=5381000)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=salfsd-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(salfsd-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _003XXXXXXXXX,n,Monitor(wav,salfsd-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-salfsd-OUT-F${CALLER}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _0Z.,1,Set(QDIALER_QUEUE=salfsd-OUT)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0Z.,n,Set(CALLERID(NUM)=5381000)
exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN:1})
exten => _0Z.,n,Set(QueueName=salfsd-OUT)
;exten => _0Z.,n,MixMonitor(salfsd-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav,salfsd-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-salfsd-OUT-F${CALLER}-T${EXTEN},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _1XXX,1,Set(QDIALER_QUEUE=salfsd-OUT)
exten => _1XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _1XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _1XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _1XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN:1})
exten => _1XXX,n,Set(QueueName=salfsd-OUT)
;exten => _XXX,n,MixMonitor(salfsd-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|salfsd-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _1xxx,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-salfsd-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _1XXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _2XXX,1,Set(QDIALER_QUEUE=salfsd-OUT)
exten => _2XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _2XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _2XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _2XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN})
exten => _2XXX,n,Set(QueueName=salfsd-OUT)
;exten => _XXX,n,MixMonitor(TX-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|TX-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _2xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-salfsd-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _2XXX,n,Goto(qm-queuedial,${EXTEN},1)



exten => _3XXX,1,Set(QDIALER_QUEUE=salfsd-OUT)
exten => _3XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _3XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _3XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _3XXX,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN})
exten => _3XXX,n,Set(QueueName=salfsd-OUT)
exten => _3xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-salfsd-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _3XXX,n,Goto(qm-queuedial,${EXTEN},1)


[dial-salesgrw-queue]
exten => 94,1,GotoIfTime(20:00-09:00|mon-sat|*|*?salesofffsd,s,1)       ;OFF timings diversion to Call back feature
exten => 94,n,GotoIfTime(18:00-10:30|sun|*|*?salesofffsd,s,1)           ;off timing of sunday updated on req of Komal/sales done by Umair

;******************************************Gazetted Holidays & Ramadan Diversions*******************************************

exten => 94,n,GotoIfTime(09:00-20:00|*|08|feb?salesofffsd,s,1)         ;8th feb  diversion
exten => 94,n,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                 ;Jumma IVR
exten => 94,n,Answer
;exten => 90,n,Playback(newivr/sales_queue_ivr)
exten => 94,n,Playback(ENGLISH/sales_queue_ivr)
exten => 94,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-salgrw-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 94,n,Monitor(wav,${MONITOR_FILENAME},m)
exten => 94,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 94,n,Set(_CALLER=${CALLERID(NUM)})
;exten => 94,n,Queue(salfsd-IN,tT) on request of salman bhai divert call
exten => 94,n,Queue(SAL-IN,tT)  ; call enter in sales iSB queue as per salu bhai req queue
exten => 94,n,Hangup

[dial-salessgd-queue]
exten => 96,1,GotoIfTime(20:00-09:00|mon-sat|*|*?salesofffsd,s,1)        ;OFF timings diversion to Call back feature
exten => 96,n,GotoIfTime(18:00-10:30|sun|*|*?salesofffsd,s,1)      ;;off timing of sunday updated on req of Komal/sales done by Umair

;******************************************Gazetted Holidays & Ramadan Diversions*******************************************

exten => 96,n,GotoIfTime(09:00-20:00|*|08|feb?salesofffsd,s,1)           ;8th feb diversion
exten => 96,n,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                 ;Jumma IVR
exten => 96,n,Answer
;exten => 96,n,Playback(newivr/sales_queue_ivr)
exten => 96,n,Playback(EngUrdu/sales_queue_ivr)
exten => 96,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-salsgd-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 96,n,Monitor(wav,${MONITOR_FILENAME},m)
exten => 96,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 96,n,Set(_CALLER=${CALLERID(NUM)})
;exten => 96,n,Queue(salsgd-IN,tT) on request of salman bhai divert call
;exten => 96,n,Queue(SAL-IN,tT)  ; call enter in sales iSB queue as per salu bhai req queue
;exten => 96,n,Hangup
;exten => 96,n,Queue(salsgd-IN,tT,,,10,,macro-queuemacro)
exten => 96,n,Queue(SAL-IN,tT)
exten => 96,n,Goto(feedbacksales,82,1)
exten => 96,n,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup





[dial-salesmtn-queue]
exten => 97,1,GotoIfTime(20:00-09:00|mon-sat|*|*?salesofffsd,s,1)        ;OFF timings diversion to Call back feature
exten => 97,n,GotoIfTime(18:00-10:30|sun|*|*?salesofffsd,s,1)            ;;off timing of sunday updated on req of Komal/sales done by Umair

;******************************************Gazetted Holidays & Ramadan Diversions*******************************************

exten => 97,n,GotoIfTime(09:00-20:00|*|08|feb?salesofffsd,s,1)           ;8th feb diversion by Arooj/NGN
exten => 97,n,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                      ;Jumma IVR
exten => 97,n,Answer
;exten => 97,n,Playback(newivr/sales_queue_ivr)
exten => 97,n,Playback(ENGLISH/sales_queue_ivr)
exten => 97,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-salmtn-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 97,n,Monitor(wav,${MONITOR_FILENAME},m)
exten => 97,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 97,n,Set(_CALLER=${CALLERID(NUM)})
;exten => 97,n,Queue(salfsd-IN,tT) on request of salman bhai divert call
exten => 97,n,Queue(SAL-IN,tT)  ; call enter in sales iSB queue as per salu bhai req queue
exten => 97,n,Hangup

[Planing-Check]
exten => _5X,1,Dial(SIP/gcc-off/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => _7X,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)
exten => _4xxx,1,Dial(SIP/grwopbx2primcc/${EXTEN},60,rtT)


exten => 788,1,Goto(Planing-Team,${EXTEN},1)
exten => 789,1,Goto(Planing-Team,${EXTEN},1)

exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)


exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)
exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)
exten => 85,1,Goto(dial-ntl-queue,${EXTEN},1)
exten => 86,1,Goto(dial-system-queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,${EXTEN},1) ; Before L2 TAC merger

;exten => 84,1,Goto(dial-core-queue,87,1)  ; L2 TAC merger

exten => _X.,1,Goto(Planing-Team,${EXTEN},1)

[Planing-Queue-Login]
exten => 788,1,Goto(Planing-login,2,1)
exten => 789,1,Goto(Planing-logout,1,1)


[Planing-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _9XXX,1,Set(xx=${DB(Planing-IN/${CALLERID(NUM)})})
exten => _9XXX,2,GotoIf($[${xx}=7]?15)
exten => _9XXX,3,Playback(agent-pass)
exten => _9XXX,4,Read(PASS)
exten => _9XXX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _9XXX,6,GotoIf($[${abc}=7]?13)
exten => _9XXX,7,AddQueueMember(Planing-IN,SIP/${CALLERID(NUM)})
exten => _9XXX,8,Set(DB(Planing-IN/${CALLERID(NUM)})=7)
exten => _9XXX,9,Playback(agent-loginok)
exten => _9XXX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _9XXX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _9XXX,12,Goto(Planing-login,_9XXX,17)
exten => _9XXX,13,Playback(auth-incorrect)
exten => _9XXX,14,Goto(Planing-login,${EXTEN},4)
exten => _9XXX,15,Playback(agent-alreadyon)
exten => _9XXX,16,Goto(Planing-login,2,1)
exten => _9XXX,17,Hangup()

[Planing-logout]
exten => 1,1,Background(agent-user)
exten => _9XXX,1,Playback(agent-pass)
exten => _9XXX,2,read(PASS)
exten => _9XXX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _9XXX,4,GotoIf($[${abc}=7]?11)
exten => _9XXX,5,SET(DB(Planing-IN/${CALLERID(NUM)})=0)
exten => _9XXX,6,RemoveQueueMember(Planing-IN,SIP/${CALLERID(NUM)})
exten => _9XXX,7,Playback(agent-loggedoff)
exten => _9XXX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _9XXX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _9XXX,10,Goto(Planing-logout,_9XXX,13)
exten => _9XXX,11,Playback(auth-incorrect)
exten => _9XXX,12,Goto(Planing-logout,${EXTEN},2)
exten => _9XXX,13,Hangup()


[Planing-Team]
include=> Planing-Queue-Login
include=> internal
include=> Planing-Dialout
include=> dial-planing-queue

[internal]
;exten=> _200,1,Goto(dial-office,${EXTEN},1)
;exten=> _200,2,Hangup
exten => _2XZ,1,Goto(dial-tac-queue,81,1)
exten => _40X,1,Goto(dial-sales-queue,82,1)
exten => _45X,1,Goto(dial-billing-queue,83,1)
exten => _64X,1,Goto(dial-access-queue,84,1) ; before L2 TAC merger


;exten => _64X,1,Goto(dial-core-queue,87,1)  ;  L2 TAC merger

exten => _62X,1,Goto(dial-system-queue,86,1)
;exten => _XXX,1,Goto(dial-office,${EXTEN},1)
;exten => _XXX,2,Hangup()

[dial-planing-queue]
exten => 91,1,GotoIfTime(*|sun|*|*?dial-tac-queue,81,2)         ;  sunday diversion
exten => 91,2,GotoIfTime(17:30-09:00|*|*|*?TX,s,1)                  ;Normal Timings
exten => 91,3,GotoIfTime(09:00-17:30|fri|29|sep?TX,s,1) ; Rabi Ul awal
;exten => 89,3,GotoIfTime(*|tue-fri|05-08|jul?TX,s,1)     ;eid days diversion
exten => 91,4,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)              ;jumma
exten => 91,5,Answer
;exten => 84,2,Set(MONITOR_FILENAME=ACC-IN-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}})
exten => 91,6,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-Planing-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 91,7,Monitor(wav,${MONITOR_FILENAME},m)
;exten => 89,8,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
;exten => 89,9,Set(_CALLER=${CALLERID(NUM)})
exten => 91,8,Queue(Planing-IN,tT)
;exten => 89,11,Goto(callbacktx,s,1)
exten => 91,9,Hangup()


[Planing-Dialout]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=Planing-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=8310000)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=Planing-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(TX-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _003XXXXXXXXX,n,Monitor(wav,TX-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-Planing-OUT-F${CALLER}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _0Z.,1,Set(QDIALER_QUEUE=Planing-OUT)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0Z.,n,Set(CALLERID(NUM)=8310000)
exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _0Z.,n,Set(QueueName=Planing-OUT)
;exten => _0Z.,n,MixMonitor(TX-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav,TX-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-Planing-OUT-F${CALLER}-T${EXTEN},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _XXX,1,Set(QDIALER_QUEUE=Planing-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN})
exten => _XXX,n,Set(QueueName=Planing-OUT)
;exten => _XXX,n,MixMonitor(TX-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|TX-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _xxx,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-Planing-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)

;below lines are test lines for fsd opbx testing

exten => _XXXX,1,Set(QDIALER_QUEUE=Planing-OUT)
exten => _XXXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-opbx_bck/${EXTEN})
exten => _XXXX,n,Set(QueueName=Planing-OUT)
;exten => _XXX,n,MixMonitor(TX-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|TX-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _xxxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-Planing-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXXX,n,Goto(qm-queuedial,${EXTEN},1)



[wajahat_test]

;exten => _999,1,Set(TIMEOUT(absolute)=15)
;exten => _999,1,Dial(SIP/NTL-CC-1/041111114444,30,T)
exten => _999,1,Goto(dial-tac-queue,81,1)
;exten => 999,3,GotoIf($[${DIALSTATUS}=ANSWERED]?:100)
;exten => _999,2,NoOp(${DIALSTATUS})
exten => _999,2,GotoIf($[${DIALSTATUS}!=ANSWERED]?100:3)
exten => _999,3,NoOP(${DIALSTATUS})
exten => _999,4,Hangup()

;exten => 999,n,Goto(s-${DIALSTATUS},1)

;exten => s-Answer,1,AGI(fsd_call.agi)
;exten => s-Answer,2,Hangup

;exten => s-BUSY,1,AGI(fsd_call_fail.agi)
;exten => s-BUSY,2,Hangup

;exten => s-CHANUNAVAIL,1,AGI(fsd_call_fail.agi)
;exten => s-CHANUNAVAIL,2,Hangup

;exten => s-CONGESTION,1,AGI(fsd_call_fail.agi)
;exten => s-CONGESTION,2,Hangup

;exten => s-CANCEL,1,AGI(fsd_call_fail.agi)
;exten => s-CANCEL,2,Hangup

;exten => s-NOANSWER,1,AGI(fsd_call_fail.agi)
;exten => s-NOANSWER,2,Hangup








;exten => 999,3,Hangup

;exten => 999,4,AGI(fsd_call.agi)
;exten => 999,5,Hangup
exten => 999,100,AGI(fsd_call_fail.agi)
exten => 999,101,Hangup















[TestNewCC]
exten=> _0X.,1,Set(CALLERID(num)=8310708)
exten=> _0X.,2,Dial(SIP/NTL-CC-1/${EXTEN:1},60,t)
exten=> _0X.,3,Hangup





;;;;;;;;;;;;;;;;;SALES PWR TEST;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;




[dial-salespwr-queue]

exten => 92,1,GotoIfTime(20:00-09:00|mon-sat|*|*?salesoffpwr,s,1)       ;OFF timings diversion to Call back feature
exten => 92,n,GotoIfTime(18:00-10:30|sun|*|*?salesoffpwr,s,1)   	;;off timing of sunday updated on req of Komal/sales done by Umair

;***************************************************Gazetted Holidays & Ramadan Diversions***************************************

exten => 92,n,GotoIfTime(09:00-20:00|*|08|feb?salesoffpwr,s,1)         ;8th feb  diversion by umair/NGN
exten => 92,n,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                 ;Jumma IVR
exten => 92,n,Answer
;exten => 92,n,Playback(newivr/sales_queue_ivr)
exten => 92,n,Playback(EngUrdu/sales_queue_ivr)
exten => 92,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-salpwr-IN-F${CALLERID(NUM)}-T${EXTEN}) ;rec name
exten => 92,n,Monitor(wav,${MONITOR_FILENAME},m) ; .wav generated
exten => 92,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 92,n,Set(_CALLER=${CALLERID(NUM)})
;exten => 92,n,Queue(salpwr-IN,tT)  ; call enter in sales queue commented on salu bhai req
;exten => 92,n,Queue(SAL-IN,tT)  ; call enter in sales queue as per salu bhai
;exten => 92,n,Queue(salpwr-IN,tT,,,10,,macro-queuemacro)
exten => 92,n,Queue(SAL-IN,tT)
exten => 92,n,Goto(feedbacksales,82,1)
exten => 92,n,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup


[salesoffpwr]
;exten => s,1,playback(normalsales)
exten => s,1,playback(ENGLISH/normalsales)
exten => s,2,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => s,3,Read(CBNUM,beep,11,2,2)
exten => s,4,NoOP(----CBNUM=${CBNUM}----)
;exten => s,5,Playback(thank-you-for-calling)
exten => s,5,Playback(ENGLISH/thank-you-for-calling)
exten => s,6,AGI(callbackpwr.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => s,7,Hangup

[pwrtest]
exten => 92,1,GotoIfTime(17:30-19:00|*|18-21|may?salesonpwr,s,1)  ;on req of Komal by Zaeem
exten => 92,n,GotoIfTime(19:00-09:00|*|24-25|may?salesoffpwr,s,1)  ;on req of Komal by Zaeem
exten => 92,n,GotoIfTime(17:30-09:00|sat|22|may?salesoffpwr,s,1)   ;on req of Komal by Zaeem
exten => 92,n,GotoIfTime(17:30-09:00|*|*|*?salesoffpwr,s,1)     ;OFF timings diversion to Call back feature

;***************************************************Gazetted Holidays & Ramadan Diversions***************************************

exten => 92,n,GotoIfTime(*|sun|*|*?salesoffpwr,s,1)                                  ;Sunday Diversion to TAC
exten => 92,n,GotoIfTime(09:00-17:30|sat-sun|01-02|aug?salesoffpwr,s,1)
exten => 92,n,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                           ;Jumma IVR
exten => 92,n,Answer
;exten => 92,n,Playback(newivr/sales_queue_ivr)
exten => 92,n,Playback(ENGLISH/sales_queue_ivr)
exten => 92,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-salpwr-IN-F${CALLERID(NUM)}-T${EXTEN}) ;rec name
exten => 92,n,Monitor(wav,${MONITOR_FILENAME},m) ; .wav generated
exten => 92,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 92,n,Set(_CALLER=${CALLERID(NUM)})
;exten => 92,n,Queue(salpwr-IN,tT)  ; call enter in sales queue commented on salu bhai req
exten => 92,n,Queue(SAL-IN,tT)  ; call enter in sales queue as per salu bhai
exten => 92,n,Hangup

[salesonpwr]
exten => s,1,Answer
;exten => 92,n,Playback(newivr/sales_queue_ivr)
exten => s,2,Playback(ENGLISH/sales_queue_ivr)
exten => s,3,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-salpwr-IN-F${CALLERID(NUM)}-T${EXTEN}) ;rec name
exten => s,4,Monitor(wav,${MONITOR_FILENAME},m) ; .wav generated
exten => s,5,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => s,6,Set(_CALLER=${CALLERID(NUM)})
;exten => s,7,Queue(salpwr-IN,tT)  ; call enter in sales queue commented on salu bhai req
exten => s,7,Queue(SAL-IN,tT)  ; call enter in sales queue as per salu bhai
exten => s,8,Hangup


[recordnumsalpwr]
;exten => s,1,Read(CBOPT,getcboptions,1,1,2)
;exten => s,2,GotoIf($[${CBOPT}=1]?10:20)
exten => 1,1,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 1,2,Read(CBNUM,beep,11,2,2)
exten => 1,3,NoOP(----CBNUM=${CBNUM}----)
exten => 1,4,AGI(callback.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => 1,5,Playback(thank-you-for-calling)
exten => 1,6,AGI(callbackpwr.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => 1,7,Hangup

[recordnumsalsgd]
;exten => s,1,Read(CBOPT,getcboptions,1,1,2)
;exten => s,2,GotoIf($[${CBOPT}=1]?10:20)
exten => 1,1,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 1,2,Read(CBNUM,beep,11,2,2)
exten => 1,3,NoOP(----CBNUM=${CBNUM}----)
exten => 1,4,AGI(callback.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => 1,5,Playback(thank-you-for-calling)
exten => 1,6,AGI(callbacksal.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => 1,7,Hangup



[Salespwr-Check]

exten => 788,1,Goto(salpwr-Team,${EXTEN},1)
exten => 789,1,Goto(salpwr-Team,${EXTEN},1)

exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)


exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)
exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,84,1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)
exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)


exten => _X.,1,Goto(salpwr-Team,${EXTEN},1)


[salpwr-Team]
include=> salpwr-Queue-Login
include=> salpwr-internal
include=> internal
include=> salpwr-Dialout
include=> dial-salespwr-queue


[salpwr-Queue-Login]
exten => 788,1,Goto(salpwr-login,2,1)
exten => 789,1,Goto(salpwr-logout,1,1)



[salpwr-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _9XXX,1,Set(xx=${DB(salpwr-IN/${CALLERID(NUM)})})
;exten => _9XXX,2,GotoIf($["${xx}"="7"]?15)
exten => _9XXX,2,GotoIf($[${xx}=7]?15)
exten => _9XXX,3,Playback(agent-pass)
exten => _9XXX,4,Read(PASS)
exten => _9XXX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _9XXX,6,GotoIf($[${abc}=7]?13)
exten => _9XXX,7,AddQueueMember(salpwr-IN,SIP/${CALLERID(NUM)})
exten => _9XXX,8,Set(DB(salpwr-IN/${CALLERID(NUM)})=7)
exten => _9XXX,9,Playback(agent-loginok)
exten => _9XXX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _9XXX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _9XXX,12,Goto(salpwr-login,_9XXX,17)
exten => _9XXX,13,Playback(auth-incorrect)
exten => _9XXX,14,Goto(salpwr-login,${EXTEN},4)
exten => _9XXX,15,Playback(agent-alreadyon)
exten => _9XXX,16,Goto(salpwr-login,2,1)
exten => _9XXX,17,Hangup()


[salpwr-logout]
exten => 1,1,Background(agent-user)
exten => _9XXX,1,Playback(agent-pass)
exten => _9XXX,2,read(PASS)
exten => _9XXX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
;exten => _9XXX,4,GotoIf($["${abc}"="7"]?11)
exten => _9XXX,4,GotoIf($[${abc}=7]?11)
exten => _9XXX,5,SET(DB(salpwr-IN/${CALLERID(NUM)})=0)
exten => _9XXX,6,RemoveQueueMember(salpwr-IN,SIP/${CALLERID(NUM)})
exten => _9XXX,7,Playback(agent-loggedoff)
exten => _9XXX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _9XXX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _9XXX,10,Goto(salpwr-logout,_9XXX,13)
exten => _9XXX,11,Playback(auth-incorrect)
exten => _9XXX,12,Goto(salpwr-logout,${EXTEN},2)
exten => _9XXX,13,Hangup()



[salpwr-internal]

;exten => _31XX,1,Dial(SIP/${EXTEN},60,t)
exten => _31XX,1,Dial(SIP/pwropbx2primcc/${EXTEN})
exten => _31XX,2,Hangup



[salpwr-Dialout]
exten => _0X.,1,Set(QDIALER_QUEUE=salpwr-OUT)
exten => _0X.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0X.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0X.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0X.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0X.,n,Set(CALLERID(NUM)=7243000)
exten => _0X.,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN:1})
exten => _0X.,n,Set(QueueName=salpwr-OUT)
exten => _0X.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-salpwr-OUT-F${CALLER}-T${EXTEN},m)
exten => _0X.,n,Goto(qm-queuedial,${EXTEN},1)


exten => _1XXX,1,Set(QDIALER_QUEUE=salpwr-OUT)
exten => _1XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _1XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _1XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _1XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN:1})
exten => _1XXX,n,Set(QueueName=salpwr-OUT)
exten => _1xxx,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-salpwr-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _1XXX,n,Goto(qm-queuedial,${EXTEN},1)


exten => _2XXX,1,Set(QDIALER_QUEUE=salpwr-OUT)
exten => _2XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _2XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _2XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _2XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN})
exten => _2XXX,n,Set(QueueName=salpwr-OUT)
exten => _2xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-salpwr-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _2XXX,n,Goto(qm-queuedial,${EXTEN},1)


exten => _3XXX,1,Set(QDIALER_QUEUE=salpwr-OUT)
exten => _3XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _3XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _3XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _3XXX,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN})
exten => _3XXX,n,Set(QueueName=salpwr-OUT)
exten => _3xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-salpwr-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _3XXX,n,Goto(qm-queuedial,${EXTEN},1)


[ttstest]
exten => 888,1,Answer
exten => 888,n,saynumber(1000,f)
exten => 888,n,Hangup()







[dial-billing-queue]

exten => 83,1,NoOp(${CALLERID(num)})
exten => 83,2,Set(CURLOPT(conntimeout)=3)
exten => 83,3,Set(CURLOPT(httptimeout)=3)
exten => 83,4,Set(CURL_RESULT11=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/bill_ivr.php?caller_id=${CALLERID(num)})})

;----NEW-API----
;exten => 83,4,Set(CURL_RESULT11=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id=${CALLERID(num)})})

exten => 83,5,GotoIf($["${CURL_RESULT11}" != ""] ?6:400)
exten => 83,6,GotoIf($["${CURL_RESULT11}" = "999999999999"]?7:600)

exten => 83,400,Set(CURL_RESULT11=999999999999)
exten => 83,401,Goto(dial-billing-queue,83,6)

;exten => 83,600,Playback(YourBillIs)
;exten => 83,600,Playback(ENGLISH/YourBillls)
exten => 83,600,Playback(EngUrdu/YourBillls)
exten => 83,601,Answer
exten => 83,602,SayNumber(${CURL_RESULT11},f)
exten => 83,603,Wait(1)
exten => 83,604,Goto(BillPay,s,1)

exten => 83,7,NoOp(${CALLERID(num)})
exten => 83,8,Set(CURLOPT(conntimeout)=3)
exten => 83,9,Set(CURLOPT(httptimeout)=3)
exten => 83,10,Set(CURL_RESULT1=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate.php?caller_id=${CALLERID(num)})})

;---NEW-API---
;exten => 83,10,Set(CURL_RESULT1=${CURL(https://multiivr.nayatel.com/multiIVRapi?caller_id=${CALLERID(num)})})


exten => 83,11,GotoIf($["${CURL_RESULT1}" != ""] ?12:80)



exten => 83,80,Set(CURL_RESULT1=0)
exten => 83,81,Goto(dial-billing-queue,83,12)

exten => 83,12,GotoIf(${CURL_RESULT1} = 1?90:13)
exten => 83,13,GotoIfTime(*|sun|*|*?billoff,s,1)                            ;Sunday Diversion to TAC
exten => 83,14,GotoIfTime(09:00-20:00|*|08|feb?billoff,s,1)                 ;8th feb  Day diversion
exten => 83,15,GotoIfTime(09:00-20:00|*|01|jul?billoff,s,1)	            ;eid adha 2023 diversion by AJ
exten => 83,16,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                    ;Jumma IVR diversion
exten => 83,17,GotoIfTime(20:00-09:00|sat|*|*?billoff,s,1)                  ;Saturday Timings updated 28/08/2021 email saad by zaeem
;exten => 83,17,GotoIfTime(15:30-09:00|sat|*|*?billoff,s,1)                 ;Saturday Ramazan 2022 Timings by Ahmed/NGN
;exten => 83,18,GotoIfTime(17:30-09:00|mon-fri|*|*?billoff,s,1)             ;Ramazan 2022 Diversion by Ahmed/NGN
exten => 83,18,GotoIfTime(20:00-09:00|mon-fri|*|*?billoff,s,1)   ;OFF Timingto billoff IVR updated as per saad/malik on 10/08/19 by AB/NGN
exten => 83,19,Set(ivr=${DB(ivr/bill)})
exten => 83,20,GotoIf($[${ivr}=0]?22:21)
exten => 83,21,Playback(problem-ivr/ntl/${ivr})
exten => 83,22,Answer

;exten => 83,n,Playback(problem-ivr/ntl/53) ;On 02-09-2021 Req of Saad Malik by Zaeem
 
;exten => 83,n,Playback(ENGLISH/bill_queue_ivr)  ;IVR is not availabl
exten => 83,n,Playback(EngUrdu/bill_queue_ivr)   ;Eng Urdu IVR by Zaeem
exten => 83,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-BILLING-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 83,n,Monitor(wav,${MONITOR_FILENAME},m)
exten => 83,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 83,n,Set(_CALLER=${CALLERID(NUM)})
;exten => 83,n,Playback(problem-ivr/ntl/54)
;exten => 83,n,Queue(BIL-IN,tT)
exten => 83,n,Queue(BIL-IN,tTc,,,,,,macro-queuemacro)
exten => 83,n,Goto(feedbackbilling,83,1)
exten => 83,n,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup

;exten => 83,90,Background(availautobonus) ; avail autobous press 1, else for billing press 2
;exten => 83,90,Background(ENGLISH/availautobonus) ;IVR is not available
exten => 83,90,Background(EngUrdu/availautobonus)  ;Eng Urdu IVR by Zaeem

exten => 1,1,Goto(83,100)
exten => 11,1,Goto(83,100)
exten => 12,1,Goto(83,100)
exten => 111,1,Goto(83,100)
exten => 1111,1,Goto(83,100)

exten => 2,1,Goto(dial-billing-queue,83,13)
exten => 21,1,Goto(dial-billing-queue,83,13)
exten => 22,1,Goto(dial-billing-queue,83,13)
exten => 23,1,Goto(dial-billing-queue,83,13)
exten => 222,1,Goto(dial-billing-queue,83,13)
exten => 2222,1,Goto(dial-billing-queue,83,13)

exten => X.,1,Goto(dial-billing-queue,83,13)


exten => 83,100,NoOp(${CALLERID(num)})
exten => 83,101,Set(CURLOPT(conntimeout)=3)
exten => 83,102,Set(CURLOPT(httptimeout)=3)
exten => 83,103,Set(CURL_RESULT2=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/multiIVR.php?caller_id=${CALLERID(num)}&avail=true)})

exten => 83,103,Set(CURL_RESULT2=${CURL(https://crminternal.nayatel.com/views/crmViews/nayatelCrm/services_files/auto_bonus_validate.php?caller_id=${CALLERID(num)}&avail=true)})

;---NEW-API---
;exten => 83,103,Set(CURL_RESULT2=${https://multiivr.nayatel.com/multiIVRapi?caller_id=${CALLERID(num)}&avail=true)})


exten => 83,104,GotoIf($["${CURL_RESULT2}" != ""] ?105:700)


exten => 83,700,Set(CURL_RESULT2=0)
exten => 83,701,Goto(dial-billing-queue,83,105)

exten => 83,105,GotoIf(${CURL_RESULT2} = 1 ?200:300)

;exten => 83,200,Playback(autobonussuccessfull) ; autobonus success IVR
;exten => 83,200,Playback(ENGLISH/autobonussuccessfinalivr)
;exten => 83,200,Playback(ENGLISH/autobonussuccess1)  ;changed on req of Salman Bhai 26/05/21
exten => 83,200,Playback(EngUrdu/autobonussuccess1)   ;Eng URdu IVR by Zaeem
exten => 83,201,Hangup

;exten => 83,300,Playback(autobonusfailed) ; autobonus failed IVR
;exten => 83,300,Playback(ENGLISH/autobonusfailed)   ;IVR is not available
exten => 83,300,Playback(EngUrdu/autobonusfailed)    ;Eng Urdu IVR by Zaeem
exten => 83,301,Hangup




[BillPay]

exten => s,1,Set(TIMEOUT(response)=10)
;exten => s,2,Background(Press1tobill2forMainmenu)
;exten => s,2,Background(Finalypress1)	; updated by AB as per request of Aamil Bhai 09/04/2019
exten => s,2,Background(ENGLISH/Finalypress1) 

exten => 1,1,Goto(dial-billing-queue,83,7)
exten => 12,1,Goto(dial-billing-queue,83,7)
exten => 11,1,Goto(dial-billing-queue,83,7)
exten => 111,1,Goto(dial-billing-queue,83,7)
exten => 1111,1,Goto(dial-billing-queue,83,7)

exten => 2,1,Goto(Mainmenu,s,3)
exten => 21,1,Goto(Mainmenu,s,3)
exten => 22,1,Goto(Mainmenu,s,3)
exten => 222,1,Goto(Mainmenu,s,3)
exten => 2222,1,Goto(Mainmenu,s,3)

exten => X.,1,Goto(dial-billing-queue,83,7)

exten => t,1,Goto(BillPay,s,1)

[dial-BD-queue]
;exten => 93,1,GotoIfTime(15:30-09:00|sat|*|*?salesbdoff,s,1)                ;Ramzan 2109 diversion for Saturday by Ateeq/NGN
exten => 93,1,GotoIfTime(17:30-09:00|sat|*|*?salesbdoff,s,1)  ;Off timings diversion for Saturday only
exten => 93,n,GotoIfTime(09:00-17:30|*|28-30|june?salesbdoff,s,1)             ;eid 2023 diversion by AJ
exten => 93,n,GotoIfTime(09:00-17:30|*|01|july?salesbdoff,s,1)            ;eid 2023 by Talal/NGN
exten => 93,n,GotoIfTime(09:00-17:30|fri|31|jul?salesbdoff,s,1)		    
exten => 93,n,GotoIfTime(09:00-17:30|wed|05|feb?salesbdoff,s,1)             ;Muharram 2019 by Mehmood
;exten => 93,n,GotoIfTime(15:30-09:00|*|*|*?salesbdoff,s,1)                  ;Ramzan 2022 diversion by Talal/NGN on request of Jahangir Sb
exten => 93,n,GotoIfTime(17:30-09:00|*|*|*?salesbdoff,s,1)                  ;Off timing IVR
exten => 93,n,GotoIfTime(*|sun|*|*?salesbdoff,s,1)                                   ;Sunday Diversion to TAC
exten => 93,n,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)                      ;Jumma IVR
exten => 93,n,Answer
;exten => 93,n,Playback(newivr/sales_queue_ivr)
exten => 93,n,Playback(ENGLISH/sales_queue_ivr)
exten => 93,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-BD-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 93,n,Monitor(wav,${MONITOR_FILENAME},m)
exten => 93,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 93,n,Set(_CALLER=${CALLERID(NUM)})
exten => 93,n,Queue(BD-IN,tT)
exten => 93,n,Hangup

[salesbdoff]
;exten => s,1,playback(normalsales)
exten => s,1,playback(ENGLISH/normalsales)
exten => s,2,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => s,3,Read(CBNUM,beep,11,2,2)
exten => s,4,NoOP(----CBNUM=${CBNUM}----)
exten => s,5,Playback(ENGLISH/thank-you-for-calling)
exten => s,6,AGI(callbackbd.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => s,7,Hangup

[recordnumbd]
;exten => s,1,Read(CBOPT,getcboptions,1,1,2)
;exten => s,2,GotoIf($[${CBOPT}=1]?10:20)
exten => 1,1,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 1,2,Read(CBNUM,beep,11,2,2)
exten => 1,3,NoOP(----CBNUM=${CBNUM}----)
exten => 1,4,AGI(callback.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => 1,5,Playback(ENGLISH/thank-you-for-calling)
exten => 1,6,AGI(callbackbd.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => 1,7,Hangup

[BD-Check]
exten => _5X,1,Dial(SIP/gcc-off/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => _7X,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)
exten => _4xxx,1,Dial(SIP/grwopbx2primcc/${EXTEN},60,rtT)
exten => _8xxx,1,Dial(SIP/NTL-CC-OFF/${EXTEN},60,trT)

exten => 788,1,Goto(BD-Team,${EXTEN},1)
exten => 789,1,Goto(BD-Team,${EXTEN},1)

exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)


exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)
exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,84,1)    ;   Before L2 TAC merger

exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)
exten => 92,1,Goto(dial-salespwr-queue,${EXTEN},1)

exten => _X.,1,Goto(BD-Team,${EXTEN},1)



[BD-Team]
include=> BD-Queue-Login
include=> BD-internal
include=> internal
include=> dial-BD-queue
include=> BD-Dialout

[BD-Queue-Login]
exten => 788,1,Goto(BD-login,2,1)
exten => 789,1,Goto(BD-logout,1,1)

[BD-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _85XX,1,Set(xx=${DB(BD-IN/${CALLERID(NUM)})})
exten => _85XX,2,GotoIf($[${xx}=7]?15)
exten => _85XX,3,Playback(agent-pass)
exten => _85XX,4,Read(PASS)
exten => _85XX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _85XX,6,GotoIf($[${abc}=7]?13)
exten => _85XX,7,AddQueueMember(BD-IN,SIP/${CALLERID(NUM)})
exten => _85XX,8,Set(DB(BD-IN/${CALLERID(NUM)})=7)
exten => _85XX,9,Playback(agent-loginok)
exten => _85XX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _85XX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _85XX,12,Goto(BD-login,_85XX,17)
exten => _85XX,13,Playback(auth-incorrect)
exten => _85XX,14,Goto(BD-login,${EXTEN},4)
exten => _85XX,15,Playback(agent-alreadyon)
exten => _85XX,16,Goto(BD-login,2,1)
exten => _85XX,17,Hangup()





[BD-logout]
exten => 1,1,Background(agent-user)
exten => _85XX,1,Playback(agent-pass)
exten => _85XX,2,read(PASS)
exten => _85XX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _85XX,4,GotoIf($[${abc}=7]?11)
exten => _85XX,5,SET(DB(BD-IN/${CALLERID(NUM)})=0)
exten => _85XX,6,RemoveQueueMember(BD-IN,SIP/${CALLERID(NUM)})
exten => _85XX,7,Playback(agent-loggedoff)
exten => _85XX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _85XX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _85XX,10,Goto(BD-logout,_9XXX,13)
exten => _85XX,11,Playback(auth-incorrect)
exten => _85XX,12,Goto(BD-logout,${EXTEN},2)
exten => _85XX,13,Hangup()

[BD-internal]
exten => _25XX,1,Dial(SIP/NTL-CC-FSD/${EXTEN})
exten => _25XX,2,Hangup

[BD-Dialout]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=BD-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=5381002)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=BD-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(BD-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _003XXXXXXXXX,n,Monitor(wav,BD-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BD-OUT-F${CALLER}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)


exten => _0X.,1,Set(QDIALER_QUEUE=BD-OUT)
exten => _0X.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0X.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0X.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0X.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0X.,n,Set(CALLERID(NUM)=5381002)
exten => _0X.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN:1})
exten => _0X.,n,Set(QueueName=BD-OUT)
exten => _0X.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BD-OUT-F${CALLER}-T${EXTEN},m)
exten => _0X.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _1XXX,1,Set(QDIALER_QUEUE=BD-OUT)
exten => _1XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _1XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _1XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _1XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN:1})
exten => _1XXX,n,Set(QueueName=BD-OUT)
exten => _1xxx,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BD-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _1XXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _2XXX,1,Set(QDIALER_QUEUE=BD-OUT)
exten => _2XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _2XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _2XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _2XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN})
exten => _2XXX,n,Set(QueueName=BD-OUT)
exten => _2xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BD-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _2XXX,n,Goto(qm-queuedial,${EXTEN},1)


exten => _3XXX,1,Set(QDIALER_QUEUE=BD-OUT)
exten => _3XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _3XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _3XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _3XXX,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN})
exten => _3XXX,n,Set(QueueName=BD-OUT)
exten => _3xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-BD-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _3XXX,n,Goto(qm-queuedial,${EXTEN},1)









[SBC-DialOut]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=8310000)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/PrimCC-ATCA/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=TAC-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _003XXXXXXXXX,n,Monitor(wav,TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLER}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)



exten => _0Z.,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0Z.,n,Set(CALLERID(NUM)=8310000)
exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/PrimCC-ATCA/${EXTEN:1})
exten => _0Z.,n,Set(QueueName=TAC-OUT)
;exten => _0Z.,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav,TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLER}-T${EXTEN},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _XXX,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN})
exten => _XXX,n,Set(QueueName=TAC-OUT)
;exten => _XXX,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav|TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _xxx,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)

;below lines are test lines for fsd opbx testing




exten => _2XXX,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _2XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _2XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _2XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _2XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN})
exten => _2XXX,n,Set(QueueName=TAC-OUT)
;exten => _2XXX,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _2XXX,n,Monitor(wav|TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _2xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _2XXX,n,Goto(qm-queuedial,${EXTEN},1)



exten => _3XXX,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _3XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _3XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _3XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _3XXX,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN})
exten => _3XXX,n,Set(QueueName=TAC-OUT)
exten => _3xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _3XXX,n,Goto(qm-queuedial,${EXTEN},1)




exten => _0041.,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _0041.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0041.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0041.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0041.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0041.,n,Set(CALLERID(NUM)=8310000)
exten => _0041.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN:1})
exten => _0041.,n,Set(QueueName=TAC-OUT)
;exten => _0041.,n,MixMonitor(TAC-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0041.,n,Monitor(wav,TAC-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0041.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLER}-T${EXTEN},m)
exten => _0041.,n,Goto(qm-queuedial,${EXTEN},1)



exten => _0091.,1,Set(QDIALER_QUEUE=TAC-OUT)
exten => _0091.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0091.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0091.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0091.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0091.,n,Set(CALLERID(NUM)=8310000)
exten => _0091.,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN:1})
exten => _0091.,n,Set(QueueName=TAC-OUT)
exten => _0091.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLER}-T${EXTEN},m)
exten => _0091.,n,Goto(qm-queuedial,${EXTEN},1)



[Test-ITT]
exten => _0X.,1,Set(QDIALER_QUEUE=salfsd-OUT)
exten => _0X.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0X.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0X.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0X.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0X.,n,Set(CALLERID(NUM)=5381000)
exten => _0X.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN:1})
exten => _0X.,n,Set(QueueName=salfsd-OUT)
exten => _0X.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-salfsd-OUT-F${CALLER}-T${EXTEN},m)
exten => _0X.,n,Goto(qm-queuedial,${EXTEN},1)






;;;;;;;;;;;;;;;;;;;;;;;;;;;settings for auto-answer/pause of TAC;;;;;;;;;;;;;;;;;;;;;;;;;;


[recordl2test]
;exten => s,1,Read(CBOPT,getcboptions,1,1,2)
;exten => s,2,GotoIf($[${CBOPT}=1]?10:20)
exten => 1,1,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 1,2,Read(CBNUM,beep,11,2,2)
exten => 1,3,NoOP(----CBNUM=${CBNUM}----)
exten => 1,4,AGI(callback.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => 1,5,Playback(thank-you-for-calling)
exten => 1,6,AGI(callbackl2test.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => 1,7,Hangup


[L2TEST-Team]
include=> L2TEST-Queue-Login
include=> L2TEST-internal
include=> internal
include=> L2TEST-Dialout
include=> dial-L2TEST-queue


[L2TEST-Queue-Login]
exten => 788,1,Goto(L2TEST-login,2,1)
exten => 789,1,Goto(L2TEST-logout,1,1)


[L2TEST-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _86XX,1,Set(xx=${DB(L2TEST-IN/${CALLERID(NUM)})})
;exten => _86XX,2,GotoIf($["${xx}"="7"]?15)
exten => _86XX,2,GotoIf($[${xx}=7]?15)
exten => _86XX,3,Playback(agent-pass)
exten => _86XX,4,Read(PASS)
exten => _86XX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _86XX,6,GotoIf($[${abc}=7]?13)
exten => _86XX,7,AddQueueMember(L2TEST-IN,SIP/${CALLERID(NUM)})
exten => _86XX,8,Set(DB(L2TEST-IN/${CALLERID(NUM)})=7)
exten => _86XX,9,Playback(agent-loginok)
exten => _86XX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _86XX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _86XX,12,Goto(L2TEST-login,_86XX,17)
exten => _86XX,13,Playback(auth-incorrect)
exten => _86XX,14,Goto(L2TEST-login,${EXTEN},4)
exten => _86XX,15,Playback(agent-alreadyon)
exten => _86XX,16,Goto(L2TEST-login,2,1)
exten => _86XX,17,Hangup()

[L2TEST-logout]
exten => 1,1,Background(agent-user)
exten => _86XX,1,Playback(agent-pass)
exten => _86XX,2,read(PASS)
exten => _86XX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
;exten => _86XX,4,GotoIf($["${abc}"="7"]?11)
exten => _86XX,4,GotoIf($[${abc}=7]?11)
exten => _86XX,5,SET(DB(L2TEST-IN/${CALLERID(NUM)})=0)
exten => _86XX,6,RemoveQueueMember(L2TEST-IN,SIP/${CALLERID(NUM)})
exten => _86XX,7,Playback(agent-loggedoff)
exten => _86XX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _86XX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _86XX,10,Goto(L2TEST-logout,_86XX,13)
exten => _86XX,11,Playback(auth-incorrect)
exten => _86XX,12,Goto(L2TEST-logout,${EXTEN},2)
exten => _86XX,13,Hangup()


[L2TEST-internal]

exten => _2XX,1,Dial(SIP/${EXTEN},60,t)
exten => _2XX,2,Hangup




[L2TEST-Dialout]

exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=L2TEST-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=8310000)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=L2TEST-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(L2TEST-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-L2TEST-OUT-F${CALLER}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)


exten => _XXX,1,Set(QDIALER_QUEUE=L2TEST-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN})
exten => _XXX,n,Set(QueueName=L2TEST-OUT)
exten => _xxx,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-L2TEST-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)


exten => _2XXX,1,Set(QDIALER_QUEUE=L2TEST-OUT)
exten => _2XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _2XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _2XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _2XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-FSD/${EXTEN})
exten => _2XXX,n,Set(QueueName=L2TEST-OUT)
exten => _2xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-L2TEST-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _2XXX,n,Goto(qm-queuedial,${EXTEN},1)



exten => _3XXX,1,Set(QDIALER_QUEUE=L2TEST-OUT)
exten => _3XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _3XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _3XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _3XXX,n,Set(QDIALER_CHANNEL=SIP/pwropbx2primcc/${EXTEN})
exten => _3XXX,n,Set(QueueName=L2TEST-OUT)
exten => _3xxX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-L2TEST-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _3XXX,n,Goto(qm-queuedial,${EXTEN},1)



[dial-L2TEST-queue]
exten => 95,1,GotoIfTime(17:30-09:00|*|*|*?l2testoff,s,1)
exten => 95,n,GotoIfTime(09:00-17:30|tue-thu|21-23|aug?l2testoff,s,1)
exten => 95,n,GotoIfTime(09:00-17:30|thu-fri|20-21|sep?l2testoff,s,1)
exten => 95,n,GotoIfTime(09:00-17:30|tue|25|dec?l2testoff,s,1)
exten => 95,n,GotoIfTime(09:00-17:30|wed|01|may?l2testoff,s,1)
exten => 95,n,GotoIfTime(09:00-17:30|tue-fri|04-07|jun?l2testoff,s,1)
exten => 95,n,GotoIfTime(09:00-17:30|sat|23|mar?l2testoff,s,1)
exten => 95,n,GotoIfTime(*|sun|*|*?l2testoff,s,1)
exten => 95,n,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)
exten => 95,n,Answer
exten => 95,n,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-L2TEST-IN-F${CALLERID(NUM)}-T${EXTEN}) ;rec name
exten => 95,n,Monitor(wav,${MONITOR_FILENAME},m) ; .wav generated
exten => 95,n,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 95,n,Set(_CALLER=${CALLERID(NUM)})
exten => 95,n,Queue(L2TEST-IN,tT)  ; call enter in sales queue
exten => 95,n,Hangup

[l2testoff]
;exten => s,1,playback(normalsales)
exten => s,1,playback(ENGLISH/normalsales)

exten => s,2,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => s,3,Read(CBNUM,beep,11,2,2)
exten => s,4,NoOP(----CBNUM=${CBNUM}----)
exten => s,5,Playback(thank-you-for-calling)
exten => s,6,AGI(callbackl2test.agi,${DATIME},${CBNUM},${CALLERID(NUM)})
exten => s,7,Hangup



[L2TEST-Check]
exten => _5X,1,Dial(SIP/gcc-off/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => _7X,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)
exten => _4xxx,1,Dial(SIP/grwopbx2primcc/${EXTEN},60,rtT)


exten => _20,1,Goto(L2TEST-Pause,20,1)
exten => _21,1,Goto(L2TEST-Pause,21,1)


exten => 788,1,Goto(L2TEST-Team,${EXTEN},1)
exten => 789,1,Goto(L2TEST-Team,${EXTEN},1)
exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)
exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,84,1)    ; Before  L2 TAC merger

exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)
exten => 92,1,Goto(dial-salespwr-queue,${EXTEN},1)

exten => _X.,1,Goto(L2TEST-Team,${EXTEN},1)


[L2TEST-Pause]
exten => 20,1,PauseQueueMember(L2TEST-IN,SIP/${CALLERID(num)},,Test Pause Code)
exten => 20,n,Hangup()

exten => 21,1,UnPauseQueueMember(L2TEST-IN,SIP/${CALLERID(num)})
exten => 21,n,Hangup()

[httptest]
exten => 8442062,1,NoOp(${CALLERID(num)})
exten => 8442062,2,Set(var1=1)
exten => 8442062,3,Set(var2=2)
exten => 8442062,4,Set(var3=3)
exten => 8442062,5,Set(var4=4)
exten => 8442062,6,Set(var5=5)
exten => 8442062,7,Set(var6=6)
exten => 8442062,8,Set(var7=7)
exten => 8442062,9,Set(var8=8)
exten => 8442062,10,Set(var9=9)
exten => 8442062,11,Set(var10="zeroreceived")
exten => 8442062,12,NoOp(${var9})
exten => 8442062,13,Set(CURLOPT(conntimeout)=3)
exten => 8442062,14,Set(CURLOPT(httptimeout)=3)
exten => 8442062,15,Set(CURL_MULTI=${CURL(https://crm.nayatel.com/views/crmViews/nayatelCrm/services_files/testservice.php?caller_id=3)})
exten => 8442062,16,NoOp(${CURL_MULTI})
exten => 8442062,17,GotoIf($["${CURL_MULTI}" != ""] ?20:80)

exten => 8442062,80,Set(CURL_MULTI=0)
exten => 8442062,81,NoOp(${var10})


exten => 8442062,20,GotoIf(${CURL_MULTI} != 3?92:90)
exten => 8442062,21,GotoIf(${CURL_MULTI} = 2?91:22)
exten => 8442062,22,GotoIf(${CURL_MULTI} = 3?92:150)

exten => 8442062,90,Playback(problem-ivr/04)

exten => 8442062,92,Playback(problem-ivr/03)

exten => 8442062,150,hangup

;exten => 8442062,20,GotoIf($["${CURL_MULTI}" = "1"]?90:21)
;exten => 8442062,21,GotoIf($["${CURL_MULTI}" = "2"]?91:22)
;exten => 8442062,22,GotoIf($["${CURL_MULTI}" = "3"]?92:23)
;exten => 8442062,23,GotoIf($["${CURL_MULTI}" = "4"]?93:24)
;exten => 8442062,24,GotoIf($["${CURL_MULTI}" = "5"]?94:25)
;exten => 8442062,25,GotoIf($["${CURL_MULTI}" = "6"]?95:26)
;exten => 8442062,26,GotoIf($["${CURL_MULTI}" = "7"]?96:27)
;exten => 8442062,27,GotoIf($["${CURL_MULTI}" = "8"]?97:28)
;exten => 8442062,28,GotoIf($["${CURL_MULTI}" = "9"]?98:99)
;exten => 8442062,90,Playback(problem-ivr/01)
;exten => 8442062,91,Playback(problem-ivr/02)
;exten => 8442062,92,Playback(problem-ivr/03)
;exten => 8442062,93,Playback(problem-ivr/04)
;exten => 8442062,94,Playback(problem-ivr/05)
;exten => 8442062,95,Playback(problem-ivr/06)
;exten => 8442062,96,Playback(problem-ivr/07)
;exten => 8442062,97,Playback(problem-ivr/08)
;exten => 8442062,98,Playback(problem-ivr/09)
;exten => 8442062,n,hangup

[zaeemtest]
;exten => s,1,NoOp(${CALLERID(num)})
;exten => s,2,Set(TIMEOUT(response)=5)
;exten => s,3,Background(ENGLISH/PriorityTest)
;exten => 1,1,Goto(prio,82,4)
;exten => 2,1,Goto(nonprio,81,20)
;exten => i,1,Goto(zaeemtest,s,2)  ;for invalid
;exten => t,1,Goto(zaeemtest,s,2)   ;for timeout

exten => 81,1,NoOp(${CALLERID(num)})
exten => 81,2,Set(ivr=${DB(ivr/ramzan)})
exten => 81,3,GotoIf($[${ivr}=1]?4:5)
exten => 81,4,Goto(ramzantest,1,1)
exten => 81,5,Playback(EngUrdu/tac_queue_ivr)
exten => 81,6,NoOp(Working Fine !)
exten => 81,7,Hangup



[prio]
exten => 82,4,Answer
exten => 82,5,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 82,6,Set(_CALLER=${CALLERID(NUM)})
exten => 82,7,set(_EXTEN=${EXTEN}
exten => 82,8,Set(QUEUE_PRIO=1)
exten => 82,9,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-ZaeemTest-F${CALLERID(NUM)}-T${EXTEN}) ; call recording file name
exten => 82,10,Monitor(wav,${MONITOR_FILENAME},m) ; .wav generated
exten => 82,11,Queue(zemtest,tTc,,,,,,macro-queuemacro) ;
;exten => 82,10,Goto(fbzaeem,85,1)
exten => 82,12,Hangup
exten => h,1,NoOp(caller Disconnected)
exten => h,2,hangup

[nonprio]
exten => 81,20,Answer
exten => 81,21,Set(_DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => 81,22,Set(_CALLER=${CALLERID(NUM)})
exten => 81,23,set(_EXTEN=${EXTEN})
;exten => 81,24,Set(QUEUE_PRIO=5)
exten => 81,24,Queue(zemtest,tTc,,,,,,macro-queuemacro) ;
exten => 81,25,Hangup

[fbzaeem]
exten => 85,1,set(_EXTEN=${EXTEN})
;exten => 82,n,Playback(feedbackrating)
exten => 85,n,Playback(ENGLISH/feedbackrating)
exten => 85,n,Read(FDBAK,beep,1,2,2)
exten => 85,n,NoOP(----FDBAK=${FDBAK}----)
exten => 85,n,NoOP(AGENTEXX=${MEMBERINTERFACE:4})
exten => 85,n,AGI(dialoutagentt,${MEMBERINTERFACE:4})
exten => 85,n,Set(QDIALER_AGENT=${AGENT})
exten => 85,n,Set(CALLER=${CALLERID(NUM)})
;exten => 82,n,Playback(thankyou)
exten => 85,n,Playback(ENGLISH/thank-you-for-calling)
exten => 85,n,AGI(feedbackk.agi,${DATIME},${CALLER},${FDBAK},${EXTEN},${AGENT},${MEMBERINTERFACE:4})
exten => 85,n,Hangup
exten => h,1,NoOp(Caller Disconnected)
exten => h,2,hangup




;====================================86 queue Zaki SRF done by Umair===============================


[Tac-Core-Check]
exten => _5X,1,Dial(SIP/gcc-off/${EXTEN},60,rtT)
exten => _6X,1,Goto(parkedcalls,${EXTEN},1)
exten => _7X,1,Dial(SIP/pcc-gcc/${EXTEN},60,rtT)
exten => 788,1,Goto(Cor-TAC,${EXTEN},1)
exten => 789,1,Goto(Cor-TAC,${EXTEN},1)
exten => 906,1,Dial(SIP/NTL-CC-OFF/906,60,trT)
exten => 909,1,Dial(SIP/NTL-CC-OFF/909,60,trT)
exten => 81,1,Goto(dial-tac-queue,${EXTEN},1)
exten => 82,1,Goto(dial-sales-queue,${EXTEN},1)   ; uncomment when Tac que is shifted to NEWCC
exten => 83,1,Goto(dial-billing-queue,${EXTEN},1)  ;uncomment when Tac que is shifted to NEWCC
exten => 85,1,Goto(dial-ntl-queue,${EXTEN},1)
exten => 86,1,Goto(Dial-Core-Queue,${EXTEN},1)
exten => 87,1,Goto(dial-core-queue,${EXTEN},1)
exten => 89,1,Goto(dial-tx-queue,${EXTEN},1)
exten => 90,1,Goto(dial-salfsd-queue,${EXTEN},1)
exten => 91,1,Goto(dial-planing-queue,${EXTEN},1)
exten => 84,1,Goto(dial-access-queue,${EXTEN},1); before l2 merger
exten => _X.,1,Goto(Cor-TAC,${EXTEN},1)
exten => _10,1,Goto(CoreTAC-Pause,10,1)
exten => _11,1,Goto(CoreTAC-Pause,11,1)
[Dial-Core-Queue]
;exten => 86,1,GotoIfTime(*|fri|10|dec?dial-tac-queue,81,2)     ;kashmir day
;exten => 86,1,GotoIfTime(08:00-00:00|mon-wed|12-14|sep?dial-tac-queue,81,2)      ; Eid Diversion to TAC applied on 9th sept 16
exten => 86,1,GotoIfTime(23:59-08:00|*|*|*?dial-tac-queue,81,2)      ;done by wajahat/sohail/AB on 23/06/20
exten => 86,2,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)
exten => 86,3,Answer
;exten => 86,2,Set(MONITOR_FILENAME=TAC-IN-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}})
exten => 86,4,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 86,5,Monitor(wav,${MONITOR_FILENAME},m)
exten => 86,6,Queue(CoreTac-IN,tTc)
exten => 86,7,Hangup()
;exten => 86,1,GotoIfTime(*|fri|10|dec?dial-tac-queue,81,2)     ;kashmir day
;exten => 86,1,GotoIfTime(08:00-00:00|mon-wed|12-14|sep?dial-tac-queue,81,2)      ; Eid Diversion to TAC applied on 9th sept 16
exten => 86,1,GotoIfTime(00:00-08:00|*|*|*?dial-tac-queue,81,2)      ;done by wajahat/sohail/AB on 23/06/20
exten => 86,2,Set(ivr1=${DB(ivr/ramzan)})
exten => 86,3,GotoIf($["${ivr1}"="1"]?4:5)
exten => 86,4,Goto(RamzanAccess,1,1)
exten => 86,5,GotoIfTime(13:00-14:00|fri|*|*?jumma,s,1)
exten => 86,6,Answer
exten => 86,7,Set(MONITOR_FILENAME=${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)-${UNIQUEID}}-TAC-IN-F${CALLERID(NUM)}-T${EXTEN})
exten => 86,8,Monitor(wav,${MONITOR_FILENAME},m)
exten => 86,9,Queue(CoreTac-IN,tTc)
exten => 86,10,Hangup()

[CoreTAC-Pause]
exten => 10,1,PauseQueueMember(CoreTac-IN,SIP/${CALLERID(num)},,Test Pause Code)
exten => 10,n,Hangup()
exten => 11,1,UnPauseQueueMember(CoreTac-IN,SIP/${CALLERID(num)})
exten => 11,n,Hangup()

[Cor-TAC]
include=> Tac-Core-Queue-Login
include=> CoreTac-internal
include=> internal
include=> Dial-Core-Queue
include=> CoreTac-DialOut
[Tac-Core-Queue-Login]
exten => 788,1,Goto(CoreTac-login,2,1)
exten => 789,1,Goto(CoreTac-logout,1,1)
[CoreTac-login]
exten => 2,1,Background(agent-user)
exten => 3,1,NoOp,${CALLERID}
exten => _90XX,1,Set(xx=${DB(CoreTac-IN/${CALLERID(NUM)})})
exten => _90XX,2,GotoIf($[${xx}=7]?15)
exten => _90XX,3,Playback(agent-pass)
exten => _90XX,4,Read(PASS)
exten => _90XX,5,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _90XX,6,GotoIf($[${abc}=7]?13)
exten => _90XX,7,AddQueueMember(CoreTac-IN,SIP/${CALLERID(NUM)})
exten => _90XX,8,Set(DB(CoreTac-IN/${CALLERID(NUM)})=7)
exten => _90XX,9,Playback(agent-loginok)
exten => _90XX,10,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _90XX,11,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},login,${DATIME})
exten => _90XX,12,Goto(CoreTac-login,_90XX,17)
exten => _90XX,13,Playback(auth-incorrect)
exten => _90XX,14,Goto(CoreTac-login,${EXTEN},4)
exten => _90XX,15,Playback(agent-alreadyon)
exten => _90XX,16,Goto(CoreTac-login,2,1)
;exten => _90XX,17,Hangup()
[CoreTac-logout]
exten => 1,1,Background(agent-user)
exten => _90XX,1,Playback(agent-pass)
exten => _90XX,2,read(PASS)
exten => _90XX,3,AGI(agent-auth.agi,${EXTEN},${PASS})
exten => _90XX,4,GotoIf($[${abc}=7]?11)
exten => _90XX,5,SET(DB(CoreTac-IN/${CALLERID(NUM)})=0)
exten => _90XX,6,RemoveQueueMember(CoreTac-IN,SIP/${CALLERID(NUM)})
exten => _90XX,7,Playback(agent-loggedoff)
exten => _90XX,8,Set(DATIME=${STRFTIME(${EPOCH},,%d-%m-%Y %H:%M:%S)})
exten => _90XX,9,AGI(agent-log.agi,${EXTEN},${CALLERID(NUM)},logout,${DATIME})
exten => _90XX,10,Goto(CoreTac-logout,_90XX,13)
exten => _90XX,11,Playback(auth-incorrect)
exten => _90XX,12,Goto(CoreTac-logout,${EXTEN},2)
exten => _90XX,13,Hangup()
[CoreTac-internal]
exten => _2XX,1,Dial(SIP/${EXTEN},60,rt)
exten => _2XX,2,Hangup
[internal]
;exten=> _200,1,Goto(dial-office,${EXTEN},1)
;exten=> _200,2,Hangup

exten => _2XZ,1,Goto(dial-tac-queue,81,1)
exten => _40X,1,Goto(dial-sales-queue,82,1)
exten => _45X,1,Goto(dial-billing-queue,83,1)
exten => _64X,1,Goto(dial-access-queue,84,1) ; before L2 TAC merger

;exten => _64X,1,Goto(dial-core-queue,87,1) ; L2 TAC merger
exten =>  81,1,Goto(dial-tac-queue,81,1)
exten => _2XX,1,Goto(Dial-Core-Queue,86,1)
;exten => _56X,1,Goto(dial-salfsd-queue,90,1)
;exten => _XXX,1,Goto(dial-office,${EXTEN},1)
;exten => _XXX,2,Hangup()
[CoreTac-DialOut]
exten => _003XXXXXXXXX,1,Set(QDIALER_QUEUE=CoreTac-OUT)
exten => _003XXXXXXXXX,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _003XXXXXXXXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _003XXXXXXXXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _003XXXXXXXXX,n,Set(CALLER=${CALLERID(NUM)})
;exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=0518310000)
exten => _003XXXXXXXXX,n,Set(CALLERID(NUM)=8310000)
exten => _003XXXXXXXXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _003XXXXXXXXX,n,Set(QueueName=CoreTac-OUT)
;exten => _003XXXXXXXXX,n,MixMonitor(CoreTac-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _003XXXXXXXXX,n,Monitor(wav| CoreTac-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _003XXXXXXXXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLER}-T${EXTEN},m)
exten => _003XXXXXXXXX,n,Goto(qm-queuedial,${EXTEN},1)

exten => _0Z.,1,Set(QDIALER_QUEUE=CoreTac-OUT)
exten => _0Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _0Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _0Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _0Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _0Z.,n,Set(CALLERID(NUM)=8310000)
exten => _0Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _0Z.,n,Set(QueueName= CoreTac-OUT)
;exten => _0Z.,n,MixMonitor(CoreTac-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _0Z.,n,Monitor(wav| CoreTac-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _0Z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLER}-T${EXTEN},m)
exten => _0Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _00Z.,1,Set(QDIALER_QUEUE=CoreTac-OUT)
exten => _00Z.,n,Set(QDIALER_NUMBER=${EXTEN:1})
exten => _00Z.,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _00Z.,n,Set(QDIALER_AGENT=${AGENT})
exten => _00Z.,n,Set(CALLER=${CALLERID(NUM)})
exten => _00Z.,n,Set(CALLERID(NUM)=8310000)
exten => _00Z.,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-1/${EXTEN:1})
exten => _00Z.,n,Set(QueueName=CoreTac-OUT)
;exten => _0Z.,n,MixMonitor(CoreTac-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
exten => _00Z.,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLER}-T${EXTEN},m)
exten => _00Z.,n,Goto(qm-queuedial,${EXTEN},1)

exten => _XXX,1,Set(QDIALER_QUEUE=CoreTac-OUT)
exten => _XXX,n,Set(QDIALER_NUMBER=${EXTEN})
exten => _XXX,n,AGI(dialoutagent,${CALLERID(NUM)})
exten => _XXX,n,Set(QDIALER_AGENT=${AGENT})
exten => _XXX,n,Set(CALLER=${CALLERID(NUM)})
exten => _XXX,n,Set(CALLERID(NUM)=8310000)
exten => _XXX,n,Set(QDIALER_CHANNEL=SIP/NTL-CC-OFF/${EXTEN})
exten => _XXX,n,Set(QueueName=CoreTac-OUT)
;exten => _XXX,n,MixMonitor(CoreTac-OUT-${CALLERID(NUM)}-${EXTEN}--${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}.wav|b|)
;exten => _XXX,n,Monitor(wav| CorTac-OUT-${CALLERID(NUM)}-${EXTEN}-${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)},m)
exten => _XXX,n,Monitor(wav,${STRFTIME(${EPOCH},,%d%m%Y-%H%M%S)}-TAC-OUT-F${CALLERID(NUM)}-T${EXTEN},m)
exten => _XXX,n,Goto(qm-queuedial,${EXTEN},1)





[habibtestAMICB]
 exten => s,1,Queue(TAC-IN)
; exten => s,1,Goto(dial-tac-queue,81,1) 
 exten => s,2,Hangup()






